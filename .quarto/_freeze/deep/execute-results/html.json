{
  "hash": "662dbe3b771bdc8392e3877f8ae6d22e",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Modelos de deep learning\"\n---\n\n\n\n\nPara modelar la serie de tiempo con técnicas de Deep Learning, se requiere realizar una preparación cuidadosa de los datos y la configuración de modelos neuronales. En este caso, se utiliza la librería TensorFlow para implementar diferentes tipos de modelos, como Redes Neuronales Multicapa (MLP) y Redes Neuronales Recurrentes (LSTM, RNN), dado que estas arquitecturas son efectivas para capturar patrones no lineales y dependencias temporales en los datos.\n\n# Importar librerías \n\nSe importan las librerías necesarias para el modelado, como TensorFlow para la construcción de modelos neuronales, Scikeras para la integración de los modelos con sklearn y Plotly para la visualización de resultados. Además, se emplean herramientas estadísticas y métricas de evaluación para medir el rendimiento de los modelos y realizar diagnósticos de los residuos.\n\n::: {#9217fb72 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport numpy as np\nimport pickle\n\nimport plotly.graph_objects as go\nimport plotly.express as px\nfrom plotly.subplots import make_subplots\n\nfrom tensorflow.keras.models import Sequential, Model, load_model\nfrom tensorflow.keras.layers import Dense, Input, Dropout\nfrom tensorflow.keras.optimizers import Adam\nfrom tensorflow.keras import layers, losses\nfrom scikeras.wrappers import KerasRegressor\n\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.metrics import mean_absolute_percentage_error, mean_absolute_error, mean_squared_error, r2_score\n\nfrom scipy.stats import jarque_bera\nfrom statsmodels.stats.diagnostic import acorr_ljungbox\n\nimport warnings\n\nimport os\n\nos.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'\nwarnings.filterwarnings(\"ignore\", category=UserWarning, module=\"scikeras.wrappers\")\nwarnings.filterwarnings(\"ignore\", category=UserWarning, module=\"keras.layers.core.dense\")\n```\n:::\n\n\n# Importar datos\n\nEn este caso, se carga un archivo con los datos preparados (btc_models.csv), que contiene las características necesarias para entrenar los modelos neuronales y evaluar su rendimiento. El dataset incluye variables transformadas y seleccionadas para capturar tanto la estructura temporal como la información relevante de la serie de precios de Bitcoin.\n\n::: {#f4ef4c0e .cell execution_count=2}\n``` {.python .cell-code}\nbtc = pd.read_csv('data/btc_models.csv')\n\nbtc\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Date</th>\n      <th>Price</th>\n      <th>Open</th>\n      <th>High</th>\n      <th>Low</th>\n      <th>Vol.</th>\n      <th>Change %</th>\n      <th>R_j</th>\n      <th>A_t</th>\n      <th>σ_7</th>\n      <th>σ_14</th>\n      <th>σ_21</th>\n      <th>σ_28</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2024-03-24</td>\n      <td>67211.9</td>\n      <td>64036.5</td>\n      <td>67587.8</td>\n      <td>63812.9</td>\n      <td>65590.0</td>\n      <td>4.96</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2024-03-23</td>\n      <td>64037.8</td>\n      <td>63785.6</td>\n      <td>65972.4</td>\n      <td>63074.9</td>\n      <td>35110.0</td>\n      <td>0.40</td>\n      <td>-0.047225</td>\n      <td>-0.047225</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2024-03-22</td>\n      <td>63785.5</td>\n      <td>65501.5</td>\n      <td>66633.3</td>\n      <td>62328.3</td>\n      <td>72430.0</td>\n      <td>-2.62</td>\n      <td>-0.003940</td>\n      <td>-0.051165</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2024-03-21</td>\n      <td>65503.8</td>\n      <td>67860.0</td>\n      <td>68161.7</td>\n      <td>64616.1</td>\n      <td>75260.0</td>\n      <td>-3.46</td>\n      <td>0.026939</td>\n      <td>-0.024226</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2024-03-20</td>\n      <td>67854.0</td>\n      <td>62046.8</td>\n      <td>68029.5</td>\n      <td>60850.9</td>\n      <td>133530.0</td>\n      <td>9.35</td>\n      <td>0.035879</td>\n      <td>0.011652</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>4994</th>\n      <td>2010-07-22</td>\n      <td>0.1</td>\n      <td>0.1</td>\n      <td>0.1</td>\n      <td>0.1</td>\n      <td>2160.0</td>\n      <td>0.00</td>\n      <td>0.000000</td>\n      <td>-4.322978</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>4995</th>\n      <td>2010-07-21</td>\n      <td>0.1</td>\n      <td>0.1</td>\n      <td>0.1</td>\n      <td>0.1</td>\n      <td>580.0</td>\n      <td>0.00</td>\n      <td>0.000000</td>\n      <td>-4.322978</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>4996</th>\n      <td>2010-07-20</td>\n      <td>0.1</td>\n      <td>0.1</td>\n      <td>0.1</td>\n      <td>0.1</td>\n      <td>260.0</td>\n      <td>0.00</td>\n      <td>0.000000</td>\n      <td>-4.322978</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>4997</th>\n      <td>2010-07-19</td>\n      <td>0.1</td>\n      <td>0.1</td>\n      <td>0.1</td>\n      <td>0.1</td>\n      <td>570.0</td>\n      <td>0.00</td>\n      <td>0.000000</td>\n      <td>-4.322978</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>4998</th>\n      <td>2010-07-18</td>\n      <td>0.1</td>\n      <td>0.0</td>\n      <td>0.1</td>\n      <td>0.1</td>\n      <td>80.0</td>\n      <td>0.00</td>\n      <td>0.000000</td>\n      <td>-4.322978</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>4999 rows × 13 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {#2bdc7dac .cell execution_count=3}\n``` {.python .cell-code}\nbtc.info()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 4999 entries, 0 to 4998\nData columns (total 13 columns):\n #   Column    Non-Null Count  Dtype  \n---  ------    --------------  -----  \n 0   Date      4999 non-null   object \n 1   Price     4999 non-null   float64\n 2   Open      4999 non-null   float64\n 3   High      4999 non-null   float64\n 4   Low       4999 non-null   float64\n 5   Vol.      4999 non-null   float64\n 6   Change %  4999 non-null   float64\n 7   R_j       4998 non-null   float64\n 8   A_t       4998 non-null   float64\n 9   σ_7       4992 non-null   float64\n 10  σ_14      4985 non-null   float64\n 11  σ_21      4978 non-null   float64\n 12  σ_28      4971 non-null   float64\ndtypes: float64(12), object(1)\nmemory usage: 507.8+ KB\n```\n:::\n:::\n\n\n::: {#8b7a174e .cell execution_count=4}\n``` {.python .cell-code}\nbtc = btc.fillna(0)\n\nbtc['Date'] = pd.to_datetime(btc['Date'], format='%Y-%m-%d')\n\nbtc.info()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 4999 entries, 0 to 4998\nData columns (total 13 columns):\n #   Column    Non-Null Count  Dtype         \n---  ------    --------------  -----         \n 0   Date      4999 non-null   datetime64[ns]\n 1   Price     4999 non-null   float64       \n 2   Open      4999 non-null   float64       \n 3   High      4999 non-null   float64       \n 4   Low       4999 non-null   float64       \n 5   Vol.      4999 non-null   float64       \n 6   Change %  4999 non-null   float64       \n 7   R_j       4999 non-null   float64       \n 8   A_t       4999 non-null   float64       \n 9   σ_7       4999 non-null   float64       \n 10  σ_14      4999 non-null   float64       \n 11  σ_21      4999 non-null   float64       \n 12  σ_28      4999 non-null   float64       \ndtypes: datetime64[ns](1), float64(12)\nmemory usage: 507.8 KB\n```\n:::\n:::\n\n\n# Objetivo\n\nEl objetivo principal de los modelos de Deep Learning es capturar patrones no lineales y dependencias temporales en los datos del Bitcoin, mejorando la capacidad predictiva sobre otros enfoques tradicionales. Para ello, se configurarán y entrenarán distintas arquitecturas neuronales, optimizando sus hiperparámetros y evaluando su desempeño mediante métricas como el error absoluto medio (MAE), el error cuadrático medio (MSE) y la proporción explicada (R²). Además, se aplicarán diagnósticos de los residuos para verificar la calidad de las predicciones y detectar posibles sesgos o errores sistemáticos en los modelos.\n\n# Obtención de las series de tiempo y conjuntos de prueba, validación y entrenamiento\n\nEn esta sección se dividen los datos de las series de tiempo de Bitcoin en conjuntos de entrenamiento, validación y prueba para diferentes horizontes de tiempo (lags o τ). Este proceso es crucial para el entrenamiento de modelos de Deep Learning que se basan en dependencias temporales, como las redes recurrentes o los LSTM.\n\nDividir los datos en conjuntos de entrenamiento, validación y prueba es fundamental para garantizar que los modelos se entrenen correctamente, evitando el sobreajuste y evaluando su rendimiento en datos no vistos. Además, trabajar con múltiples valores de τ permite explorar la influencia del horizonte temporal en la capacidad predictiva del modelo, lo cual es esencial en series de tiempo con fluctuaciones a corto y largo plazo.\n\n::: {#c9faabf8 .cell execution_count=5}\n``` {.python .cell-code}\ndef split_dataset(df: pd.DataFrame, tau: int, column: str) -> list:\n    df[column] = df[column].fillna(0)\n\n    serie = df[column]\n    n = len(serie)\n    train_w = n - (tau * 3)\n    \n    X_train = np.array([serie.iloc[i - tau:i].values.flatten() for i in range(tau, train_w)])\n    y_train = np.array(serie.iloc[tau:train_w].values.flatten()).reshape(-1, 1)\n\n    X_val = np.array([serie.iloc[i - tau:i].values.flatten() for i in range(train_w, train_w + tau)])\n    y_val = np.array(serie.iloc[train_w:train_w + tau].values.flatten().tolist())\n\n    X_test = np.array([serie.iloc[i - tau:i].values.flatten() for i in range(train_w + tau, train_w + (2 * tau))])\n    y_test = np.array(serie.iloc[train_w + tau:train_w + (2 * tau)].values.flatten().tolist())\n\n    return [X_train, y_train, X_val, y_val, X_test, y_test]\n```\n:::\n\n\n## Series de tiempo del precio\n\n::: {#9ba1f620 .cell execution_count=6}\n``` {.python .cell-code}\nprice_7 = split_dataset(btc, 7, 'Price')\nprice_14 = split_dataset(btc, 14, 'Price')\nprice_21 = split_dataset(btc, 21, 'Price')\nprice_28 = split_dataset(btc, 28, 'Price')\n\nprice = [price_7, price_14, price_21, price_28]\n\nprint('τ = 7')\nprint(f'Tamaño del conjunto de entrenamiento τ = 7 en X: {price_7[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 7 en y: {price_7[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 7 en X: {price_7[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 7 en y: {price_7[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 7 en X: {price_7[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 7 en y: {price_7[5].shape}')\n\nprint('\\nτ = 14')\nprint(f'Tamaño del conjunto de entrenamiento τ = 14 en X: {price_14[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 14 en y: {price_14[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 14 en X: {price_14[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 14 en y: {price_14[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 14 en X: {price_14[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 14 en y: {price_14[5].shape}')\n\nprint('\\nτ = 21')\nprint(f'Tamaño del conjunto de entrenamiento τ = 21 en X: {price_21[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 21 en y: {price_21[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 21 en X: {price_21[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 21 en y: {price_21[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 21 en X: {price_21[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 21 en y: {price_21[5].shape}')\n\nprint('\\nτ = 28')\nprint(f'Tamaño del conjunto de entrenamiento τ = 28 en X: {price_28[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 28 en y: {price_28[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 28 en X: {price_28[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 28 en y: {price_28[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 28 en X: {price_28[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 28 en y: {price_28[5].shape}')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nτ = 7\nTamaño del conjunto de entrenamiento τ = 7 en X: (4971, 7)\nTamaño del conjunto de entrenamiento τ = 7 en y: (4971, 1)\nTamaño del conjunto de validación τ = 7 en X: (7, 7)\nTamaño del conjunto de validación τ = 7 en y: (7,)\nTamaño del conjunto de prueba τ = 7 en X: (7, 7)\nTamaño del conjunto de prueba τ = 7 en y: (7,)\n\nτ = 14\nTamaño del conjunto de entrenamiento τ = 14 en X: (4943, 14)\nTamaño del conjunto de entrenamiento τ = 14 en y: (4943, 1)\nTamaño del conjunto de validación τ = 14 en X: (14, 14)\nTamaño del conjunto de validación τ = 14 en y: (14,)\nTamaño del conjunto de prueba τ = 14 en X: (14, 14)\nTamaño del conjunto de prueba τ = 14 en y: (14,)\n\nτ = 21\nTamaño del conjunto de entrenamiento τ = 21 en X: (4915, 21)\nTamaño del conjunto de entrenamiento τ = 21 en y: (4915, 1)\nTamaño del conjunto de validación τ = 21 en X: (21, 21)\nTamaño del conjunto de validación τ = 21 en y: (21,)\nTamaño del conjunto de prueba τ = 21 en X: (21, 21)\nTamaño del conjunto de prueba τ = 21 en y: (21,)\n\nτ = 28\nTamaño del conjunto de entrenamiento τ = 28 en X: (4887, 28)\nTamaño del conjunto de entrenamiento τ = 28 en y: (4887, 1)\nTamaño del conjunto de validación τ = 28 en X: (28, 28)\nTamaño del conjunto de validación τ = 28 en y: (28,)\nTamaño del conjunto de prueba τ = 28 en X: (28, 28)\nTamaño del conjunto de prueba τ = 28 en y: (28,)\n```\n:::\n:::\n\n\n## Series de tiempo del retorno acumulado\n\n::: {#a82593c7 .cell execution_count=7}\n``` {.python .cell-code}\nat_7 = split_dataset(btc, 7, 'A_t')\nat_14 = split_dataset(btc, 14, 'A_t')\nat_21 = split_dataset(btc, 21, 'A_t')\nat_28 = split_dataset(btc, 28, 'A_t')\n\nat = [at_7, at_14, at_21, at_28]\n\nprint('τ = 7')\nprint(f'Tamaño del conjunto de entrenamiento τ = 7 en X: {at_7[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 7 en y: {at_7[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 7 en X: {at_7[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 7 en y: {at_7[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 7 en X: {at_7[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 7 en y: {at_7[5].shape}')\n\nprint('\\nτ = 14')\nprint(f'Tamaño del conjunto de entrenamiento τ = 14 en X: {at_14[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 14 en y: {at_14[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 14 en X: {at_14[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 14 en y: {at_14[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 14 en X: {at_14[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 14 en y: {at_14[5].shape}')\n\nprint('\\nτ = 21')\nprint(f'Tamaño del conjunto de entrenamiento τ = 21 en X: {at_21[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 21 en y: {at_21[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 21 en X: {at_21[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 21 en y: {at_21[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 21 en X: {at_21[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 21 en y: {at_21[5].shape}')\n\nprint('\\nτ = 28')\nprint(f'Tamaño del conjunto de entrenamiento τ = 28 en X: {at_28[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 28 en y: {at_28[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 28 en X: {at_28[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 28 en y: {at_28[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 28 en X: {at_28[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 28 en y: {at_28[5].shape}')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nτ = 7\nTamaño del conjunto de entrenamiento τ = 7 en X: (4971, 7)\nTamaño del conjunto de entrenamiento τ = 7 en y: (4971, 1)\nTamaño del conjunto de validación τ = 7 en X: (7, 7)\nTamaño del conjunto de validación τ = 7 en y: (7,)\nTamaño del conjunto de prueba τ = 7 en X: (7, 7)\nTamaño del conjunto de prueba τ = 7 en y: (7,)\n\nτ = 14\nTamaño del conjunto de entrenamiento τ = 14 en X: (4943, 14)\nTamaño del conjunto de entrenamiento τ = 14 en y: (4943, 1)\nTamaño del conjunto de validación τ = 14 en X: (14, 14)\nTamaño del conjunto de validación τ = 14 en y: (14,)\nTamaño del conjunto de prueba τ = 14 en X: (14, 14)\nTamaño del conjunto de prueba τ = 14 en y: (14,)\n\nτ = 21\nTamaño del conjunto de entrenamiento τ = 21 en X: (4915, 21)\nTamaño del conjunto de entrenamiento τ = 21 en y: (4915, 1)\nTamaño del conjunto de validación τ = 21 en X: (21, 21)\nTamaño del conjunto de validación τ = 21 en y: (21,)\nTamaño del conjunto de prueba τ = 21 en X: (21, 21)\nTamaño del conjunto de prueba τ = 21 en y: (21,)\n\nτ = 28\nTamaño del conjunto de entrenamiento τ = 28 en X: (4887, 28)\nTamaño del conjunto de entrenamiento τ = 28 en y: (4887, 1)\nTamaño del conjunto de validación τ = 28 en X: (28, 28)\nTamaño del conjunto de validación τ = 28 en y: (28,)\nTamaño del conjunto de prueba τ = 28 en X: (28, 28)\nTamaño del conjunto de prueba τ = 28 en y: (28,)\n```\n:::\n:::\n\n\n## Series de tiempo de la volatilidad\n\n### Serie de tiempo de la volatidad para σ = 7\n\n::: {#4e6f539c .cell execution_count=8}\n``` {.python .cell-code}\nvol_7 = split_dataset(btc, 7, 'σ_7')\nvol_14 = split_dataset(btc, 14, 'σ_7')\nvol_21 = split_dataset(btc, 21, 'σ_7')\nvol_28 = split_dataset(btc, 28, 'σ_7')\n\nvo_7 = [vol_7, vol_14, vol_21, vol_28]\n\nprint('τ = 7')\nprint(f'Tamaño del conjunto de entrenamiento τ = 7 en X: {vol_7[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 7 en y: {vol_7[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 7 en X: {vol_7[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 7 en y: {vol_7[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 7 en X: {vol_7[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 7 en y: {vol_7[5].shape}')\n\nprint('\\nτ = 14')\nprint(f'Tamaño del conjunto de entrenamiento τ = 14 en X: {vol_14[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 14 en y: {vol_14[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 14 en X: {vol_14[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 14 en y: {vol_14[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 14 en X: {vol_14[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 14 en y: {vol_14[5].shape}')\n\nprint('\\nτ = 21')\nprint(f'Tamaño del conjunto de entrenamiento τ = 21 en X: {vol_21[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 21 en y: {vol_21[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 21 en X: {vol_21[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 21 en y: {vol_21[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 21 en X: {vol_21[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 21 en y: {vol_21[5].shape}')\n\nprint('\\nτ = 28')\nprint(f'Tamaño del conjunto de entrenamiento τ = 28 en X: {vol_28[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 28 en y: {vol_28[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 28 en X: {vol_28[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 28 en y: {vol_28[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 28 en X: {vol_28[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 28 en y: {vol_28[5].shape}')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nτ = 7\nTamaño del conjunto de entrenamiento τ = 7 en X: (4971, 7)\nTamaño del conjunto de entrenamiento τ = 7 en y: (4971, 1)\nTamaño del conjunto de validación τ = 7 en X: (7, 7)\nTamaño del conjunto de validación τ = 7 en y: (7,)\nTamaño del conjunto de prueba τ = 7 en X: (7, 7)\nTamaño del conjunto de prueba τ = 7 en y: (7,)\n\nτ = 14\nTamaño del conjunto de entrenamiento τ = 14 en X: (4943, 14)\nTamaño del conjunto de entrenamiento τ = 14 en y: (4943, 1)\nTamaño del conjunto de validación τ = 14 en X: (14, 14)\nTamaño del conjunto de validación τ = 14 en y: (14,)\nTamaño del conjunto de prueba τ = 14 en X: (14, 14)\nTamaño del conjunto de prueba τ = 14 en y: (14,)\n\nτ = 21\nTamaño del conjunto de entrenamiento τ = 21 en X: (4915, 21)\nTamaño del conjunto de entrenamiento τ = 21 en y: (4915, 1)\nTamaño del conjunto de validación τ = 21 en X: (21, 21)\nTamaño del conjunto de validación τ = 21 en y: (21,)\nTamaño del conjunto de prueba τ = 21 en X: (21, 21)\nTamaño del conjunto de prueba τ = 21 en y: (21,)\n\nτ = 28\nTamaño del conjunto de entrenamiento τ = 28 en X: (4887, 28)\nTamaño del conjunto de entrenamiento τ = 28 en y: (4887, 1)\nTamaño del conjunto de validación τ = 28 en X: (28, 28)\nTamaño del conjunto de validación τ = 28 en y: (28,)\nTamaño del conjunto de prueba τ = 28 en X: (28, 28)\nTamaño del conjunto de prueba τ = 28 en y: (28,)\n```\n:::\n:::\n\n\n### Serie de tiempo de la volatidad para σ = 14\n\n::: {#8e5465e0 .cell execution_count=9}\n``` {.python .cell-code}\nvol_7 = split_dataset(btc, 7, 'σ_14')\nvol_14 = split_dataset(btc, 14, 'σ_14')\nvol_21 = split_dataset(btc, 21, 'σ_14')\nvol_28 = split_dataset(btc, 28, 'σ_14')\n\nvo_14 = [vol_7, vol_14, vol_21, vol_28]\n\nprint('τ = 7')\nprint(f'Tamaño del conjunto de entrenamiento τ = 7 en X: {vol_7[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 7 en y: {vol_7[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 7 en X: {vol_7[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 7 en y: {vol_7[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 7 en X: {vol_7[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 7 en y: {vol_7[5].shape}')\n\nprint('\\nτ = 14')\nprint(f'Tamaño del conjunto de entrenamiento τ = 14 en X: {vol_14[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 14 en y: {vol_14[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 14 en X: {vol_14[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 14 en y: {vol_14[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 14 en X: {vol_14[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 14 en y: {vol_14[5].shape}')\n\nprint('\\nτ = 21')\nprint(f'Tamaño del conjunto de entrenamiento τ = 21 en X: {vol_21[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 21 en y: {vol_21[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 21 en X: {vol_21[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 21 en y: {vol_21[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 21 en X: {vol_21[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 21 en y: {vol_21[5].shape}')\n\nprint('\\nτ = 28')\nprint(f'Tamaño del conjunto de entrenamiento τ = 28 en X: {vol_28[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 28 en y: {vol_28[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 28 en X: {vol_28[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 28 en y: {vol_28[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 28 en X: {vol_28[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 28 en y: {vol_28[5].shape}')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nτ = 7\nTamaño del conjunto de entrenamiento τ = 7 en X: (4971, 7)\nTamaño del conjunto de entrenamiento τ = 7 en y: (4971, 1)\nTamaño del conjunto de validación τ = 7 en X: (7, 7)\nTamaño del conjunto de validación τ = 7 en y: (7,)\nTamaño del conjunto de prueba τ = 7 en X: (7, 7)\nTamaño del conjunto de prueba τ = 7 en y: (7,)\n\nτ = 14\nTamaño del conjunto de entrenamiento τ = 14 en X: (4943, 14)\nTamaño del conjunto de entrenamiento τ = 14 en y: (4943, 1)\nTamaño del conjunto de validación τ = 14 en X: (14, 14)\nTamaño del conjunto de validación τ = 14 en y: (14,)\nTamaño del conjunto de prueba τ = 14 en X: (14, 14)\nTamaño del conjunto de prueba τ = 14 en y: (14,)\n\nτ = 21\nTamaño del conjunto de entrenamiento τ = 21 en X: (4915, 21)\nTamaño del conjunto de entrenamiento τ = 21 en y: (4915, 1)\nTamaño del conjunto de validación τ = 21 en X: (21, 21)\nTamaño del conjunto de validación τ = 21 en y: (21,)\nTamaño del conjunto de prueba τ = 21 en X: (21, 21)\nTamaño del conjunto de prueba τ = 21 en y: (21,)\n\nτ = 28\nTamaño del conjunto de entrenamiento τ = 28 en X: (4887, 28)\nTamaño del conjunto de entrenamiento τ = 28 en y: (4887, 1)\nTamaño del conjunto de validación τ = 28 en X: (28, 28)\nTamaño del conjunto de validación τ = 28 en y: (28,)\nTamaño del conjunto de prueba τ = 28 en X: (28, 28)\nTamaño del conjunto de prueba τ = 28 en y: (28,)\n```\n:::\n:::\n\n\n### Serie de tiempo de la volatidad para σ = 21\n\n::: {#1e5ab205 .cell execution_count=10}\n``` {.python .cell-code}\nvol_7 = split_dataset(btc, 7, 'σ_21')\nvol_14 = split_dataset(btc, 14, 'σ_21')\nvol_21 = split_dataset(btc, 21, 'σ_21')\nvol_28 = split_dataset(btc, 28, 'σ_21')\n\nvo_21 = [vol_7, vol_14, vol_21, vol_28]\n\nprint('τ = 7')\nprint(f'Tamaño del conjunto de entrenamiento τ = 7 en X: {vol_7[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 7 en y: {vol_7[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 7 en X: {vol_7[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 7 en y: {vol_7[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 7 en X: {vol_7[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 7 en y: {vol_7[5].shape}')\n\nprint('\\nτ = 14')\nprint(f'Tamaño del conjunto de entrenamiento τ = 14 en X: {vol_14[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 14 en y: {vol_14[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 14 en X: {vol_14[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 14 en y: {vol_14[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 14 en X: {vol_14[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 14 en y: {vol_14[5].shape}')\n\nprint('\\nτ = 21')\nprint(f'Tamaño del conjunto de entrenamiento τ = 21 en X: {vol_21[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 21 en y: {vol_21[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 21 en X: {vol_21[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 21 en y: {vol_21[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 21 en X: {vol_21[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 21 en y: {vol_21[5].shape}')\n\nprint('\\nτ = 28')\nprint(f'Tamaño del conjunto de entrenamiento τ = 28 en X: {vol_28[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 28 en y: {vol_28[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 28 en X: {vol_28[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 28 en y: {vol_28[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 28 en X: {vol_28[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 28 en y: {vol_28[5].shape}')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nτ = 7\nTamaño del conjunto de entrenamiento τ = 7 en X: (4971, 7)\nTamaño del conjunto de entrenamiento τ = 7 en y: (4971, 1)\nTamaño del conjunto de validación τ = 7 en X: (7, 7)\nTamaño del conjunto de validación τ = 7 en y: (7,)\nTamaño del conjunto de prueba τ = 7 en X: (7, 7)\nTamaño del conjunto de prueba τ = 7 en y: (7,)\n\nτ = 14\nTamaño del conjunto de entrenamiento τ = 14 en X: (4943, 14)\nTamaño del conjunto de entrenamiento τ = 14 en y: (4943, 1)\nTamaño del conjunto de validación τ = 14 en X: (14, 14)\nTamaño del conjunto de validación τ = 14 en y: (14,)\nTamaño del conjunto de prueba τ = 14 en X: (14, 14)\nTamaño del conjunto de prueba τ = 14 en y: (14,)\n\nτ = 21\nTamaño del conjunto de entrenamiento τ = 21 en X: (4915, 21)\nTamaño del conjunto de entrenamiento τ = 21 en y: (4915, 1)\nTamaño del conjunto de validación τ = 21 en X: (21, 21)\nTamaño del conjunto de validación τ = 21 en y: (21,)\nTamaño del conjunto de prueba τ = 21 en X: (21, 21)\nTamaño del conjunto de prueba τ = 21 en y: (21,)\n\nτ = 28\nTamaño del conjunto de entrenamiento τ = 28 en X: (4887, 28)\nTamaño del conjunto de entrenamiento τ = 28 en y: (4887, 1)\nTamaño del conjunto de validación τ = 28 en X: (28, 28)\nTamaño del conjunto de validación τ = 28 en y: (28,)\nTamaño del conjunto de prueba τ = 28 en X: (28, 28)\nTamaño del conjunto de prueba τ = 28 en y: (28,)\n```\n:::\n:::\n\n\n### Serie de tiempo de la volatidad para σ = 28\n\n::: {#94bb7117 .cell execution_count=11}\n``` {.python .cell-code}\nvol_7 = split_dataset(btc, 7, 'σ_7')\nvol_14 = split_dataset(btc, 14, 'σ_7')\nvol_21 = split_dataset(btc, 21, 'σ_7')\nvol_28 = split_dataset(btc, 28, 'σ_7')\n\nvo_28 = [vol_7, vol_14, vol_21, vol_28]\n\nprint('τ = 7')\nprint(f'Tamaño del conjunto de entrenamiento τ = 7 en X: {vol_7[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 7 en y: {vol_7[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 7 en X: {vol_7[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 7 en y: {vol_7[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 7 en X: {vol_7[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 7 en y: {vol_7[5].shape}')\n\nprint('\\nτ = 14')\nprint(f'Tamaño del conjunto de entrenamiento τ = 14 en X: {vol_14[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 14 en y: {vol_14[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 14 en X: {vol_14[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 14 en y: {vol_14[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 14 en X: {vol_14[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 14 en y: {vol_14[5].shape}')\n\nprint('\\nτ = 21')\nprint(f'Tamaño del conjunto de entrenamiento τ = 21 en X: {vol_21[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 21 en y: {vol_21[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 21 en X: {vol_21[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 21 en y: {vol_21[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 21 en X: {vol_21[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 21 en y: {vol_21[5].shape}')\n\nprint('\\nτ = 28')\nprint(f'Tamaño del conjunto de entrenamiento τ = 28 en X: {vol_28[0].shape}')\nprint(f'Tamaño del conjunto de entrenamiento τ = 28 en y: {vol_28[1].shape}')\nprint(f'Tamaño del conjunto de validación τ = 28 en X: {vol_28[2].shape}')\nprint(f'Tamaño del conjunto de validación τ = 28 en y: {vol_28[3].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 28 en X: {vol_28[4].shape}')\nprint(f'Tamaño del conjunto de prueba τ = 28 en y: {vol_28[5].shape}')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nτ = 7\nTamaño del conjunto de entrenamiento τ = 7 en X: (4971, 7)\nTamaño del conjunto de entrenamiento τ = 7 en y: (4971, 1)\nTamaño del conjunto de validación τ = 7 en X: (7, 7)\nTamaño del conjunto de validación τ = 7 en y: (7,)\nTamaño del conjunto de prueba τ = 7 en X: (7, 7)\nTamaño del conjunto de prueba τ = 7 en y: (7,)\n\nτ = 14\nTamaño del conjunto de entrenamiento τ = 14 en X: (4943, 14)\nTamaño del conjunto de entrenamiento τ = 14 en y: (4943, 1)\nTamaño del conjunto de validación τ = 14 en X: (14, 14)\nTamaño del conjunto de validación τ = 14 en y: (14,)\nTamaño del conjunto de prueba τ = 14 en X: (14, 14)\nTamaño del conjunto de prueba τ = 14 en y: (14,)\n\nτ = 21\nTamaño del conjunto de entrenamiento τ = 21 en X: (4915, 21)\nTamaño del conjunto de entrenamiento τ = 21 en y: (4915, 1)\nTamaño del conjunto de validación τ = 21 en X: (21, 21)\nTamaño del conjunto de validación τ = 21 en y: (21,)\nTamaño del conjunto de prueba τ = 21 en X: (21, 21)\nTamaño del conjunto de prueba τ = 21 en y: (21,)\n\nτ = 28\nTamaño del conjunto de entrenamiento τ = 28 en X: (4887, 28)\nTamaño del conjunto de entrenamiento τ = 28 en y: (4887, 1)\nTamaño del conjunto de validación τ = 28 en X: (28, 28)\nTamaño del conjunto de validación τ = 28 en y: (28,)\nTamaño del conjunto de prueba τ = 28 en X: (28, 28)\nTamaño del conjunto de prueba τ = 28 en y: (28,)\n```\n:::\n:::\n\n\n# Visualización de los pliegues extraídos\n\n::: {#8d106cf8 .cell execution_count=12}\n``` {.python .cell-code}\ndef plot_folds(data: np.array, tau_v: list, name: str):\n    fig = go.Figure()\n\n    colors = {\n        'train': '#9B7EBD',\n        'validation': '#7AB2D3',\n        'test': '#CBD2A4'\n    }\n\n    for i, tau in enumerate(tau_v):\n        X_train_s, y_train_s = data[i][0].shape, data[i][1].shape\n        X_val_s, y_val_s = data[i][2].shape, data[i][3].shape\n        X_test_s, y_test_s = data[i][4].shape, data[i][5].shape\n\n        fig.add_trace(go.Scatter(\n            x=list(range(1, X_train_s[0] + 1)),\n            y=[i + 1] * X_train_s[0],\n            mode='lines',\n            line=dict(color=colors['train'], width=6),\n            name='Train' if i == 0 else \"\",\n            showlegend=(i == 0)\n        ))\n\n        fig.add_trace(go.Scatter(\n            x=list(range(X_train_s[0] + 1, X_train_s[0] + X_val_s[0] + 1)),\n            y=[i + 1] * X_val_s[0],\n            mode='lines',\n            line=dict(color=colors['validation'], width=6),\n            name='Validation' if i == 0 else \"\",\n            showlegend=(i == 0)\n        ))\n\n        fig.add_trace(go.Scatter(\n            x=list(range(X_train_s[0] + X_val_s[0] + 1, X_train_s[0] + X_val_s[0] + X_test_s[0] + 1)),\n            y=[i + 1] * X_test_s[0],\n            mode='lines',\n            line=dict(color=colors['test'], width=6),\n            name='Test' if i == 0 else \"\",\n            showlegend=(i == 0)\n        ))\n\n    fig.update_layout(\n        title=f\"Visualización de pliegues para {name}\",\n        xaxis_title=\"Índice de tiempo\",\n        yaxis_title=\"Número de pliegue\",\n        legend=dict(orientation=\"h\", yanchor=\"bottom\", y=1.02, xanchor=\"right\", x=1),\n        margin={'b': 0, 'r': 30, 'l': 30, 't': 80},\n        plot_bgcolor='rgba(0, 0, 0, 0.0)',\n        paper_bgcolor='rgba(0, 0, 0, 0.0)',\n        font_color=\"white\",\n        hoverlabel=dict(\n            bgcolor=\"#222\"\n        ),\n        xaxis=dict(gridcolor='#222', tickfont=dict(color='white'), range = [4800, 5000]),\n        yaxis=dict(gridcolor='#222', tickfont=dict(color='white'), tickvals=[1, 2, 3, 4])\n    )\n\n    return fig\n```\n:::\n\n\n## Pliegues del precio\n\n::: {#25dc3c5e .cell execution_count=13}\n``` {.python .cell-code}\ntau_v = [7, 14, 21, 28]\n\nfig_p = plot_folds(price, tau_v, 'Price')\nfig_p.show()\n```\n:::\n\n\n\n\n``` {=html}\n<iframe\n    src = 'graphs/price_folds.html'\n    width = '730'\n    height = '400'\n    title = 'Visualización de los folds para la variable del precio'\n>\n</iframe>\n```\n\n\n\n\nEn esta visualización, se dividen los datos de precios en cuatro pliegues distintos, con cada pliegue utilizando una combinación específica de períodos de entrenamiento, validación y prueba. En cada pliegue, la sección morada representa los datos de entrenamiento, la sección azul claro corresponde a los datos de validación y la sección amarilla indica los datos de prueba. La estructura de estos pliegues asegura que todas las particiones del tiempo sean cubiertas, lo cual es esencial para evitar el sesgo temporal y evaluar correctamente la capacidad de generalización del modelo.\n\n## Pliegues del retorno acumulado\n\n::: {#9ae6df40 .cell execution_count=15}\n``` {.python .cell-code}\nfig_p = plot_folds(price, tau_v, 'A_j')\nfig_p.show()\n```\n:::\n\n\n\n\n``` {=html}\n<iframe\n    src = 'graphs/returncumsum_folds.html'\n    width = '730'\n    height = '400'\n    title = 'Visualización de los folds para la variable del retorno acumulado'\n>\n</iframe>\n```\n\n\n\n\nLos pliegues del retorno acumulado muestran una estructura similar a la de los precios, pero se enfocan en la serie temporal de retornos. Aquí, cada pliegue también cubre los períodos de entrenamiento, validación y prueba, lo cual es clave para evaluar cómo los modelos capturan la variabilidad y las tendencias de los retornos acumulados.\n\n## Pliegues de la volatilidad\n\n### σ = 7\n\n::: {#69f0e348 .cell execution_count=17}\n``` {.python .cell-code}\nfig_p = plot_folds(price, tau_v, 'σ_7')\nfig_p.show()\n```\n:::\n\n\n\n\n``` {=html}\n<iframe\n    src = 'graphs/vol7_folds.html'\n    width = '730'\n    height = '400'\n    title = 'Visualización de los folds para la variable de volatidilidad cuando σ = 7'\n>\n</iframe>\n```\n\n\n\n\n### σ = 14\n\n::: {#9f2825bd .cell execution_count=19}\n``` {.python .cell-code}\nfig_p = plot_folds(price, tau_v, 'σ_14')\nfig_p.show()\n```\n:::\n\n\n\n\n``` {=html}\n<iframe\n    src = 'graphs/vol14_folds.html'\n    width = '730'\n    height = '400'\n    title = 'Visualización de los folds para la variable de volatidilidad cuando σ = 14'\n>\n</iframe>\n```\n\n\n\n\n### σ = 21\n\n::: {#3673ba5b .cell execution_count=21}\n``` {.python .cell-code}\nfig_p = plot_folds(price, tau_v, 'σ_21')\nfig_p.show()\n```\n:::\n\n\n\n\n``` {=html}\n<iframe\n    src = 'graphs/vol21_folds.html'\n    width = '730'\n    height = '400'\n    title = 'Visualización de los folds para la variable de volatidilidad cuando σ = 21'\n>\n</iframe>\n```\n\n\n\n\n### σ = 28\n\n::: {#99cec9cf .cell execution_count=23}\n``` {.python .cell-code}\nfig_p = plot_folds(price, tau_v, 'σ_28')\nfig_p.show()\n```\n:::\n\n\n\n\n``` {=html}\n<iframe\n    src = 'graphs/vol28_folds.html'\n    width = '730'\n    height = '400'\n    title = 'Visualización de los folds para la variable de volatidilidad cuando σ = 28'\n>\n</iframe>\n```\n\n\n\n\nEn las visualizaciones de pliegues para σ_7, σ_14, σ_21 y σ_28, se presentan las divisiones para distintas medidas de volatilidad con diferentes valores de τ. Cada pliegue sigue la misma estructura de entrenamiento, validación y prueba, lo cual permite examinar cómo los modelos responden a los cambios en la volatilidad a lo largo de distintos horizontes temporales.\n\n# Modelos de Deep Learning\n\n## Multilayer Perceptron Models (MLP)\n\n### Predicciones para el precio\n\n#### τ = 7\n\n::: {#e9383734 .cell execution_count=25}\n``` {.python .cell-code}\ndef build_mlp(dim, learning_rate=0.001, activation='relu'):\n    model = Sequential()\n    model.add(Input(shape=(dim,)))\n    model.add(Dense(64, activation=activation))\n    model.add(Dense(32, activation=activation))\n    model.add(Dense(1, activation='linear'))\n    model.compile(optimizer=Adam(learning_rate=learning_rate), loss=losses.MeanSquaredError())\n    return model\n```\n:::\n\n\n::: {#91b04307 .cell execution_count=26}\n``` {.python .cell-code}\ndef get_grid(data, dim, var, tau, w = 1):\n    if var == 'volatilidad':\n        folder_path = f'best_grids/{var}/{var}_{w}_{tau}.pkl'\n    else:\n        folder_path = f'best_grids/{var}/{var}_{tau}.pkl'\n\n    if os.path.exists(folder_path):\n        print(\"Cargando resultados guardados...\")\n        with open(folder_path, 'rb') as file:\n            results = pickle.load(file)\n        return results\n\n    model = KerasRegressor(build_fn = build_mlp, verbose = 0, dim = dim)\n\n    param = {\n        'model__learning_rate': [0.001, 0.01, 0.1, 0.2],\n        'model__activation': ['relu', 'tanh', 'sigmoid'],\n        'epochs': [50, 100, 150]\n    }\n\n    grid = GridSearchCV(\n        estimator = model,\n        param_grid = param,\n        cv = 3,\n        verbose = 2\n    )\n\n    results = grid.fit(data[0], data[1])\n\n    with open(folder_path, 'wb') as file:\n        pickle.dump(results, file)\n\n    return results\n```\n:::\n\n\n::: {#d011ddd4 .cell execution_count=27}\n``` {.python .cell-code}\ndim = price[0][0].shape[1]\n\nresults = get_grid(price[0], dim, 'price', 7)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: relu\nMejor número de epocas: 50\nMejor Longitud de paso μ (Learning Rate): 0.001\nMejor Puntuación: 0.9929642587499478\n```\n:::\n:::\n\n\n::: {#f11446d5 .cell execution_count=28}\n``` {.python .cell-code}\ndef load_models(type_, folder, w, n = 1):\n    if folder == 'volatilidad':\n        folder_path = f'models/{type_}/{folder}/{n}/{w}'\n    else:\n        folder_path = f'models/{type_}/{folder}/{w}'\n\n    models = []\n    for filename in sorted(os.listdir(folder_path)):\n        if filename.endswith('.keras'):\n            models.append(load_model(os.path.join(folder_path, filename)))\n    return models\n\ndef save_models(models, type_, folder, w, n = 1):\n    if folder == 'volatilidad':\n        folder_path = f'models/{type_}/{folder}/{n}/{w}'\n    else:\n        folder_path = f'models/{type_}/{folder}/{w}'\n\n    if not os.path.exists(folder_path):\n        os.makedirs(folder_path)\n    \n    for i, model in enumerate(models):\n        model.save(os.path.join(folder_path, f'MLP_{w}_{i}.keras'))\n\ndef build_model(type_, var, dim, neurons, dropouts, activation, learning_rate, w, n = 1):\n    models = load_models(type_, var, w, n)\n    if models:\n        print(f\"Modelos cargados desde la carpeta '{var}'.\")\n        return models\n\n    print(f\"No se encontraron modelos en la carpeta '{var}', construyendo nuevos modelos...\")\n\n    models = []\n\n    for neuron in neurons:\n        for dropout in dropouts:\n            model = Sequential()\n            model.add(Input(shape = (dim, )))\n            model.add(Dense(neuron, activation=activation))\n            model.add(Dense(neuron // 2, activation=activation))\n            model.add(Dense(neuron // 2, activation=activation))\n            model.add(Dropout(dropout))\n            model.add(Dense(1, activation='linear'))\n            model.compile(optimizer=Adam(learning_rate=learning_rate), loss='mse')\n            \n            models.append(model)\n\n            print(f'Modelo con {(neuron, neuron // 2, neuron // 2, 1)} neuronas y dropout {dropout}:')\n            model.summary()\n\n    save_models(models, type_, var, w, n)\n    return models\n```\n:::\n\n\n::: {#c842df79 .cell execution_count=29}\n``` {.python .cell-code}\nneurons = [32, 64, 128]\ndropouts = [0.2, 0.4, 0.6, 0.8]\n\nmodels = build_model('MLP', 'price', dim, neurons, dropouts, best_activation, best_mu, 7)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'price'.\n```\n:::\n:::\n\n\n::: {#42e3e609 .cell execution_count=30}\n``` {.python .cell-code}\ndef best_model(var, models, X_val, y_val):\n    results = []\n\n    for i, model in enumerate(models):\n        pred = model.predict(X_val)\n\n        pred = pred.ravel()\n        y_val = y_val.ravel()\n\n        mape = mean_absolute_percentage_error(y_val, pred)\n        mae = mean_absolute_error(y_val, pred)\n        mse = mean_squared_error(y_val, pred)\n        rmse = np.sqrt(mse)\n        r2 = r2_score(y_val, pred)\n\n        #ljungbox = acorr_ljungbox(pred - y_val, lags = [10], return_df = True)['lb_pvalue'].iloc[0]\n        jb_stat, jb_p = jarque_bera(pred - y_val)\n\n        print(f'Modelo {i}: MSE = {mse:.4f}')\n\n        results.append({\n            \"Model Name\": f'MLP_{var}_{i}',\n            \"MAPE\": mape,\n            \"MAE\": mae,\n            \"RMSE\": rmse,\n            \"MSE\": mse,\n            \"R2\": r2,\n            #\"Ljung-Box P-Value\": ljungbox,\n            \"Jarque-Bera P-Value\": jb_p\n        })\n\n    results = pd.DataFrame(results)\n    return results\n```\n:::\n\n\n::: {#b9c6d114 .cell execution_count=31}\n``` {.python .cell-code}\nmlp_p7_metrics = best_model('price', models, price[0][2], price[0][3])\n\nmlp_p7_metrics\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step\nModelo 0: MSE = 0.0087\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 1: MSE = 0.0053\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 2: MSE = 0.0102\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 3: MSE = 0.0171\nWARNING:tensorflow:5 out of the last 5 calls to <function TensorFlowTrainer.make_predict_function.<locals>.one_step_on_data_distributed at 0x16ab35790> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\nModelo 4: MSE = 0.0130\nWARNING:tensorflow:6 out of the last 6 calls to <function TensorFlowTrainer.make_predict_function.<locals>.one_step_on_data_distributed at 0x16ab94430> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 22ms/step\nModelo 5: MSE = 0.0211\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 6: MSE = 0.0103\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 22ms/step\nModelo 7: MSE = 0.0135\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 8: MSE = 0.0118\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 9: MSE = 0.0015\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 10: MSE = 0.0074\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 11: MSE = 0.0246\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=31}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_price_0</td>\n      <td>0.933592</td>\n      <td>0.093359</td>\n      <td>0.093359</td>\n      <td>0.008716</td>\n      <td>-4.525579e+31</td>\n      <td>0.55747</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_price_1</td>\n      <td>0.725742</td>\n      <td>0.072574</td>\n      <td>0.072574</td>\n      <td>0.005267</td>\n      <td>-2.734788e+31</td>\n      <td>0.55747</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_price_2</td>\n      <td>1.008198</td>\n      <td>0.100820</td>\n      <td>0.100820</td>\n      <td>0.010165</td>\n      <td>-5.277783e+31</td>\n      <td>0.55747</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_price_3</td>\n      <td>1.306148</td>\n      <td>0.130615</td>\n      <td>0.130615</td>\n      <td>0.017060</td>\n      <td>-8.858173e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_price_4</td>\n      <td>1.139195</td>\n      <td>0.113920</td>\n      <td>0.113920</td>\n      <td>0.012978</td>\n      <td>-6.738385e+31</td>\n      <td>0.55747</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_price_5</td>\n      <td>1.454286</td>\n      <td>0.145429</td>\n      <td>0.145429</td>\n      <td>0.021149</td>\n      <td>-1.098144e+32</td>\n      <td>0.55747</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_price_6</td>\n      <td>1.012448</td>\n      <td>0.101245</td>\n      <td>0.101245</td>\n      <td>0.010251</td>\n      <td>-5.322367e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_price_7</td>\n      <td>1.163491</td>\n      <td>0.116349</td>\n      <td>0.116349</td>\n      <td>0.013537</td>\n      <td>-7.028867e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_price_8</td>\n      <td>1.085518</td>\n      <td>0.108552</td>\n      <td>0.108552</td>\n      <td>0.011783</td>\n      <td>-6.118338e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_price_9</td>\n      <td>0.390892</td>\n      <td>0.039089</td>\n      <td>0.039089</td>\n      <td>0.001528</td>\n      <td>-7.933669e+30</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_price_10</td>\n      <td>0.858189</td>\n      <td>0.085819</td>\n      <td>0.085819</td>\n      <td>0.007365</td>\n      <td>-3.824063e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_price_11</td>\n      <td>1.569040</td>\n      <td>0.156904</td>\n      <td>0.156904</td>\n      <td>0.024619</td>\n      <td>-1.278285e+32</td>\n      <td>0.55747</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n#### τ = 14\n\n::: {#6297647c .cell execution_count=32}\n``` {.python .cell-code}\ndim = price[1][0].shape[1]\n\nresults = get_grid(price[1], dim, 'price', 14)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: relu\nMejor número de epocas: 100\nMejor Longitud de paso μ (Learning Rate): 0.001\nMejor Puntuación: 0.9923356886891406\n```\n:::\n:::\n\n\n::: {#45eb1c69 .cell execution_count=33}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'price', dim, neurons, dropouts, best_activation, best_mu, 14)\n\nmlp_p14_metrics = best_model('price', models, price[1][2], price[1][3])\nmlp_p14_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'price'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 0: MSE = 0.0119\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 1: MSE = 0.0219\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 2: MSE = 0.0118\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 3: MSE = 0.0146\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 4: MSE = 0.0254\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 5: MSE = 0.0116\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 6: MSE = 0.0107\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 7: MSE = 0.0159\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 8: MSE = 0.0129\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 9: MSE = 0.0043\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 10: MSE = 0.0153\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 11: MSE = 0.0122\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=33}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_price_0</td>\n      <td>1.088821</td>\n      <td>0.108882</td>\n      <td>0.108882</td>\n      <td>0.011855</td>\n      <td>-6.155626e+31</td>\n      <td>0.245879</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_price_1</td>\n      <td>1.480355</td>\n      <td>0.148035</td>\n      <td>0.148035</td>\n      <td>0.021914</td>\n      <td>-1.137866e+32</td>\n      <td>0.245879</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_price_2</td>\n      <td>1.085182</td>\n      <td>0.108518</td>\n      <td>0.108518</td>\n      <td>0.011776</td>\n      <td>-6.114548e+31</td>\n      <td>0.245879</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_price_3</td>\n      <td>1.210023</td>\n      <td>0.121002</td>\n      <td>0.121002</td>\n      <td>0.014642</td>\n      <td>-7.602329e+31</td>\n      <td>0.245879</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_price_4</td>\n      <td>1.593198</td>\n      <td>0.159320</td>\n      <td>0.159320</td>\n      <td>0.025383</td>\n      <td>-1.317951e+32</td>\n      <td>0.245879</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_price_5</td>\n      <td>1.077287</td>\n      <td>0.107729</td>\n      <td>0.107729</td>\n      <td>0.011605</td>\n      <td>-6.025910e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_price_6</td>\n      <td>1.032645</td>\n      <td>0.103265</td>\n      <td>0.103265</td>\n      <td>0.010664</td>\n      <td>-5.536839e+31</td>\n      <td>0.245879</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_price_7</td>\n      <td>1.262066</td>\n      <td>0.126207</td>\n      <td>0.126207</td>\n      <td>0.015928</td>\n      <td>-8.270341e+31</td>\n      <td>0.245879</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_price_8</td>\n      <td>1.136970</td>\n      <td>0.113697</td>\n      <td>0.113697</td>\n      <td>0.012927</td>\n      <td>-6.712084e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_price_9</td>\n      <td>0.654840</td>\n      <td>0.065484</td>\n      <td>0.065484</td>\n      <td>0.004288</td>\n      <td>-2.226534e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_price_10</td>\n      <td>1.237239</td>\n      <td>0.123724</td>\n      <td>0.123724</td>\n      <td>0.015308</td>\n      <td>-7.948164e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_price_11</td>\n      <td>1.103586</td>\n      <td>0.110359</td>\n      <td>0.110359</td>\n      <td>0.012179</td>\n      <td>-6.323704e+31</td>\n      <td>0.245879</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n#### τ = 21\n\n::: {#4a9f4f0c .cell execution_count=34}\n``` {.python .cell-code}\ndim = price[2][0].shape[1]\n\nresults = get_grid(price[2], dim, 'price', 21)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: relu\nMejor número de epocas: 100\nMejor Longitud de paso μ (Learning Rate): 0.001\nMejor Puntuación: 0.992061931285642\n```\n:::\n:::\n\n\n::: {#0fe17bb8 .cell execution_count=35}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'price', dim, neurons, dropouts, best_activation, best_mu, 21)\n\nmlp_p21_metrics = best_model('price', models, price[2][2], price[2][3])\nmlp_p21_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'price'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 0: MSE = 0.0011\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 1: MSE = 0.0104\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 2: MSE = 0.0074\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 3: MSE = 0.0099\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 4: MSE = 0.0118\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 5: MSE = 0.0441\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 6: MSE = 0.0076\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 7: MSE = 0.0067\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 8: MSE = 0.0081\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 9: MSE = 0.0089\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 10: MSE = 0.0041\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 11: MSE = 0.0267\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=35}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_price_0</td>\n      <td>0.324668</td>\n      <td>0.032467</td>\n      <td>0.032467</td>\n      <td>0.001054</td>\n      <td>-5.473179e+30</td>\n      <td>0.011652</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_price_1</td>\n      <td>1.021305</td>\n      <td>0.102130</td>\n      <td>0.102130</td>\n      <td>0.010431</td>\n      <td>-5.415893e+31</td>\n      <td>0.011652</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_price_2</td>\n      <td>0.858484</td>\n      <td>0.085848</td>\n      <td>0.085848</td>\n      <td>0.007370</td>\n      <td>-3.826697e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_price_3</td>\n      <td>0.994687</td>\n      <td>0.099469</td>\n      <td>0.099469</td>\n      <td>0.009894</td>\n      <td>-5.137266e+31</td>\n      <td>0.011652</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_price_4</td>\n      <td>1.088038</td>\n      <td>0.108804</td>\n      <td>0.108804</td>\n      <td>0.011838</td>\n      <td>-6.146784e+31</td>\n      <td>0.011652</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_price_5</td>\n      <td>2.099725</td>\n      <td>0.209973</td>\n      <td>0.209973</td>\n      <td>0.044088</td>\n      <td>-2.289203e+32</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_price_6</td>\n      <td>0.871561</td>\n      <td>0.087156</td>\n      <td>0.087156</td>\n      <td>0.007596</td>\n      <td>-3.944169e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_price_7</td>\n      <td>0.819830</td>\n      <td>0.081983</td>\n      <td>0.081983</td>\n      <td>0.006721</td>\n      <td>-3.489850e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_price_8</td>\n      <td>0.902006</td>\n      <td>0.090201</td>\n      <td>0.090201</td>\n      <td>0.008136</td>\n      <td>-4.224529e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_price_9</td>\n      <td>0.942669</td>\n      <td>0.094267</td>\n      <td>0.094267</td>\n      <td>0.008886</td>\n      <td>-4.614005e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_price_10</td>\n      <td>0.641203</td>\n      <td>0.064120</td>\n      <td>0.064120</td>\n      <td>0.004111</td>\n      <td>-2.134768e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_price_11</td>\n      <td>1.633952</td>\n      <td>0.163395</td>\n      <td>0.163395</td>\n      <td>0.026698</td>\n      <td>-1.386239e+32</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n#### τ = 28\n\n::: {#3254bc43 .cell execution_count=36}\n``` {.python .cell-code}\ndim = price[3][0].shape[1]\n\nresults = get_grid(price[3], dim, 'price', 28)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: relu\nMejor número de epocas: 50\nMejor Longitud de paso μ (Learning Rate): 0.01\nMejor Puntuación: 0.9915164107311906\n```\n:::\n:::\n\n\n::: {#fdf94d9a .cell execution_count=37}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'price', dim, neurons, dropouts, best_activation, best_mu, 28)\n\nmlp_p28_metrics = best_model('price', models, price[3][2], price[3][3])\nmlp_p28_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'price'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 0: MSE = 0.0003\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 1: MSE = 0.0085\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 2: MSE = 0.0105\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 3: MSE = 0.0172\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 4: MSE = 0.0090\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 5: MSE = 0.0006\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 6: MSE = 0.0088\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 7: MSE = 0.0168\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 8: MSE = 0.0050\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 9: MSE = 0.0087\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 10: MSE = 0.0273\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 11: MSE = 0.0209\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=37}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_price_0</td>\n      <td>0.171046</td>\n      <td>0.017105</td>\n      <td>0.018523</td>\n      <td>0.000343</td>\n      <td>-1.781498e+30</td>\n      <td>4.947980e-03</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_price_1</td>\n      <td>0.919785</td>\n      <td>0.091978</td>\n      <td>0.092095</td>\n      <td>0.008481</td>\n      <td>-4.403843e+31</td>\n      <td>7.044676e-23</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_price_2</td>\n      <td>1.021332</td>\n      <td>0.102133</td>\n      <td>0.102334</td>\n      <td>0.010472</td>\n      <td>-5.437525e+31</td>\n      <td>1.268079e-02</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_price_3</td>\n      <td>1.305967</td>\n      <td>0.130597</td>\n      <td>0.131146</td>\n      <td>0.017199</td>\n      <td>-8.930358e+31</td>\n      <td>1.218378e-01</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_price_4</td>\n      <td>0.950463</td>\n      <td>0.095046</td>\n      <td>0.095080</td>\n      <td>0.009040</td>\n      <td>-4.693975e+31</td>\n      <td>8.858452e-07</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_price_5</td>\n      <td>0.230914</td>\n      <td>0.023091</td>\n      <td>0.025364</td>\n      <td>0.000643</td>\n      <td>-3.340493e+30</td>\n      <td>8.672279e-02</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_price_6</td>\n      <td>0.933272</td>\n      <td>0.093327</td>\n      <td>0.093712</td>\n      <td>0.008782</td>\n      <td>-4.559847e+31</td>\n      <td>6.673026e-02</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_price_7</td>\n      <td>1.292144</td>\n      <td>0.129214</td>\n      <td>0.129778</td>\n      <td>0.016842</td>\n      <td>-8.745025e+31</td>\n      <td>1.005144e-03</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_price_8</td>\n      <td>0.701524</td>\n      <td>0.070152</td>\n      <td>0.070636</td>\n      <td>0.004989</td>\n      <td>-2.590696e+31</td>\n      <td>2.241195e-01</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_price_9</td>\n      <td>0.932640</td>\n      <td>0.093264</td>\n      <td>0.093422</td>\n      <td>0.008728</td>\n      <td>-4.531647e+31</td>\n      <td>1.477324e-06</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_price_10</td>\n      <td>1.650198</td>\n      <td>0.165020</td>\n      <td>0.165223</td>\n      <td>0.027298</td>\n      <td>-1.417418e+32</td>\n      <td>3.693883e-18</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_price_11</td>\n      <td>1.443498</td>\n      <td>0.144350</td>\n      <td>0.144478</td>\n      <td>0.020874</td>\n      <td>-1.083842e+32</td>\n      <td>9.277897e-17</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Predicciones para el retorno acumulado\n\n#### τ = 7\n\n::: {#18f0bfea .cell execution_count=38}\n``` {.python .cell-code}\ndim = at[0][0].shape[1]\n\nresults = get_grid(at[0], dim, 'retorno', 7)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: relu\nMejor número de epocas: 150\nMejor Longitud de paso μ (Learning Rate): 0.01\nMejor Puntuación: 0.9953678427084359\n```\n:::\n:::\n\n\n::: {#0e74db88 .cell execution_count=39}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'retorno', dim, neurons, dropouts, best_activation, best_mu, 7)\n\nmlp_at7_metrics = best_model('at', models, at[0][2], at[0][3])\nmlp_at7_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'retorno'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 0: MSE = 13.5456\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 1: MSE = 6.5067\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 2: MSE = 16.8533\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 3: MSE = 31.8977\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 4: MSE = 32.0769\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 5: MSE = 28.4867\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 6: MSE = 13.2960\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 7: MSE = 22.6537\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 8: MSE = 9.9795\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 9: MSE = 13.0616\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 10: MSE = 5.4229\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 11: MSE = 19.5227\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=39}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_at_0</td>\n      <td>0.851365</td>\n      <td>3.680431</td>\n      <td>3.680431</td>\n      <td>13.545571</td>\n      <td>0.0</td>\n      <td>0.55747</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_at_1</td>\n      <td>0.590060</td>\n      <td>2.550815</td>\n      <td>2.550815</td>\n      <td>6.506657</td>\n      <td>0.0</td>\n      <td>0.55747</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_at_2</td>\n      <td>0.949641</td>\n      <td>4.105279</td>\n      <td>4.105279</td>\n      <td>16.853318</td>\n      <td>0.0</td>\n      <td>0.55747</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_at_3</td>\n      <td>1.306462</td>\n      <td>5.647805</td>\n      <td>5.647805</td>\n      <td>31.897697</td>\n      <td>0.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_at_4</td>\n      <td>1.310126</td>\n      <td>5.663645</td>\n      <td>5.663645</td>\n      <td>32.076874</td>\n      <td>0.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_at_5</td>\n      <td>1.234634</td>\n      <td>5.337297</td>\n      <td>5.337297</td>\n      <td>28.486740</td>\n      <td>0.0</td>\n      <td>0.55747</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_at_6</td>\n      <td>0.843485</td>\n      <td>3.646367</td>\n      <td>3.646367</td>\n      <td>13.295995</td>\n      <td>0.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_at_7</td>\n      <td>1.100998</td>\n      <td>4.759590</td>\n      <td>4.759590</td>\n      <td>22.653696</td>\n      <td>0.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_at_8</td>\n      <td>0.730754</td>\n      <td>3.159033</td>\n      <td>3.159033</td>\n      <td>9.979490</td>\n      <td>0.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_at_9</td>\n      <td>0.836017</td>\n      <td>3.614082</td>\n      <td>3.614082</td>\n      <td>13.061586</td>\n      <td>0.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_at_10</td>\n      <td>0.538684</td>\n      <td>2.328720</td>\n      <td>2.328720</td>\n      <td>5.422937</td>\n      <td>0.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_at_11</td>\n      <td>1.022086</td>\n      <td>4.418454</td>\n      <td>4.418454</td>\n      <td>19.522739</td>\n      <td>0.0</td>\n      <td>0.55747</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n#### τ = 14\n\n::: {#0eb62cab .cell execution_count=40}\n``` {.python .cell-code}\ndim = at[1][0].shape[1]\n\nresults = get_grid(at[1], dim, 'retorno', 14)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: relu\nMejor número de epocas: 100\nMejor Longitud de paso μ (Learning Rate): 0.001\nMejor Puntuación: 0.9947286045222513\n```\n:::\n:::\n\n\n::: {#1e4e00bd .cell execution_count=41}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'retorno', dim, neurons, dropouts, best_activation, best_mu, 14)\n\nmlp_at14_metrics = best_model('at', models, at[1][2], at[1][3])\nmlp_at14_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'retorno'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\nModelo 0: MSE = 18.0576\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\nModelo 1: MSE = 21.3061\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 2: MSE = 18.5075\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 3: MSE = 21.6683\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 4: MSE = 18.0936\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 5: MSE = 21.4362\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\nModelo 6: MSE = 4.8328\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 7: MSE = 19.3612\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 8: MSE = 24.7572\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 9: MSE = 13.9393\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 10: MSE = 25.1080\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 11: MSE = 23.0428\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=41}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_at_0</td>\n      <td>0.982985</td>\n      <td>4.249425</td>\n      <td>4.249425</td>\n      <td>18.057611</td>\n      <td>-2.289074e+31</td>\n      <td>0.245879</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_at_1</td>\n      <td>1.067749</td>\n      <td>4.615857</td>\n      <td>4.615857</td>\n      <td>21.306138</td>\n      <td>-2.700874e+31</td>\n      <td>0.245879</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_at_2</td>\n      <td>0.995156</td>\n      <td>4.302037</td>\n      <td>4.302037</td>\n      <td>18.507526</td>\n      <td>-2.346108e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_at_3</td>\n      <td>1.076787</td>\n      <td>4.654926</td>\n      <td>4.654926</td>\n      <td>21.668332</td>\n      <td>-2.746787e+31</td>\n      <td>0.245879</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_at_4</td>\n      <td>0.983966</td>\n      <td>4.253663</td>\n      <td>4.253663</td>\n      <td>18.093648</td>\n      <td>-2.293642e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_at_5</td>\n      <td>1.071004</td>\n      <td>4.629929</td>\n      <td>4.629929</td>\n      <td>21.436242</td>\n      <td>-2.717366e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_at_6</td>\n      <td>0.508532</td>\n      <td>2.198373</td>\n      <td>2.198373</td>\n      <td>4.832846</td>\n      <td>-6.126360e+30</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_at_7</td>\n      <td>1.017849</td>\n      <td>4.400140</td>\n      <td>4.400140</td>\n      <td>19.361229</td>\n      <td>-2.454327e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_at_8</td>\n      <td>1.150979</td>\n      <td>4.975658</td>\n      <td>4.975658</td>\n      <td>24.757176</td>\n      <td>-3.138345e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_at_9</td>\n      <td>0.863649</td>\n      <td>3.733536</td>\n      <td>3.733536</td>\n      <td>13.939291</td>\n      <td>-1.767015e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_at_10</td>\n      <td>1.159105</td>\n      <td>5.010787</td>\n      <td>5.010787</td>\n      <td>25.107990</td>\n      <td>-3.182816e+31</td>\n      <td>0.245879</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_at_11</td>\n      <td>1.110414</td>\n      <td>4.800294</td>\n      <td>4.800294</td>\n      <td>23.042820</td>\n      <td>-2.921025e+31</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n#### τ = 21\n\n::: {#e1bb6851 .cell execution_count=42}\n``` {.python .cell-code}\ndim = at[2][0].shape[1]\n\nresults = get_grid(at[2], dim, 'retorno', 21)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: sigmoid\nMejor número de epocas: 100\nMejor Longitud de paso μ (Learning Rate): 0.001\nMejor Puntuación: 0.9944296065331537\n```\n:::\n:::\n\n\n::: {#85ce12b1 .cell execution_count=43}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'retorno', dim, neurons, dropouts, best_activation, best_mu, 21)\n\nmlp_at21_metrics = best_model('at', models, at[2][2], at[2][3])\nmlp_at21_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'retorno'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 0: MSE = 15.9112\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 1: MSE = 18.6403\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 2: MSE = 16.3590\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 3: MSE = 14.0434\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 4: MSE = 18.7071\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 5: MSE = 19.2759\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 6: MSE = 8.8351\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 7: MSE = 15.1769\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 8: MSE = 12.4313\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 9: MSE = 16.4611\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 10: MSE = 18.3412\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 11: MSE = 17.6120\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:\n\nPrecision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.\n\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=43}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_at_0</td>\n      <td>0.922717</td>\n      <td>3.988885</td>\n      <td>3.988885</td>\n      <td>15.911201</td>\n      <td>-2.016984e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_at_1</td>\n      <td>0.998718</td>\n      <td>4.317438</td>\n      <td>4.317438</td>\n      <td>18.640267</td>\n      <td>-2.362935e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_at_2</td>\n      <td>0.935610</td>\n      <td>4.044621</td>\n      <td>4.044621</td>\n      <td>16.358958</td>\n      <td>-2.073744e+31</td>\n      <td>0.011652</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_at_3</td>\n      <td>0.866869</td>\n      <td>3.747456</td>\n      <td>3.747456</td>\n      <td>14.043430</td>\n      <td>-1.780216e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_at_4</td>\n      <td>1.000508</td>\n      <td>4.325176</td>\n      <td>4.325176</td>\n      <td>18.707149</td>\n      <td>-2.371413e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_at_5</td>\n      <td>1.015603</td>\n      <td>4.390428</td>\n      <td>4.390428</td>\n      <td>19.275856</td>\n      <td>-2.443505e+31</td>\n      <td>0.011652</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_at_6</td>\n      <td>0.687578</td>\n      <td>2.972386</td>\n      <td>2.972386</td>\n      <td>8.835076</td>\n      <td>-1.119979e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_at_7</td>\n      <td>0.901173</td>\n      <td>3.895749</td>\n      <td>3.895749</td>\n      <td>15.176864</td>\n      <td>-1.923896e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_at_8</td>\n      <td>0.815598</td>\n      <td>3.525812</td>\n      <td>3.525812</td>\n      <td>12.431349</td>\n      <td>-1.575861e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_at_9</td>\n      <td>0.938525</td>\n      <td>4.057223</td>\n      <td>4.057223</td>\n      <td>16.461059</td>\n      <td>-2.086687e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_at_10</td>\n      <td>0.990675</td>\n      <td>4.282668</td>\n      <td>4.282668</td>\n      <td>18.341241</td>\n      <td>-2.325029e+31</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_at_11</td>\n      <td>0.970782</td>\n      <td>4.196668</td>\n      <td>4.196668</td>\n      <td>17.612022</td>\n      <td>-2.232589e+31</td>\n      <td>0.011652</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n#### τ = 28\n\n::: {#71a03263 .cell execution_count=44}\n``` {.python .cell-code}\ndim = at[3][0].shape[1]\n\nresults = get_grid(at[3], dim, 'retorno', 28)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: relu\nMejor número de epocas: 50\nMejor Longitud de paso μ (Learning Rate): 0.001\nMejor Puntuación: 0.9926096353221231\n```\n:::\n:::\n\n\n::: {#7c26e9a8 .cell execution_count=45}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'retorno', dim, neurons, dropouts, best_activation, best_mu, 28)\n\nmlp_at28_metrics = best_model('at', models, at[3][2], at[3][3])\nmlp_at28_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'retorno'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 0: MSE = 21.2353\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 1: MSE = 28.0062\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 2: MSE = 13.2884\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 3: MSE = 20.3033\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 4: MSE = 22.2990\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\nModelo 5: MSE = 19.4056\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 6: MSE = 11.5393\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 7: MSE = 17.3125\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 8: MSE = 19.5027\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 9: MSE = 27.7216\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 10: MSE = 16.9307\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\nModelo 11: MSE = 8.9896\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=45}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_at_0</td>\n      <td>1.065973</td>\n      <td>4.608177</td>\n      <td>4.608178</td>\n      <td>21.235300</td>\n      <td>-2.691894e+31</td>\n      <td>1.492363e-01</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_at_1</td>\n      <td>1.224176</td>\n      <td>5.292086</td>\n      <td>5.292086</td>\n      <td>28.006174</td>\n      <td>-3.550204e+31</td>\n      <td>1.041470e-01</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_at_2</td>\n      <td>0.843245</td>\n      <td>3.645330</td>\n      <td>3.645330</td>\n      <td>13.288431</td>\n      <td>-1.684509e+31</td>\n      <td>2.453968e-11</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_at_3</td>\n      <td>1.042319</td>\n      <td>4.505923</td>\n      <td>4.505923</td>\n      <td>20.303339</td>\n      <td>-2.573754e+31</td>\n      <td>6.852999e-02</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_at_4</td>\n      <td>1.092344</td>\n      <td>4.722177</td>\n      <td>4.722178</td>\n      <td>22.298961</td>\n      <td>-2.826729e+31</td>\n      <td>8.630661e-02</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_at_5</td>\n      <td>1.019015</td>\n      <td>4.405180</td>\n      <td>4.405181</td>\n      <td>19.405622</td>\n      <td>-2.459955e+31</td>\n      <td>2.404680e-04</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_at_6</td>\n      <td>0.785789</td>\n      <td>3.396948</td>\n      <td>3.396948</td>\n      <td>11.539258</td>\n      <td>-1.462775e+31</td>\n      <td>7.977298e-02</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_at_7</td>\n      <td>0.962491</td>\n      <td>4.160828</td>\n      <td>4.160828</td>\n      <td>17.312489</td>\n      <td>-2.194619e+31</td>\n      <td>2.762365e-03</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_at_8</td>\n      <td>1.021561</td>\n      <td>4.416188</td>\n      <td>4.416188</td>\n      <td>19.502714</td>\n      <td>-2.472263e+31</td>\n      <td>2.311245e-02</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_at_9</td>\n      <td>1.217942</td>\n      <td>5.265135</td>\n      <td>5.265135</td>\n      <td>27.721643</td>\n      <td>-3.514136e+31</td>\n      <td>4.282240e-02</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_at_10</td>\n      <td>0.951819</td>\n      <td>4.114693</td>\n      <td>4.114694</td>\n      <td>16.930703</td>\n      <td>-2.146222e+31</td>\n      <td>7.021213e-02</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_at_11</td>\n      <td>0.693565</td>\n      <td>2.998265</td>\n      <td>2.998265</td>\n      <td>8.989592</td>\n      <td>-1.139566e+31</td>\n      <td>1.668459e-10</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Predicciones para la volatilidad\n\n#### Volatilidad con ventana σ = 7 \n\n##### τ = 7\n\n::: {#13694a62 .cell execution_count=46}\n``` {.python .cell-code}\ndim = vo_7[0][0].shape[1]\n\nresults = get_grid(vo_7[0], dim, 'volatilidad', 7, 7)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: tanh\nMejor número de epocas: 100\nMejor Longitud de paso μ (Learning Rate): 0.001\nMejor Puntuación: 0.8458686359787372\n```\n:::\n:::\n\n\n::: {#7e92b2e5 .cell execution_count=47}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'volatilidad', dim, neurons, dropouts, best_activation, best_mu, 7, 7)\n\nmlp_vol7_7_metrics = best_model('vol7', models, vo_7[0][2], vo_7[0][3])\nmlp_vol7_7_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'volatilidad'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 0: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 1: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 2: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 3: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 4: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 5: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 6: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 7: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 8: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 9: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 10: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 11: MSE = 0.0000\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=47}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_vol7_0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_vol7_1</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_vol7_2</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_vol7_3</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_vol7_4</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_vol7_5</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_vol7_6</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_vol7_7</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_vol7_8</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_vol7_9</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_vol7_10</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_vol7_11</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n##### τ = 14\n\n::: {#fd6dfa24 .cell execution_count=48}\n``` {.python .cell-code}\ndim = vo_7[1][0].shape[1]\n\nresults = get_grid(vo_7[1], dim, 'volatilidad', 14, 7)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: relu\nMejor número de epocas: 150\nMejor Longitud de paso μ (Learning Rate): 0.01\nMejor Puntuación: 0.8851995559100326\n```\n:::\n:::\n\n\n::: {#87d9b672 .cell execution_count=49}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'volatilidad', dim, neurons, dropouts, best_activation, best_mu, 14, 7)\n\nmlp_vol7_14_metrics = best_model('vol7', models, vo_7[1][2], vo_7[1][3])\nmlp_vol7_14_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'volatilidad'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 0: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 1: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 2: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 3: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 4: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 5: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 6: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 7: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 8: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 9: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 10: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 11: MSE = 0.0000\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=49}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_vol7_0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_vol7_1</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_vol7_2</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_vol7_3</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_vol7_4</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_vol7_5</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_vol7_6</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_vol7_7</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_vol7_8</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_vol7_9</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_vol7_10</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_vol7_11</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n##### τ = 21\n\n::: {#92eb5002 .cell execution_count=50}\n``` {.python .cell-code}\ndim = vo_7[2][0].shape[1]\n\nresults = get_grid(vo_7[2], dim, 'volatilidad', 21, 7)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: relu\nMejor número de epocas: 100\nMejor Longitud de paso μ (Learning Rate): 0.001\nMejor Puntuación: 0.8838780194852301\n```\n:::\n:::\n\n\n::: {#47ddf6db .cell execution_count=51}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'volatilidad', dim, neurons, dropouts, best_activation, best_mu, 21, 7)\n\nmlp_vol7_21_metrics = best_model('vol7', models, vo_7[2][2], vo_7[2][3])\nmlp_vol7_21_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'volatilidad'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 0: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 1: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\nModelo 2: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\nModelo 3: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\nModelo 4: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\nModelo 5: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 6: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 7: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\nModelo 8: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\nModelo 9: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 10: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 11: MSE = 0.0000\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=51}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_vol7_0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_vol7_1</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_vol7_2</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_vol7_3</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_vol7_4</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_vol7_5</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_vol7_6</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_vol7_7</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_vol7_8</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_vol7_9</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_vol7_10</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_vol7_11</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n##### τ = 28\n\n::: {#62c29309 .cell execution_count=52}\n``` {.python .cell-code}\ndim = vo_7[3][0].shape[1]\n\nresults = get_grid(vo_7[3], dim, 'volatilidad', 28, 7)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: relu\nMejor número de epocas: 150\nMejor Longitud de paso μ (Learning Rate): 0.01\nMejor Puntuación: 0.8735585364167684\n```\n:::\n:::\n\n\n::: {#790e6eb5 .cell execution_count=53}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'volatilidad', dim, neurons, dropouts, best_activation, best_mu, 28, 7)\n\nmlp_vol7_28_metrics = best_model('vol7', models, vo_7[3][2], vo_7[3][3])\nmlp_vol7_28_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'volatilidad'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 0: MSE = 0.0451\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 1: MSE = 0.0034\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 2: MSE = 0.0024\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 3: MSE = 0.0102\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 4: MSE = 0.0114\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 22ms/step\nModelo 5: MSE = 0.0085\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 6: MSE = 0.0019\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 7: MSE = 0.0038\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 8: MSE = 0.0072\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 9: MSE = 0.0286\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 10: MSE = 0.0759\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 11: MSE = 0.0087\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=53}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_vol7_0</td>\n      <td>7.162994e+14</td>\n      <td>0.159050</td>\n      <td>0.212475</td>\n      <td>0.045146</td>\n      <td>0.0</td>\n      <td>0.499207</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_vol7_1</td>\n      <td>1.794322e+14</td>\n      <td>0.039842</td>\n      <td>0.057953</td>\n      <td>0.003359</td>\n      <td>0.0</td>\n      <td>0.989639</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_vol7_2</td>\n      <td>1.590308e+14</td>\n      <td>0.035312</td>\n      <td>0.049172</td>\n      <td>0.002418</td>\n      <td>0.0</td>\n      <td>0.561823</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_vol7_3</td>\n      <td>2.797398e+14</td>\n      <td>0.062115</td>\n      <td>0.100935</td>\n      <td>0.010188</td>\n      <td>0.0</td>\n      <td>0.075613</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_vol7_4</td>\n      <td>3.061127e+14</td>\n      <td>0.067971</td>\n      <td>0.106804</td>\n      <td>0.011407</td>\n      <td>0.0</td>\n      <td>0.185153</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_vol7_5</td>\n      <td>2.837046e+14</td>\n      <td>0.062995</td>\n      <td>0.092310</td>\n      <td>0.008521</td>\n      <td>0.0</td>\n      <td>0.336134</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_vol7_6</td>\n      <td>1.287562e+14</td>\n      <td>0.028590</td>\n      <td>0.043272</td>\n      <td>0.001872</td>\n      <td>0.0</td>\n      <td>0.195448</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_vol7_7</td>\n      <td>1.842945e+14</td>\n      <td>0.040922</td>\n      <td>0.061281</td>\n      <td>0.003755</td>\n      <td>0.0</td>\n      <td>0.485559</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_vol7_8</td>\n      <td>2.483087e+14</td>\n      <td>0.055136</td>\n      <td>0.084717</td>\n      <td>0.007177</td>\n      <td>0.0</td>\n      <td>0.217519</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_vol7_9</td>\n      <td>5.017698e+14</td>\n      <td>0.111415</td>\n      <td>0.169115</td>\n      <td>0.028600</td>\n      <td>0.0</td>\n      <td>0.216930</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_vol7_10</td>\n      <td>8.429797e+14</td>\n      <td>0.187179</td>\n      <td>0.275426</td>\n      <td>0.075859</td>\n      <td>0.0</td>\n      <td>0.200165</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_vol7_11</td>\n      <td>2.745355e+14</td>\n      <td>0.060959</td>\n      <td>0.093203</td>\n      <td>0.008687</td>\n      <td>0.0</td>\n      <td>0.163997</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n#### Volatilidad con ventana σ = 14\n\n##### τ = 7\n\n::: {#5d562a16 .cell execution_count=54}\n``` {.python .cell-code}\ndim = vo_14[0][0].shape[1]\n\nresults = get_grid(vo_14[0], dim, 'volatilidad', 7, 14)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: tanh\nMejor número de epocas: 100\nMejor Longitud de paso μ (Learning Rate): 0.001\nMejor Puntuación: 0.9347361334808304\n```\n:::\n:::\n\n\n::: {#94834b0a .cell execution_count=55}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'volatilidad', dim, neurons, dropouts, best_activation, best_mu, 7, 14)\n\nmlp_vol14_7_metrics = best_model('vol14', models, vo_14[0][2], vo_14[0][3])\nmlp_vol14_7_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'volatilidad'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 0: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 1: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 2: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 3: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 4: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 5: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 6: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 7: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\nModelo 8: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 9: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 10: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 11: MSE = 0.0000\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=55}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_vol14_0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_vol14_1</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_vol14_2</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_vol14_3</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_vol14_4</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_vol14_5</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_vol14_6</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_vol14_7</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_vol14_8</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_vol14_9</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_vol14_10</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_vol14_11</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n##### τ = 14\n\n::: {#91fcd2be .cell execution_count=56}\n``` {.python .cell-code}\ndim = vo_14[1][0].shape[1]\n\nresults = get_grid(vo_14[1], dim, 'volatilidad', 14, 14)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: tanh\nMejor número de epocas: 150\nMejor Longitud de paso μ (Learning Rate): 0.001\nMejor Puntuación: 0.9331265147277118\n```\n:::\n:::\n\n\n::: {#be04dc5c .cell execution_count=57}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'volatilidad', dim, neurons, dropouts, best_activation, best_mu, 14, 14)\n\nmlp_vol14_14_metrics = best_model('vol14', models, vo_14[1][2], vo_14[1][3])\nmlp_vol14_14_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'volatilidad'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 0: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 1: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 2: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 3: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 4: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 5: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 6: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 7: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 8: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 9: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 10: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 11: MSE = 0.0000\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=57}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_vol14_0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_vol14_1</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_vol14_2</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_vol14_3</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_vol14_4</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_vol14_5</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_vol14_6</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_vol14_7</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_vol14_8</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_vol14_9</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_vol14_10</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_vol14_11</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n##### τ = 21\n\n::: {#63eca258 .cell execution_count=58}\n``` {.python .cell-code}\ndim = vo_14[2][0].shape[1]\n\nresults = get_grid(vo_14[2], dim, 'volatilidad', 21, 14)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: relu\nMejor número de epocas: 150\nMejor Longitud de paso μ (Learning Rate): 0.001\nMejor Puntuación: 0.9518923980994929\n```\n:::\n:::\n\n\n::: {#8ab07bed .cell execution_count=59}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'volatilidad', dim, neurons, dropouts, best_activation, best_mu, 21, 14)\n\nmlp_vol14_21_metrics = best_model('vol14', models, vo_14[2][2], vo_14[2][3])\nmlp_vol14_21_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'volatilidad'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 0: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 1: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 2: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 3: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 4: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 5: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 6: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 7: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 8: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 9: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 10: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 11: MSE = 0.0000\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=59}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_vol14_0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_vol14_1</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_vol14_2</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_vol14_3</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_vol14_4</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_vol14_5</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_vol14_6</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_vol14_7</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_vol14_8</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_vol14_9</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_vol14_10</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_vol14_11</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n##### τ = 28\n\n::: {#518117ef .cell execution_count=60}\n``` {.python .cell-code}\ndim = vo_14[3][0].shape[1]\n\nresults = get_grid(vo_14[3], dim, 'volatilidad', 28, 14)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: relu\nMejor número de epocas: 150\nMejor Longitud de paso μ (Learning Rate): 0.01\nMejor Puntuación: 0.9487999966795\n```\n:::\n:::\n\n\n::: {#203a9501 .cell execution_count=61}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'volatilidad', dim, neurons, dropouts, best_activation, best_mu, 28, 14)\n\nmlp_vol14_28_metrics = best_model('vol14', models, vo_14[3][2], vo_14[3][3])\nmlp_vol14_28_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'volatilidad'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 0: MSE = 0.0065\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 1: MSE = 0.0091\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 2: MSE = 0.0032\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 3: MSE = 0.0061\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 4: MSE = 0.1288\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 5: MSE = 0.0072\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 6: MSE = 0.0026\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 7: MSE = 0.0012\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 8: MSE = 0.0037\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 9: MSE = 0.0092\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 10: MSE = 0.0022\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 11: MSE = 0.0032\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=61}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_vol14_0</td>\n      <td>2.896786e+14</td>\n      <td>0.064322</td>\n      <td>0.080682</td>\n      <td>0.006510</td>\n      <td>0.0</td>\n      <td>0.610347</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_vol14_1</td>\n      <td>3.629986e+14</td>\n      <td>0.080602</td>\n      <td>0.095384</td>\n      <td>0.009098</td>\n      <td>0.0</td>\n      <td>0.378620</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_vol14_2</td>\n      <td>2.233342e+14</td>\n      <td>0.049590</td>\n      <td>0.056374</td>\n      <td>0.003178</td>\n      <td>0.0</td>\n      <td>0.370159</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_vol14_3</td>\n      <td>2.897920e+14</td>\n      <td>0.064347</td>\n      <td>0.077794</td>\n      <td>0.006052</td>\n      <td>0.0</td>\n      <td>0.579961</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_vol14_4</td>\n      <td>1.360298e+15</td>\n      <td>0.302047</td>\n      <td>0.358896</td>\n      <td>0.128806</td>\n      <td>0.0</td>\n      <td>0.200652</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_vol14_5</td>\n      <td>2.998405e+14</td>\n      <td>0.066578</td>\n      <td>0.085084</td>\n      <td>0.007239</td>\n      <td>0.0</td>\n      <td>0.563968</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_vol14_6</td>\n      <td>1.894117e+14</td>\n      <td>0.042058</td>\n      <td>0.051380</td>\n      <td>0.002640</td>\n      <td>0.0</td>\n      <td>0.701491</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_vol14_7</td>\n      <td>1.301509e+14</td>\n      <td>0.028899</td>\n      <td>0.035027</td>\n      <td>0.001227</td>\n      <td>0.0</td>\n      <td>0.621220</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_vol14_8</td>\n      <td>2.004332e+14</td>\n      <td>0.044505</td>\n      <td>0.060973</td>\n      <td>0.003718</td>\n      <td>0.0</td>\n      <td>0.255349</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_vol14_9</td>\n      <td>3.788565e+14</td>\n      <td>0.084123</td>\n      <td>0.096175</td>\n      <td>0.009250</td>\n      <td>0.0</td>\n      <td>0.387125</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_vol14_10</td>\n      <td>1.767774e+14</td>\n      <td>0.039252</td>\n      <td>0.047189</td>\n      <td>0.002227</td>\n      <td>0.0</td>\n      <td>0.617283</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_vol14_11</td>\n      <td>2.147773e+14</td>\n      <td>0.047690</td>\n      <td>0.056558</td>\n      <td>0.003199</td>\n      <td>0.0</td>\n      <td>0.483371</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n#### Volatilidad con ventana σ = 21\n\n##### τ = 7\n\n::: {#6ff8c533 .cell execution_count=62}\n``` {.python .cell-code}\ndim = vo_21[0][0].shape[1]\n\nresults = get_grid(vo_21[0], dim, 'volatilidad', 7, 21)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: tanh\nMejor número de epocas: 100\nMejor Longitud de paso μ (Learning Rate): 0.001\nMejor Puntuación: 0.958933652212678\n```\n:::\n:::\n\n\n::: {#c2b55212 .cell execution_count=63}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'volatilidad', dim, neurons, dropouts, best_activation, best_mu, 7, 21)\n\nmlp_vol21_7_metrics = best_model('vol21', models, vo_21[0][2], vo_21[0][3])\nmlp_vol21_7_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'volatilidad'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 0: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 1: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 2: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 3: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 4: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 5: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 6: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 7: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 8: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 9: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\nModelo 10: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 11: MSE = 0.0000\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=63}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_vol21_0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_vol21_1</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_vol21_2</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_vol21_3</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_vol21_4</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_vol21_5</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_vol21_6</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_vol21_7</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_vol21_8</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_vol21_9</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_vol21_10</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_vol21_11</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n##### τ = 14\n\n::: {#70fe5d3c .cell execution_count=64}\n``` {.python .cell-code}\ndim = vo_21[1][0].shape[1]\n\nresults = get_grid(vo_21[1], dim, 'volatilidad', 14, 21)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: relu\nMejor número de epocas: 100\nMejor Longitud de paso μ (Learning Rate): 0.01\nMejor Puntuación: 0.9590606369714157\n```\n:::\n:::\n\n\n::: {#c649a01d .cell execution_count=65}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'volatilidad', dim, neurons, dropouts, best_activation, best_mu, 14, 21)\n\nmlp_vol21_14_metrics = best_model('vol21', models, vo_21[1][2], vo_21[1][3])\nmlp_vol21_14_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'volatilidad'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 0: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 1: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 2: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 3: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 4: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 5: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 6: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 7: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 8: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 9: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 10: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 11: MSE = 0.0000\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=65}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_vol21_0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_vol21_1</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_vol21_2</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_vol21_3</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_vol21_4</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_vol21_5</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_vol21_6</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_vol21_7</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_vol21_8</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_vol21_9</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_vol21_10</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_vol21_11</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n##### τ = 21\n\n::: {#e44f5583 .cell execution_count=66}\n``` {.python .cell-code}\ndim = vo_21[2][0].shape[1]\n\nresults = get_grid(vo_21[2], dim, 'volatilidad', 21, 21)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: tanh\nMejor número de epocas: 50\nMejor Longitud de paso μ (Learning Rate): 0.001\nMejor Puntuación: 0.9588696357579239\n```\n:::\n:::\n\n\n::: {#0c75a964 .cell execution_count=67}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'volatilidad', dim, neurons, dropouts, best_activation, best_mu, 21, 21)\n\nmlp_vol21_21_metrics = best_model('vol21', models, vo_21[2][2], vo_21[2][3])\nmlp_vol21_21_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'volatilidad'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step\nModelo 0: MSE = 0.4251\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 1: MSE = 0.1071\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 2: MSE = 1.7569\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 3: MSE = 0.2702\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 4: MSE = 0.0051\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 5: MSE = 0.0045\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 6: MSE = 0.9637\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 7: MSE = 0.4901\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 8: MSE = 1.6636\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 9: MSE = 0.5232\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 10: MSE = 0.0606\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 11: MSE = 0.1050\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=67}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_vol21_0</td>\n      <td>2.936339e+15</td>\n      <td>0.651998</td>\n      <td>0.651998</td>\n      <td>0.425102</td>\n      <td>0.0</td>\n      <td>2.045677e-05</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_vol21_1</td>\n      <td>1.473618e+15</td>\n      <td>0.327209</td>\n      <td>0.327209</td>\n      <td>0.107066</td>\n      <td>0.0</td>\n      <td>3.758186e-03</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_vol21_2</td>\n      <td>5.969479e+15</td>\n      <td>1.325491</td>\n      <td>1.325491</td>\n      <td>1.756925</td>\n      <td>0.0</td>\n      <td>4.163555e-04</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_vol21_3</td>\n      <td>2.340928e+15</td>\n      <td>0.519790</td>\n      <td>0.519790</td>\n      <td>0.270182</td>\n      <td>0.0</td>\n      <td>2.181144e-02</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_vol21_4</td>\n      <td>3.220082e+14</td>\n      <td>0.071500</td>\n      <td>0.071500</td>\n      <td>0.005112</td>\n      <td>0.0</td>\n      <td>3.754697e-02</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_vol21_5</td>\n      <td>3.028158e+14</td>\n      <td>0.067239</td>\n      <td>0.067239</td>\n      <td>0.004521</td>\n      <td>0.0</td>\n      <td>1.270918e-29</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_vol21_6</td>\n      <td>4.421050e+15</td>\n      <td>0.981670</td>\n      <td>0.981670</td>\n      <td>0.963676</td>\n      <td>0.0</td>\n      <td>7.620207e-10</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_vol21_7</td>\n      <td>3.152691e+15</td>\n      <td>0.700038</td>\n      <td>0.700038</td>\n      <td>0.490053</td>\n      <td>0.0</td>\n      <td>3.278896e-05</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_vol21_8</td>\n      <td>5.808749e+15</td>\n      <td>1.289801</td>\n      <td>1.289801</td>\n      <td>1.663587</td>\n      <td>0.0</td>\n      <td>3.886970e-07</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_vol21_9</td>\n      <td>3.257432e+15</td>\n      <td>0.723295</td>\n      <td>0.723295</td>\n      <td>0.523156</td>\n      <td>0.0</td>\n      <td>3.281390e-03</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_vol21_10</td>\n      <td>1.108672e+15</td>\n      <td>0.246175</td>\n      <td>0.246175</td>\n      <td>0.060602</td>\n      <td>0.0</td>\n      <td>5.361850e-26</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_vol21_11</td>\n      <td>1.459581e+15</td>\n      <td>0.324092</td>\n      <td>0.324092</td>\n      <td>0.105036</td>\n      <td>0.0</td>\n      <td>6.528045e-05</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n##### τ = 28\n\n::: {#823e0b88 .cell execution_count=68}\n``` {.python .cell-code}\ndim = vo_21[3][0].shape[1]\n\nresults = get_grid(vo_21[3], dim, 'volatilidad', 28, 21)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: relu\nMejor número de epocas: 100\nMejor Longitud de paso μ (Learning Rate): 0.001\nMejor Puntuación: 0.9707786364616338\n```\n:::\n:::\n\n\n::: {#fdce4838 .cell execution_count=69}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'volatilidad', dim, neurons, dropouts, best_activation, best_mu, 28, 21)\n\nmlp_vol21_28_metrics = best_model('vol21', models, vo_21[3][2], vo_21[3][3])\nmlp_vol21_28_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'volatilidad'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 0: MSE = 0.0085\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 1: MSE = 0.0024\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 2: MSE = 0.0030\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 3: MSE = 0.0033\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 4: MSE = 0.0019\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 5: MSE = 0.0122\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 6: MSE = 0.0051\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 7: MSE = 0.0075\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 8: MSE = 0.0070\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 9: MSE = 0.0094\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 10: MSE = 0.0020\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 11: MSE = 0.0014\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=69}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_vol21_0</td>\n      <td>1.564857e+14</td>\n      <td>0.069459</td>\n      <td>0.092173</td>\n      <td>0.008496</td>\n      <td>-3.865243</td>\n      <td>0.008532</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_vol21_1</td>\n      <td>1.839391e+14</td>\n      <td>0.043247</td>\n      <td>0.048635</td>\n      <td>0.002365</td>\n      <td>-0.354568</td>\n      <td>0.378879</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_vol21_2</td>\n      <td>5.063465e+13</td>\n      <td>0.033515</td>\n      <td>0.054505</td>\n      <td>0.002971</td>\n      <td>-0.701261</td>\n      <td>0.002028</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_vol21_3</td>\n      <td>8.273847e+13</td>\n      <td>0.040933</td>\n      <td>0.057785</td>\n      <td>0.003339</td>\n      <td>-0.912148</td>\n      <td>0.004419</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_vol21_4</td>\n      <td>2.666782e+13</td>\n      <td>0.023944</td>\n      <td>0.043379</td>\n      <td>0.001882</td>\n      <td>-0.077605</td>\n      <td>0.002372</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_vol21_5</td>\n      <td>1.488474e+14</td>\n      <td>0.074913</td>\n      <td>0.110356</td>\n      <td>0.012178</td>\n      <td>-5.974118</td>\n      <td>0.111068</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_vol21_6</td>\n      <td>9.634084e+13</td>\n      <td>0.049596</td>\n      <td>0.071310</td>\n      <td>0.005085</td>\n      <td>-1.912015</td>\n      <td>0.002437</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_vol21_7</td>\n      <td>3.345719e+14</td>\n      <td>0.077327</td>\n      <td>0.086720</td>\n      <td>0.007520</td>\n      <td>-3.306620</td>\n      <td>0.603024</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_vol21_8</td>\n      <td>1.294174e+14</td>\n      <td>0.061066</td>\n      <td>0.083875</td>\n      <td>0.007035</td>\n      <td>-3.028680</td>\n      <td>0.005031</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_vol21_9</td>\n      <td>1.295304e+14</td>\n      <td>0.065887</td>\n      <td>0.097198</td>\n      <td>0.009448</td>\n      <td>-4.410232</td>\n      <td>0.046383</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_vol21_10</td>\n      <td>1.456937e+14</td>\n      <td>0.038858</td>\n      <td>0.044239</td>\n      <td>0.001957</td>\n      <td>-0.120765</td>\n      <td>0.297847</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_vol21_11</td>\n      <td>1.097412e+14</td>\n      <td>0.033493</td>\n      <td>0.036828</td>\n      <td>0.001356</td>\n      <td>0.223314</td>\n      <td>0.044301</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n#### Volatilidad con ventana σ = 28\n\n##### τ = 7\n\n::: {#14830dc4 .cell execution_count=70}\n``` {.python .cell-code}\ndim = vo_28[0][0].shape[1]\n\nresults = get_grid(vo_28[0], dim, 'volatilidad', 7, 28)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: tanh\nMejor número de epocas: 100\nMejor Longitud de paso μ (Learning Rate): 0.001\nMejor Puntuación: 0.8510466752155451\n```\n:::\n:::\n\n\n::: {#39046139 .cell execution_count=71}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'volatilidad', dim, neurons, dropouts, best_activation, best_mu, 7, 28)\n\nmlp_vol28_7_metrics = best_model('vol28', models, vo_28[0][2], vo_28[0][3])\nmlp_vol28_7_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'volatilidad'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 0: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 1: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 2: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 3: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 4: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 5: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 6: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 7: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 8: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 9: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 10: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 11: MSE = 0.0000\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=71}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_vol28_0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_vol28_1</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_vol28_2</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_vol28_3</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_vol28_4</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_vol28_5</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_vol28_6</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_vol28_7</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_vol28_8</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_vol28_9</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_vol28_10</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_vol28_11</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n##### τ = 14\n\n::: {#fbdde2e6 .cell execution_count=72}\n``` {.python .cell-code}\ndim = vo_28[1][0].shape[1]\n\nresults = get_grid(vo_28[1], dim, 'volatilidad', 14, 28)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: relu\nMejor número de epocas: 100\nMejor Longitud de paso μ (Learning Rate): 0.01\nMejor Puntuación: 0.8812891588138462\n```\n:::\n:::\n\n\n::: {#e517cbb9 .cell execution_count=73}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'volatilidad', dim, neurons, dropouts, best_activation, best_mu, 14, 28)\n\nmlp_vol28_14_metrics = best_model('vol28', models, vo_28[1][2], vo_28[1][3])\nmlp_vol28_14_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'volatilidad'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 0: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 1: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 2: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 3: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 4: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 5: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 6: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 7: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 8: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 9: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 10: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 11: MSE = 0.0000\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=73}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_vol28_0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_vol28_1</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_vol28_2</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_vol28_3</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_vol28_4</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_vol28_5</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_vol28_6</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_vol28_7</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_vol28_8</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_vol28_9</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_vol28_10</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_vol28_11</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n##### τ = 21\n\n::: {#0ac5d037 .cell execution_count=74}\n``` {.python .cell-code}\ndim = vo_28[2][0].shape[1]\n\nresults = get_grid(vo_28[2], dim, 'volatilidad', 21, 28)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: relu\nMejor número de epocas: 100\nMejor Longitud de paso μ (Learning Rate): 0.001\nMejor Puntuación: 0.8813218143824045\n```\n:::\n:::\n\n\n::: {#ec6b0146 .cell execution_count=75}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'volatilidad', dim, neurons, dropouts, best_activation, best_mu, 21, 28)\n\nmlp_vol28_21_metrics = best_model('vol28', models, vo_28[2][2], vo_28[2][3])\nmlp_vol28_21_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'volatilidad'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 0: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 1: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 2: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 3: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 4: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 5: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 6: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 7: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 8: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 9: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 10: MSE = 0.0000\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step\nModelo 11: MSE = 0.0000\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=75}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_vol28_0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_vol28_1</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_vol28_2</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_vol28_3</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_vol28_4</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_vol28_5</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_vol28_6</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_vol28_7</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_vol28_8</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_vol28_9</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_vol28_10</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_vol28_11</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n##### τ = 28\n\n::: {#770fc0ba .cell execution_count=76}\n``` {.python .cell-code}\ndim = vo_28[3][0].shape[1]\n\nresults = get_grid(vo_28[3], dim, 'volatilidad', 28, 28)\n\nbest_params = results.best_params_\nbest_activation = results.best_params_['model__activation']\nbest_epochs = results.best_params_['epochs']\nbest_mu = results.best_params_['model__learning_rate']\nbest_score = results.best_score_\n\nprint(f\"Mejor función de activación: {best_activation}\")\nprint(f\"Mejor número de epocas: {best_epochs}\")\nprint(f\"Mejor Longitud de paso μ (Learning Rate): {best_mu}\")\nprint(f\"Mejor Puntuación: {best_score}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCargando resultados guardados...\nMejor función de activación: relu\nMejor número de epocas: 100\nMejor Longitud de paso μ (Learning Rate): 0.01\nMejor Puntuación: 0.8743495907125691\n```\n:::\n:::\n\n\n::: {#bf51a124 .cell execution_count=77}\n``` {.python .cell-code}\nmodels = build_model('MLP', 'volatilidad', dim, neurons, dropouts, best_activation, best_mu, 28, 28)\n\nmlp_vol28_28_metrics = best_model('vol28', models, vo_28[3][2], vo_28[3][3])\nmlp_vol28_28_metrics\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:\n\nSkipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. \n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModelos cargados desde la carpeta 'volatilidad'.\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 0: MSE = 0.0021\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 1: MSE = 0.0005\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 2: MSE = 0.0006\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 3: MSE = 0.0012\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\nModelo 4: MSE = 0.0017\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 5: MSE = 0.0017\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 6: MSE = 0.0007\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 7: MSE = 0.0004\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 8: MSE = 0.0003\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 9: MSE = 0.0057\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 10: MSE = 0.0027\n\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step\nModelo 11: MSE = 0.0017\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=77}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Model Name</th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MLP_vol28_0</td>\n      <td>1.473632e+14</td>\n      <td>0.032721</td>\n      <td>0.045414</td>\n      <td>0.002062</td>\n      <td>0.0</td>\n      <td>0.284712</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MLP_vol28_1</td>\n      <td>6.236684e+13</td>\n      <td>0.013848</td>\n      <td>0.021517</td>\n      <td>0.000463</td>\n      <td>0.0</td>\n      <td>0.103652</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MLP_vol28_2</td>\n      <td>7.109195e+13</td>\n      <td>0.015786</td>\n      <td>0.023828</td>\n      <td>0.000568</td>\n      <td>0.0</td>\n      <td>0.233961</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>MLP_vol28_3</td>\n      <td>1.109140e+14</td>\n      <td>0.024628</td>\n      <td>0.035262</td>\n      <td>0.001243</td>\n      <td>0.0</td>\n      <td>0.214152</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>MLP_vol28_4</td>\n      <td>1.314559e+14</td>\n      <td>0.029189</td>\n      <td>0.040948</td>\n      <td>0.001677</td>\n      <td>0.0</td>\n      <td>0.248508</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>MLP_vol28_5</td>\n      <td>1.293315e+14</td>\n      <td>0.028717</td>\n      <td>0.041125</td>\n      <td>0.001691</td>\n      <td>0.0</td>\n      <td>0.180185</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MLP_vol28_6</td>\n      <td>6.711894e+13</td>\n      <td>0.014903</td>\n      <td>0.026100</td>\n      <td>0.000681</td>\n      <td>0.0</td>\n      <td>0.008449</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MLP_vol28_7</td>\n      <td>6.612054e+13</td>\n      <td>0.014682</td>\n      <td>0.020149</td>\n      <td>0.000406</td>\n      <td>0.0</td>\n      <td>0.416803</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>MLP_vol28_8</td>\n      <td>4.960191e+13</td>\n      <td>0.011014</td>\n      <td>0.017467</td>\n      <td>0.000305</td>\n      <td>0.0</td>\n      <td>0.047961</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>MLP_vol28_9</td>\n      <td>2.180156e+14</td>\n      <td>0.048409</td>\n      <td>0.075491</td>\n      <td>0.005699</td>\n      <td>0.0</td>\n      <td>0.111378</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>MLP_vol28_10</td>\n      <td>1.742931e+14</td>\n      <td>0.038701</td>\n      <td>0.052252</td>\n      <td>0.002730</td>\n      <td>0.0</td>\n      <td>0.267459</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>MLP_vol28_11</td>\n      <td>1.311039e+14</td>\n      <td>0.029111</td>\n      <td>0.041407</td>\n      <td>0.001715</td>\n      <td>0.0</td>\n      <td>0.247492</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Selección del mejor modelo MLP\n\n::: {#72f048b8 .cell execution_count=78}\n``` {.python .cell-code}\nmetric_vars = [\n    'mlp_p7_metrics', 'mlp_p14_metrics', 'mlp_p21_metrics', 'mlp_p28_metrics',\n    'mlp_at7_metrics', 'mlp_at14_metrics', 'mlp_at21_metrics', 'mlp_at28_metrics',\n    'mlp_vol7_7_metrics', 'mlp_vol7_14_metrics', 'mlp_vol7_21_metrics', 'mlp_vol7_28_metrics',\n    'mlp_vol14_7_metrics', 'mlp_vol14_14_metrics', 'mlp_vol14_21_metrics', 'mlp_vol14_28_metrics',\n    'mlp_vol21_7_metrics', 'mlp_vol21_14_metrics', 'mlp_vol21_21_metrics', 'mlp_vol21_28_metrics',\n    'mlp_vol28_7_metrics', 'mlp_vol28_14_metrics', 'mlp_vol28_21_metrics', 'mlp_vol28_28_metrics'\n]\n\ndef get_best_metrics(metrics, s_by = 'MSE'):\n    return metrics.sort_values(by = s_by).iloc[0]\n\nsummary = pd.DataFrame()\n\nfor var in metric_vars:\n    metric = globals()[var]\n\n    best_metric = get_best_metrics(metric)\n    best_metric['Model'] = var\n\n    summary = pd.concat([summary, best_metric.to_frame().T], ignore_index = True)\n\nsummary = summary.drop(columns = ['Model Name'])\nsummary\n```\n\n::: {.cell-output .cell-output-display execution_count=78}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n      <th>Model</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.390892</td>\n      <td>0.039089</td>\n      <td>0.039089</td>\n      <td>0.001528</td>\n      <td>-7933669470522589694504040660992.0</td>\n      <td>NaN</td>\n      <td>mlp_p7_metrics</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0.65484</td>\n      <td>0.065484</td>\n      <td>0.065484</td>\n      <td>0.004288</td>\n      <td>-22265337444463706845134140211200.0</td>\n      <td>NaN</td>\n      <td>mlp_p14_metrics</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0.324668</td>\n      <td>0.032467</td>\n      <td>0.032467</td>\n      <td>0.001054</td>\n      <td>-5473179021279250724616449032192.0</td>\n      <td>0.011652</td>\n      <td>mlp_p21_metrics</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>0.171046</td>\n      <td>0.017105</td>\n      <td>0.018523</td>\n      <td>0.000343</td>\n      <td>-1781497716922890013417599401984.0</td>\n      <td>0.004948</td>\n      <td>mlp_p28_metrics</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0.538684</td>\n      <td>2.32872</td>\n      <td>2.32872</td>\n      <td>5.422937</td>\n      <td>0.0</td>\n      <td>NaN</td>\n      <td>mlp_at7_metrics</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>0.508532</td>\n      <td>2.198373</td>\n      <td>2.198373</td>\n      <td>4.832846</td>\n      <td>-6126360016078316546386823217152.0</td>\n      <td>NaN</td>\n      <td>mlp_at14_metrics</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>0.687578</td>\n      <td>2.972386</td>\n      <td>2.972386</td>\n      <td>8.835076</td>\n      <td>-11199789270786860826263298244608.0</td>\n      <td>NaN</td>\n      <td>mlp_at21_metrics</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>0.693565</td>\n      <td>2.998265</td>\n      <td>2.998265</td>\n      <td>8.989592</td>\n      <td>-11395661428177666513355814207488.0</td>\n      <td>0.0</td>\n      <td>mlp_at28_metrics</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>mlp_vol7_7_metrics</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>mlp_vol7_14_metrics</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>mlp_vol7_21_metrics</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>128756204624749.71875</td>\n      <td>0.02859</td>\n      <td>0.043272</td>\n      <td>0.001872</td>\n      <td>0.0</td>\n      <td>0.195448</td>\n      <td>mlp_vol7_28_metrics</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>mlp_vol14_7_metrics</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>mlp_vol14_14_metrics</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>mlp_vol14_21_metrics</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>130150873769106.28125</td>\n      <td>0.028899</td>\n      <td>0.035027</td>\n      <td>0.001227</td>\n      <td>0.0</td>\n      <td>0.62122</td>\n      <td>mlp_vol14_28_metrics</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>mlp_vol21_7_metrics</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>mlp_vol21_14_metrics</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>302815780810947.0625</td>\n      <td>0.067239</td>\n      <td>0.067239</td>\n      <td>0.004521</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>mlp_vol21_21_metrics</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>109741172775789.796875</td>\n      <td>0.033493</td>\n      <td>0.036828</td>\n      <td>0.001356</td>\n      <td>0.223314</td>\n      <td>0.044301</td>\n      <td>mlp_vol21_28_metrics</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>mlp_vol28_7_metrics</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>mlp_vol28_14_metrics</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>mlp_vol28_21_metrics</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>49601910482066.289062</td>\n      <td>0.011014</td>\n      <td>0.017467</td>\n      <td>0.000305</td>\n      <td>0.0</td>\n      <td>0.047961</td>\n      <td>mlp_vol28_28_metrics</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#f7d3d395 .cell execution_count=79}\n``` {.python .cell-code}\nbest = [\n    'mlp_p28_metrics', 'mp_at7_metrics', 'mlp_vol7_28_metrics', \n    'mlp_vol14_28_metrics', 'mlp_vol21_28_metrics', 'mlp_vol28_28_metrics'\n]\n\nsummary = summary[summary['Model'].isin(best)]\nsummary\n```\n\n::: {.cell-output .cell-output-display execution_count=79}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>MAPE</th>\n      <th>MAE</th>\n      <th>RMSE</th>\n      <th>MSE</th>\n      <th>R2</th>\n      <th>Jarque-Bera P-Value</th>\n      <th>Model</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>3</th>\n      <td>0.171046</td>\n      <td>0.017105</td>\n      <td>0.018523</td>\n      <td>0.000343</td>\n      <td>-1781497716922890013417599401984.0</td>\n      <td>0.004948</td>\n      <td>mlp_p28_metrics</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>128756204624749.71875</td>\n      <td>0.02859</td>\n      <td>0.043272</td>\n      <td>0.001872</td>\n      <td>0.0</td>\n      <td>0.195448</td>\n      <td>mlp_vol7_28_metrics</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>130150873769106.28125</td>\n      <td>0.028899</td>\n      <td>0.035027</td>\n      <td>0.001227</td>\n      <td>0.0</td>\n      <td>0.62122</td>\n      <td>mlp_vol14_28_metrics</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>109741172775789.796875</td>\n      <td>0.033493</td>\n      <td>0.036828</td>\n      <td>0.001356</td>\n      <td>0.223314</td>\n      <td>0.044301</td>\n      <td>mlp_vol21_28_metrics</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>49601910482066.289062</td>\n      <td>0.011014</td>\n      <td>0.017467</td>\n      <td>0.000305</td>\n      <td>0.0</td>\n      <td>0.047961</td>\n      <td>mlp_vol28_28_metrics</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n",
    "supporting": [
      "deep_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n<script type=\"text/javascript\">\nwindow.PlotlyConfig = {MathJaxConfig: 'local'};\nif (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}\nif (typeof require !== 'undefined') {\nrequire.undef(\"plotly\");\nrequirejs.config({\n    paths: {\n        'plotly': ['https://cdn.plot.ly/plotly-2.35.2.min']\n    }\n});\nrequire(['plotly'], function(Plotly) {\n    window._Plotly = Plotly;\n});\n}\n</script>\n\n"
      ]
    }
  }
}