<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jorge Borja">
<meta name="author" content="Gabriela Díaz Porto">

<title>Modelos estadísticos – Parcial Práctico Series de Tiempo</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./deep.html" rel="next">
<link href="./eda.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.35.2.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>

<link rel="apple-touch-icon" sizes="180x180" href="icon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="32x32" href="icon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="icon/favicon-16x16.png">
<link rel="mask-icon" href="icon/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./models.html">Modelos estadísticos</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Parcial Práctico Series de Tiempo</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introducción</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Análisis exploratorio de datos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Modelos estadísticos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./deep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modelos de deep learning</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">En esta página</h2>
   
  <ul>
  <li><a href="#importar-librerías" id="toc-importar-librerías" class="nav-link active" data-scroll-target="#importar-librerías">Importar librerías</a></li>
  <li><a href="#importar-datos" id="toc-importar-datos" class="nav-link" data-scroll-target="#importar-datos">Importar datos</a></li>
  <li><a href="#series-de-tiempo-y-separación-de-los-conjuntos-de-datos" id="toc-series-de-tiempo-y-separación-de-los-conjuntos-de-datos" class="nav-link" data-scroll-target="#series-de-tiempo-y-separación-de-los-conjuntos-de-datos">Series de tiempo y separación de los conjuntos de datos</a>
  <ul>
  <li><a href="#variable-price" id="toc-variable-price" class="nav-link" data-scroll-target="#variable-price">Variable Price</a></li>
  <li><a href="#variable-retorno-acumulado" id="toc-variable-retorno-acumulado" class="nav-link" data-scroll-target="#variable-retorno-acumulado">Variable retorno acumulado</a></li>
  <li><a href="#variable-volatilidad" id="toc-variable-volatilidad" class="nav-link" data-scroll-target="#variable-volatilidad">Variable volatilidad</a>
  <ul>
  <li><a href="#sigma-tal-que-omega-7" id="toc-sigma-tal-que-omega-7" class="nav-link" data-scroll-target="#sigma-tal-que-omega-7"><span class="math inline">\(\sigma\)</span> tal que <span class="math inline">\(\omega = 7\)</span></a></li>
  <li><a href="#sigma-tal-que-omega-14" id="toc-sigma-tal-que-omega-14" class="nav-link" data-scroll-target="#sigma-tal-que-omega-14"><span class="math inline">\(\sigma\)</span> tal que <span class="math inline">\(\omega = 14\)</span></a></li>
  <li><a href="#sigma-tal-que-omega-21" id="toc-sigma-tal-que-omega-21" class="nav-link" data-scroll-target="#sigma-tal-que-omega-21"><span class="math inline">\(\sigma\)</span> tal que <span class="math inline">\(\omega = 21\)</span></a></li>
  <li><a href="#sigma-tal-que-omega-28" id="toc-sigma-tal-que-omega-28" class="nav-link" data-scroll-target="#sigma-tal-que-omega-28"><span class="math inline">\(\sigma\)</span> tal que <span class="math inline">\(\omega = 28\)</span></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#aplicación-de-los-modelos-estadísticos" id="toc-aplicación-de-los-modelos-estadísticos" class="nav-link" data-scroll-target="#aplicación-de-los-modelos-estadísticos">Aplicación de los modelos estadísticos</a>
  <ul>
  <li><a href="#exponential-smoothing" id="toc-exponential-smoothing" class="nav-link" data-scroll-target="#exponential-smoothing">Exponential Smoothing</a>
  <ul>
  <li><a href="#caso-simple-sin-librería" id="toc-caso-simple-sin-librería" class="nav-link" data-scroll-target="#caso-simple-sin-librería">Caso simple sin librería</a>
  <ul class="collapse">
  <li><a href="#price" id="toc-price" class="nav-link" data-scroll-target="#price">Price</a>
  <ul class="collapse">
  <li><a href="#tau-7" id="toc-tau-7" class="nav-link" data-scroll-target="#tau-7"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14" id="toc-tau-14" class="nav-link" data-scroll-target="#tau-14"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21" id="toc-tau-21" class="nav-link" data-scroll-target="#tau-21"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28" id="toc-tau-28" class="nav-link" data-scroll-target="#tau-28"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  <li><a href="#retorno-acumulado" id="toc-retorno-acumulado" class="nav-link" data-scroll-target="#retorno-acumulado">Retorno acumulado</a>
  <ul class="collapse">
  <li><a href="#tau-7-1" id="toc-tau-7-1" class="nav-link" data-scroll-target="#tau-7-1"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-1" id="toc-tau-14-1" class="nav-link" data-scroll-target="#tau-14-1"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-1" id="toc-tau-21-1" class="nav-link" data-scroll-target="#tau-21-1"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-1" id="toc-tau-28-1" class="nav-link" data-scroll-target="#tau-28-1"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  <li><a href="#volatilidad-omega-7" id="toc-volatilidad-omega-7" class="nav-link" data-scroll-target="#volatilidad-omega-7">Volatilidad <span class="math inline">\(\omega = 7\)</span></a>
  <ul class="collapse">
  <li><a href="#tau-7-2" id="toc-tau-7-2" class="nav-link" data-scroll-target="#tau-7-2"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-2" id="toc-tau-14-2" class="nav-link" data-scroll-target="#tau-14-2"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-2" id="toc-tau-21-2" class="nav-link" data-scroll-target="#tau-21-2"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-2" id="toc-tau-28-2" class="nav-link" data-scroll-target="#tau-28-2"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  <li><a href="#volatilidad-omega-14" id="toc-volatilidad-omega-14" class="nav-link" data-scroll-target="#volatilidad-omega-14">Volatilidad <span class="math inline">\(\omega = 14\)</span></a>
  <ul class="collapse">
  <li><a href="#tau-7-3" id="toc-tau-7-3" class="nav-link" data-scroll-target="#tau-7-3"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-3" id="toc-tau-14-3" class="nav-link" data-scroll-target="#tau-14-3"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-3" id="toc-tau-21-3" class="nav-link" data-scroll-target="#tau-21-3"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-3" id="toc-tau-28-3" class="nav-link" data-scroll-target="#tau-28-3"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  <li><a href="#volatilidad-omega-21" id="toc-volatilidad-omega-21" class="nav-link" data-scroll-target="#volatilidad-omega-21">Volatilidad <span class="math inline">\(\omega = 21\)</span></a>
  <ul class="collapse">
  <li><a href="#tau-7-4" id="toc-tau-7-4" class="nav-link" data-scroll-target="#tau-7-4"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-4" id="toc-tau-14-4" class="nav-link" data-scroll-target="#tau-14-4"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-4" id="toc-tau-21-4" class="nav-link" data-scroll-target="#tau-21-4"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-4" id="toc-tau-28-4" class="nav-link" data-scroll-target="#tau-28-4"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  <li><a href="#volatilidad-omega-28" id="toc-volatilidad-omega-28" class="nav-link" data-scroll-target="#volatilidad-omega-28">Volatilidad <span class="math inline">\(\omega = 28\)</span></a>
  <ul class="collapse">
  <li><a href="#tau-7-5" id="toc-tau-7-5" class="nav-link" data-scroll-target="#tau-7-5"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-5" id="toc-tau-14-5" class="nav-link" data-scroll-target="#tau-14-5"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-5" id="toc-tau-21-5" class="nav-link" data-scroll-target="#tau-21-5"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-5" id="toc-tau-28-5" class="nav-link" data-scroll-target="#tau-28-5"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#caso-doble-sin-librería" id="toc-caso-doble-sin-librería" class="nav-link" data-scroll-target="#caso-doble-sin-librería">Caso doble sin librería</a>
  <ul class="collapse">
  <li><a href="#price-1" id="toc-price-1" class="nav-link" data-scroll-target="#price-1">Price</a>
  <ul class="collapse">
  <li><a href="#tau-7-6" id="toc-tau-7-6" class="nav-link" data-scroll-target="#tau-7-6"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-6" id="toc-tau-14-6" class="nav-link" data-scroll-target="#tau-14-6"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-6" id="toc-tau-21-6" class="nav-link" data-scroll-target="#tau-21-6"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-6" id="toc-tau-28-6" class="nav-link" data-scroll-target="#tau-28-6"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  <li><a href="#retorno-acumulado-1" id="toc-retorno-acumulado-1" class="nav-link" data-scroll-target="#retorno-acumulado-1">Retorno acumulado</a>
  <ul class="collapse">
  <li><a href="#tau-7-7" id="toc-tau-7-7" class="nav-link" data-scroll-target="#tau-7-7"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-7" id="toc-tau-14-7" class="nav-link" data-scroll-target="#tau-14-7"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-7" id="toc-tau-21-7" class="nav-link" data-scroll-target="#tau-21-7"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-7" id="toc-tau-28-7" class="nav-link" data-scroll-target="#tau-28-7"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  <li><a href="#volatilidad-omega-7-1" id="toc-volatilidad-omega-7-1" class="nav-link" data-scroll-target="#volatilidad-omega-7-1">Volatilidad <span class="math inline">\(\omega = 7\)</span></a>
  <ul class="collapse">
  <li><a href="#tau-7-8" id="toc-tau-7-8" class="nav-link" data-scroll-target="#tau-7-8"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-8" id="toc-tau-14-8" class="nav-link" data-scroll-target="#tau-14-8"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-8" id="toc-tau-21-8" class="nav-link" data-scroll-target="#tau-21-8"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-8" id="toc-tau-28-8" class="nav-link" data-scroll-target="#tau-28-8"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  <li><a href="#volatilidad-omega-14-1" id="toc-volatilidad-omega-14-1" class="nav-link" data-scroll-target="#volatilidad-omega-14-1">Volatilidad <span class="math inline">\(\omega = 14\)</span></a>
  <ul class="collapse">
  <li><a href="#tau-7-9" id="toc-tau-7-9" class="nav-link" data-scroll-target="#tau-7-9"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-9" id="toc-tau-14-9" class="nav-link" data-scroll-target="#tau-14-9"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-9" id="toc-tau-21-9" class="nav-link" data-scroll-target="#tau-21-9"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-9" id="toc-tau-28-9" class="nav-link" data-scroll-target="#tau-28-9"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  <li><a href="#volatilidad-omega-21-1" id="toc-volatilidad-omega-21-1" class="nav-link" data-scroll-target="#volatilidad-omega-21-1">Volatilidad <span class="math inline">\(\omega = 21\)</span></a>
  <ul class="collapse">
  <li><a href="#tau-7-10" id="toc-tau-7-10" class="nav-link" data-scroll-target="#tau-7-10"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-10" id="toc-tau-14-10" class="nav-link" data-scroll-target="#tau-14-10"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-10" id="toc-tau-21-10" class="nav-link" data-scroll-target="#tau-21-10"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-10" id="toc-tau-28-10" class="nav-link" data-scroll-target="#tau-28-10"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  <li><a href="#volatilidad-omega-28-1" id="toc-volatilidad-omega-28-1" class="nav-link" data-scroll-target="#volatilidad-omega-28-1">Volatilidad <span class="math inline">\(\omega = 28\)</span></a>
  <ul class="collapse">
  <li><a href="#tau-7-11" id="toc-tau-7-11" class="nav-link" data-scroll-target="#tau-7-11"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-11" id="toc-tau-14-11" class="nav-link" data-scroll-target="#tau-14-11"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-11" id="toc-tau-21-11" class="nav-link" data-scroll-target="#tau-21-11"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-11" id="toc-tau-28-11" class="nav-link" data-scroll-target="#tau-28-11"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#caso-simple-usando-statsmodels" id="toc-caso-simple-usando-statsmodels" class="nav-link" data-scroll-target="#caso-simple-usando-statsmodels">Caso simple usando <code>statsmodels</code></a>
  <ul class="collapse">
  <li><a href="#price-2" id="toc-price-2" class="nav-link" data-scroll-target="#price-2">Price</a>
  <ul class="collapse">
  <li><a href="#tau-7-12" id="toc-tau-7-12" class="nav-link" data-scroll-target="#tau-7-12"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-12" id="toc-tau-14-12" class="nav-link" data-scroll-target="#tau-14-12"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-12" id="toc-tau-21-12" class="nav-link" data-scroll-target="#tau-21-12"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-12" id="toc-tau-28-12" class="nav-link" data-scroll-target="#tau-28-12"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  <li><a href="#retorno-acumulado-2" id="toc-retorno-acumulado-2" class="nav-link" data-scroll-target="#retorno-acumulado-2">Retorno acumulado</a>
  <ul class="collapse">
  <li><a href="#tau-7-13" id="toc-tau-7-13" class="nav-link" data-scroll-target="#tau-7-13"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-13" id="toc-tau-14-13" class="nav-link" data-scroll-target="#tau-14-13"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-13" id="toc-tau-21-13" class="nav-link" data-scroll-target="#tau-21-13"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-13" id="toc-tau-28-13" class="nav-link" data-scroll-target="#tau-28-13"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  <li><a href="#volatilidad-omega-7-2" id="toc-volatilidad-omega-7-2" class="nav-link" data-scroll-target="#volatilidad-omega-7-2">Volatilidad <span class="math inline">\(\omega = 7\)</span></a>
  <ul class="collapse">
  <li><a href="#tau-7-14" id="toc-tau-7-14" class="nav-link" data-scroll-target="#tau-7-14"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-14" id="toc-tau-14-14" class="nav-link" data-scroll-target="#tau-14-14"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-14" id="toc-tau-21-14" class="nav-link" data-scroll-target="#tau-21-14"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-14" id="toc-tau-28-14" class="nav-link" data-scroll-target="#tau-28-14"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  <li><a href="#volatilidad-omega-14-2" id="toc-volatilidad-omega-14-2" class="nav-link" data-scroll-target="#volatilidad-omega-14-2">Volatilidad <span class="math inline">\(\omega = 14\)</span></a>
  <ul class="collapse">
  <li><a href="#tau-7-15" id="toc-tau-7-15" class="nav-link" data-scroll-target="#tau-7-15"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-15" id="toc-tau-14-15" class="nav-link" data-scroll-target="#tau-14-15"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-15" id="toc-tau-21-15" class="nav-link" data-scroll-target="#tau-21-15"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-15" id="toc-tau-28-15" class="nav-link" data-scroll-target="#tau-28-15"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  <li><a href="#volatilidad-omega-21-2" id="toc-volatilidad-omega-21-2" class="nav-link" data-scroll-target="#volatilidad-omega-21-2">Volatilidad <span class="math inline">\(\omega = 21\)</span></a>
  <ul class="collapse">
  <li><a href="#tau-7-16" id="toc-tau-7-16" class="nav-link" data-scroll-target="#tau-7-16"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-16" id="toc-tau-14-16" class="nav-link" data-scroll-target="#tau-14-16"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-16" id="toc-tau-21-16" class="nav-link" data-scroll-target="#tau-21-16"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-16" id="toc-tau-28-16" class="nav-link" data-scroll-target="#tau-28-16"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  <li><a href="#volatilidad-omega-28-2" id="toc-volatilidad-omega-28-2" class="nav-link" data-scroll-target="#volatilidad-omega-28-2">Volatilidad <span class="math inline">\(\omega = 28\)</span></a>
  <ul class="collapse">
  <li><a href="#tau-7-17" id="toc-tau-7-17" class="nav-link" data-scroll-target="#tau-7-17"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-17" id="toc-tau-14-17" class="nav-link" data-scroll-target="#tau-14-17"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-17" id="toc-tau-21-17" class="nav-link" data-scroll-target="#tau-21-17"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-17" id="toc-tau-28-17" class="nav-link" data-scroll-target="#tau-28-17"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#caso-doble-usando-statsmodels" id="toc-caso-doble-usando-statsmodels" class="nav-link" data-scroll-target="#caso-doble-usando-statsmodels">Caso doble usando <code>statsmodels</code></a>
  <ul class="collapse">
  <li><a href="#price-3" id="toc-price-3" class="nav-link" data-scroll-target="#price-3">Price</a>
  <ul class="collapse">
  <li><a href="#tau-7-18" id="toc-tau-7-18" class="nav-link" data-scroll-target="#tau-7-18"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-18" id="toc-tau-14-18" class="nav-link" data-scroll-target="#tau-14-18"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-18" id="toc-tau-21-18" class="nav-link" data-scroll-target="#tau-21-18"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-18" id="toc-tau-28-18" class="nav-link" data-scroll-target="#tau-28-18"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  <li><a href="#retorno-acumulado-3" id="toc-retorno-acumulado-3" class="nav-link" data-scroll-target="#retorno-acumulado-3">Retorno acumulado</a>
  <ul class="collapse">
  <li><a href="#tau-7-19" id="toc-tau-7-19" class="nav-link" data-scroll-target="#tau-7-19"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-19" id="toc-tau-14-19" class="nav-link" data-scroll-target="#tau-14-19"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-19" id="toc-tau-21-19" class="nav-link" data-scroll-target="#tau-21-19"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-19" id="toc-tau-28-19" class="nav-link" data-scroll-target="#tau-28-19"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  <li><a href="#volatilidad-omega-7-3" id="toc-volatilidad-omega-7-3" class="nav-link" data-scroll-target="#volatilidad-omega-7-3">Volatilidad <span class="math inline">\(\omega = 7\)</span></a>
  <ul class="collapse">
  <li><a href="#tau-7-20" id="toc-tau-7-20" class="nav-link" data-scroll-target="#tau-7-20"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-20" id="toc-tau-14-20" class="nav-link" data-scroll-target="#tau-14-20"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-20" id="toc-tau-21-20" class="nav-link" data-scroll-target="#tau-21-20"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-20" id="toc-tau-28-20" class="nav-link" data-scroll-target="#tau-28-20"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  <li><a href="#volatilidad-omega-14-3" id="toc-volatilidad-omega-14-3" class="nav-link" data-scroll-target="#volatilidad-omega-14-3">Volatilidad <span class="math inline">\(\omega = 14\)</span></a>
  <ul class="collapse">
  <li><a href="#tau-7-21" id="toc-tau-7-21" class="nav-link" data-scroll-target="#tau-7-21"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-21" id="toc-tau-14-21" class="nav-link" data-scroll-target="#tau-14-21"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-21" id="toc-tau-21-21" class="nav-link" data-scroll-target="#tau-21-21"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-21" id="toc-tau-28-21" class="nav-link" data-scroll-target="#tau-28-21"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  <li><a href="#volatilidad-omega-21-3" id="toc-volatilidad-omega-21-3" class="nav-link" data-scroll-target="#volatilidad-omega-21-3">Volatilidad <span class="math inline">\(\omega = 21\)</span></a>
  <ul class="collapse">
  <li><a href="#tau-7-22" id="toc-tau-7-22" class="nav-link" data-scroll-target="#tau-7-22"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-22" id="toc-tau-14-22" class="nav-link" data-scroll-target="#tau-14-22"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-22" id="toc-tau-21-22" class="nav-link" data-scroll-target="#tau-21-22"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-22" id="toc-tau-28-22" class="nav-link" data-scroll-target="#tau-28-22"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  <li><a href="#volatilidad-omega-28-3" id="toc-volatilidad-omega-28-3" class="nav-link" data-scroll-target="#volatilidad-omega-28-3">Volatilidad <span class="math inline">\(\omega = 28\)</span></a>
  <ul class="collapse">
  <li><a href="#tau-7-23" id="toc-tau-7-23" class="nav-link" data-scroll-target="#tau-7-23"><span class="math inline">\(\tau = 7\)</span></a></li>
  <li><a href="#tau-14-23" id="toc-tau-14-23" class="nav-link" data-scroll-target="#tau-14-23"><span class="math inline">\(\tau = 14\)</span></a></li>
  <li><a href="#tau-21-23" id="toc-tau-21-23" class="nav-link" data-scroll-target="#tau-21-23"><span class="math inline">\(\tau = 21\)</span></a></li>
  <li><a href="#tau-28-23" id="toc-tau-28-23" class="nav-link" data-scroll-target="#tau-28-23"><span class="math inline">\(\tau = 28\)</span></a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Modelos estadísticos</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Autores/as</div>
  <div class="quarto-title-meta-heading">Afiliación</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://www.linkedin.com/in/jorgeborjas25/">Jorge Borja, Mag</a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://uninorte.edu.co/">
            Universidad del Norte
            </a>
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://www.linkedin.com/in/gabriela-diaz-porto-6a0729201">Gabriela Díaz Porto, Mag</a> </p>
  </div>
  <div class="quarto-title-meta-contents">
      </div>
  </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  


</header>


<p>En este capítulo construiremos distintos modelos estadísticos estudiantes durante el módulo de series de tiempo para la predicción de distintas variables obtenidas a partir del conjunto de datos de las acciones del Bitcoin. Los modelos estadísticos que se construirán en este reporte serán:</p>
<ol type="1">
<li>Simple Exponential Smoothing</li>
<li>Double Exponential Smoothing</li>
<li>ARIMA</li>
<li>GARCH</li>
</ol>
<p>Tal que para los modelos de suavización exponencial se construirán a mano y usando la librería de <code>statsmodels.tsa.holterwinters</code> para comparar resultados. Y, para los modelos <em>ARIMA</em> y <em>GARCH</em> construiremos utilizando la técnica de <code>rolling</code> al igual que sin aplicarla.</p>
<section id="importar-librerías" class="level1">
<h1>Importar librerías</h1>
<div id="f8980100" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotly.subplots <span class="im">import</span> make_subplots</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_absolute_percentage_error, mean_absolute_error, mean_squared_error, r2_score</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> jarque_bera</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.diagnostic <span class="im">import</span> acorr_ljungbox</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.holtwinters <span class="im">import</span> ExponentialSmoothing <span class="im">as</span> ExponentialSmoothingLib</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Optional</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>, category<span class="op">=</span><span class="pp">RuntimeWarning</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>, message<span class="op">=</span><span class="st">"No frequency information was provided"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importar-datos" class="level1">
<h1>Importar datos</h1>
<p>En este caso, se carga un archivo con los datos preparados (btc_models.csv), que contiene las características necesarias para entrenar los modelos neuronales y evaluar su rendimiento. El dataset incluye variables transformadas y seleccionadas para capturar tanto la estructura temporal como la información relevante de la serie de precios de Bitcoin.</p>
<div id="bf002443" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'data/btc_models.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>btc <span class="op">=</span> df.sort_values(by<span class="op">=</span><span class="st">'Date'</span>).copy()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>btc <span class="op">=</span> btc.reset_index(drop <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>btc <span class="op">=</span> btc.fillna(<span class="dv">0</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>btc</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Price</th>
<th data-quarto-table-cell-role="th">Open</th>
<th data-quarto-table-cell-role="th">High</th>
<th data-quarto-table-cell-role="th">Low</th>
<th data-quarto-table-cell-role="th">Vol.</th>
<th data-quarto-table-cell-role="th">Change %</th>
<th data-quarto-table-cell-role="th">R_j</th>
<th data-quarto-table-cell-role="th">A_t</th>
<th data-quarto-table-cell-role="th">σ_7</th>
<th data-quarto-table-cell-role="th">σ_14</th>
<th data-quarto-table-cell-role="th">σ_21</th>
<th data-quarto-table-cell-role="th">σ_28</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2010-07-18</td>
<td>0.1</td>
<td>0.0</td>
<td>0.1</td>
<td>0.1</td>
<td>80.0</td>
<td>0.00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2010-07-19</td>
<td>0.1</td>
<td>0.1</td>
<td>0.1</td>
<td>0.1</td>
<td>570.0</td>
<td>0.00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2010-07-20</td>
<td>0.1</td>
<td>0.1</td>
<td>0.1</td>
<td>0.1</td>
<td>260.0</td>
<td>0.00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2010-07-21</td>
<td>0.1</td>
<td>0.1</td>
<td>0.1</td>
<td>0.1</td>
<td>580.0</td>
<td>0.00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2010-07-22</td>
<td>0.1</td>
<td>0.1</td>
<td>0.1</td>
<td>0.1</td>
<td>2160.0</td>
<td>0.00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4994</td>
<td>2024-03-20</td>
<td>67854.0</td>
<td>62046.8</td>
<td>68029.5</td>
<td>60850.9</td>
<td>133530.0</td>
<td>9.35</td>
<td>0.093537</td>
<td>23.719802</td>
<td>0.060681</td>
<td>0.044544</td>
<td>0.044059</td>
<td>0.043374</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4995</td>
<td>2024-03-21</td>
<td>65503.8</td>
<td>67860.0</td>
<td>68161.7</td>
<td>64616.1</td>
<td>75260.0</td>
<td>-3.46</td>
<td>-0.034636</td>
<td>23.685166</td>
<td>0.061287</td>
<td>0.045543</td>
<td>0.044563</td>
<td>0.044045</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4996</td>
<td>2024-03-22</td>
<td>63785.5</td>
<td>65501.5</td>
<td>66633.3</td>
<td>62328.3</td>
<td>72430.0</td>
<td>-2.62</td>
<td>-0.026232</td>
<td>23.658934</td>
<td>0.061256</td>
<td>0.045630</td>
<td>0.044883</td>
<td>0.044397</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4997</td>
<td>2024-03-23</td>
<td>64037.8</td>
<td>63785.6</td>
<td>65972.4</td>
<td>63074.9</td>
<td>35110.0</td>
<td>0.40</td>
<td>0.003955</td>
<td>23.662889</td>
<td>0.057331</td>
<td>0.045643</td>
<td>0.044842</td>
<td>0.044385</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4998</td>
<td>2024-03-24</td>
<td>67211.9</td>
<td>64036.5</td>
<td>67587.8</td>
<td>63812.9</td>
<td>65590.0</td>
<td>4.96</td>
<td>0.049566</td>
<td>23.712455</td>
<td>0.057684</td>
<td>0.047754</td>
<td>0.045898</td>
<td>0.045030</td>
</tr>
</tbody>
</table>

<p>4999 rows × 13 columns</p>
</div>
</div>
</div>
<div id="32e4683b" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>btc.info()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 4999 entries, 0 to 4998
Data columns (total 13 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   Date      4999 non-null   object 
 1   Price     4999 non-null   float64
 2   Open      4999 non-null   float64
 3   High      4999 non-null   float64
 4   Low       4999 non-null   float64
 5   Vol.      4999 non-null   float64
 6   Change %  4999 non-null   float64
 7   R_j       4999 non-null   float64
 8   A_t       4999 non-null   float64
 9   σ_7       4999 non-null   float64
 10  σ_14      4999 non-null   float64
 11  σ_21      4999 non-null   float64
 12  σ_28      4999 non-null   float64
dtypes: float64(12), object(1)
memory usage: 507.8+ KB</code></pre>
</div>
</div>
<div id="c1ee9cee" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>btc <span class="op">=</span> btc.fillna(<span class="dv">0</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>btc[<span class="st">'Date'</span>] <span class="op">=</span> pd.to_datetime(btc[<span class="st">'Date'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st">'</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>btc.set_index(<span class="st">'Date'</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>btc.info()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
DatetimeIndex: 4999 entries, 2010-07-18 to 2024-03-24
Data columns (total 12 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   Price     4999 non-null   float64
 1   Open      4999 non-null   float64
 2   High      4999 non-null   float64
 3   Low       4999 non-null   float64
 4   Vol.      4999 non-null   float64
 5   Change %  4999 non-null   float64
 6   R_j       4999 non-null   float64
 7   A_t       4999 non-null   float64
 8   σ_7       4999 non-null   float64
 9   σ_14      4999 non-null   float64
 10  σ_21      4999 non-null   float64
 11  σ_28      4999 non-null   float64
dtypes: float64(12)
memory usage: 507.7 KB</code></pre>
</div>
</div>
</section>
<section id="series-de-tiempo-y-separación-de-los-conjuntos-de-datos" class="level1">
<h1>Series de tiempo y separación de los conjuntos de datos</h1>
<p>En esta sección se construirán las series de tiempo para cada una de las variables objetico (precio, retorno acumulado y volatilidad en cada uno de los retornos diarios construidos). Además, se crearán los conjuntos de datos de entrenamiento, validación y test para los modelos estadísticos que estaremos construyendo en este capítulo.</p>
<p>Inicialmente, construiremos una función que usaremos para la separación de nuestros conjuntos de datos. Tengamos en cuenta que pare este ejercicio nuestras ventanas de tiempo serán <span class="math inline">\(\omega =\)</span> 7, 14, 21 y 28.</p>
<div id="5affb565" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> split_dataset(data: pd.DataFrame, name: <span class="bu">str</span>, w: <span class="bu">int</span>, N_val: <span class="bu">int</span> <span class="op">=</span> <span class="dv">28</span>, N_test: <span class="bu">int</span> <span class="op">=</span> <span class="dv">28</span>) <span class="op">-&gt;</span> Tuple[pd.Series, pd.Series, pd.Series, <span class="bu">int</span>]:</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    N_train <span class="op">=</span> <span class="bu">len</span>(data) <span class="op">-</span> N_val <span class="op">-</span> N_test</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    train <span class="op">=</span> data[name].iloc[:N_train]</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    val <span class="op">=</span> data[name].iloc[N_train:N_train <span class="op">+</span> w]</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    test <span class="op">=</span> data[name].iloc[N_train <span class="op">+</span> w:N_train <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> w]</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'Tamaños de los conjuntos de datos para la variable </span><span class="sc">{</span>name<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss"> con τ = </span><span class="sc">{</span>w<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'Conjunto de entrenamiento: </span><span class="sc">{</span><span class="bu">len</span>(train)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'Conjunto de validación: </span><span class="sc">{</span><span class="bu">len</span>(val)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'Conjunto de prueba: </span><span class="sc">{</span><span class="bu">len</span>(test)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> train, val, test, w</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ahora, pasemos a construir nuestras series de tiempo para cada variable.</p>
<section id="variable-price" class="level2">
<h2 class="anchored" data-anchor-id="variable-price">Variable Price</h2>
<div id="991d4f50" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>price7 <span class="op">=</span> split_dataset(btc, <span class="st">'Price'</span>, <span class="dv">7</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>price14 <span class="op">=</span> split_dataset(btc, <span class="st">'Price'</span>, <span class="dv">14</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>price21 <span class="op">=</span> split_dataset(btc, <span class="st">'Price'</span>, <span class="dv">21</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>price28 <span class="op">=</span> split_dataset(btc, <span class="st">'Price'</span>, <span class="dv">28</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tamaños de los conjuntos de datos para la variable price con τ = 7
Conjunto de entrenamiento: 4943
Conjunto de validación: 7
Conjunto de prueba: 7

Tamaños de los conjuntos de datos para la variable price con τ = 14
Conjunto de entrenamiento: 4943
Conjunto de validación: 14
Conjunto de prueba: 14

Tamaños de los conjuntos de datos para la variable price con τ = 21
Conjunto de entrenamiento: 4943
Conjunto de validación: 21
Conjunto de prueba: 21

Tamaños de los conjuntos de datos para la variable price con τ = 28
Conjunto de entrenamiento: 4943
Conjunto de validación: 28
Conjunto de prueba: 28
</code></pre>
</div>
</div>
</section>
<section id="variable-retorno-acumulado" class="level2">
<h2 class="anchored" data-anchor-id="variable-retorno-acumulado">Variable retorno acumulado</h2>
<div id="ee3821e3" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>A_t7 <span class="op">=</span> split_dataset(btc, <span class="st">'A_t'</span>, <span class="dv">7</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>A_t14 <span class="op">=</span> split_dataset(btc, <span class="st">'A_t'</span>, <span class="dv">14</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>A_t21 <span class="op">=</span> split_dataset(btc, <span class="st">'A_t'</span>, <span class="dv">21</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>A_t28 <span class="op">=</span> split_dataset(btc, <span class="st">'A_t'</span>, <span class="dv">28</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tamaños de los conjuntos de datos para la variable a_t con τ = 7
Conjunto de entrenamiento: 4943
Conjunto de validación: 7
Conjunto de prueba: 7

Tamaños de los conjuntos de datos para la variable a_t con τ = 14
Conjunto de entrenamiento: 4943
Conjunto de validación: 14
Conjunto de prueba: 14

Tamaños de los conjuntos de datos para la variable a_t con τ = 21
Conjunto de entrenamiento: 4943
Conjunto de validación: 21
Conjunto de prueba: 21

Tamaños de los conjuntos de datos para la variable a_t con τ = 28
Conjunto de entrenamiento: 4943
Conjunto de validación: 28
Conjunto de prueba: 28
</code></pre>
</div>
</div>
</section>
<section id="variable-volatilidad" class="level2">
<h2 class="anchored" data-anchor-id="variable-volatilidad">Variable volatilidad</h2>
<section id="sigma-tal-que-omega-7" class="level3">
<h3 class="anchored" data-anchor-id="sigma-tal-que-omega-7"><span class="math inline">\(\sigma\)</span> tal que <span class="math inline">\(\omega = 7\)</span></h3>
<div id="b3761b0b" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>vol7_7 <span class="op">=</span> split_dataset(btc, <span class="st">'σ_7'</span>, <span class="dv">7</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>vol7_14 <span class="op">=</span> split_dataset(btc, <span class="st">'σ_7'</span>, <span class="dv">14</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>vol7_21 <span class="op">=</span> split_dataset(btc, <span class="st">'σ_7'</span>, <span class="dv">21</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>vol7_28 <span class="op">=</span> split_dataset(btc, <span class="st">'σ_7'</span>, <span class="dv">28</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tamaños de los conjuntos de datos para la variable σ_7 con τ = 7
Conjunto de entrenamiento: 4943
Conjunto de validación: 7
Conjunto de prueba: 7

Tamaños de los conjuntos de datos para la variable σ_7 con τ = 14
Conjunto de entrenamiento: 4943
Conjunto de validación: 14
Conjunto de prueba: 14

Tamaños de los conjuntos de datos para la variable σ_7 con τ = 21
Conjunto de entrenamiento: 4943
Conjunto de validación: 21
Conjunto de prueba: 21

Tamaños de los conjuntos de datos para la variable σ_7 con τ = 28
Conjunto de entrenamiento: 4943
Conjunto de validación: 28
Conjunto de prueba: 28
</code></pre>
</div>
</div>
</section>
<section id="sigma-tal-que-omega-14" class="level3">
<h3 class="anchored" data-anchor-id="sigma-tal-que-omega-14"><span class="math inline">\(\sigma\)</span> tal que <span class="math inline">\(\omega = 14\)</span></h3>
<div id="78662588" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>vol14_7 <span class="op">=</span> split_dataset(btc, <span class="st">'σ_14'</span>, <span class="dv">7</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>vol14_14 <span class="op">=</span> split_dataset(btc, <span class="st">'σ_14'</span>, <span class="dv">14</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>vol14_21 <span class="op">=</span> split_dataset(btc, <span class="st">'σ_14'</span>, <span class="dv">21</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>vol14_28 <span class="op">=</span> split_dataset(btc, <span class="st">'σ_14'</span>, <span class="dv">28</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tamaños de los conjuntos de datos para la variable σ_14 con τ = 7
Conjunto de entrenamiento: 4943
Conjunto de validación: 7
Conjunto de prueba: 7

Tamaños de los conjuntos de datos para la variable σ_14 con τ = 14
Conjunto de entrenamiento: 4943
Conjunto de validación: 14
Conjunto de prueba: 14

Tamaños de los conjuntos de datos para la variable σ_14 con τ = 21
Conjunto de entrenamiento: 4943
Conjunto de validación: 21
Conjunto de prueba: 21

Tamaños de los conjuntos de datos para la variable σ_14 con τ = 28
Conjunto de entrenamiento: 4943
Conjunto de validación: 28
Conjunto de prueba: 28
</code></pre>
</div>
</div>
</section>
<section id="sigma-tal-que-omega-21" class="level3">
<h3 class="anchored" data-anchor-id="sigma-tal-que-omega-21"><span class="math inline">\(\sigma\)</span> tal que <span class="math inline">\(\omega = 21\)</span></h3>
<div id="9f4c1ed9" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>vol21_7 <span class="op">=</span> split_dataset(btc, <span class="st">'σ_21'</span>, <span class="dv">7</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>vol21_14 <span class="op">=</span> split_dataset(btc, <span class="st">'σ_21'</span>, <span class="dv">14</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>vol21_21 <span class="op">=</span> split_dataset(btc, <span class="st">'σ_21'</span>, <span class="dv">21</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>vol21_28 <span class="op">=</span> split_dataset(btc, <span class="st">'σ_21'</span>, <span class="dv">28</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tamaños de los conjuntos de datos para la variable σ_21 con τ = 7
Conjunto de entrenamiento: 4943
Conjunto de validación: 7
Conjunto de prueba: 7

Tamaños de los conjuntos de datos para la variable σ_21 con τ = 14
Conjunto de entrenamiento: 4943
Conjunto de validación: 14
Conjunto de prueba: 14

Tamaños de los conjuntos de datos para la variable σ_21 con τ = 21
Conjunto de entrenamiento: 4943
Conjunto de validación: 21
Conjunto de prueba: 21

Tamaños de los conjuntos de datos para la variable σ_21 con τ = 28
Conjunto de entrenamiento: 4943
Conjunto de validación: 28
Conjunto de prueba: 28
</code></pre>
</div>
</div>
</section>
<section id="sigma-tal-que-omega-28" class="level3">
<h3 class="anchored" data-anchor-id="sigma-tal-que-omega-28"><span class="math inline">\(\sigma\)</span> tal que <span class="math inline">\(\omega = 28\)</span></h3>
<div id="654e159a" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>vol28_7 <span class="op">=</span> split_dataset(btc, <span class="st">'σ_28'</span>, <span class="dv">7</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>vol28_14 <span class="op">=</span> split_dataset(btc, <span class="st">'σ_28'</span>, <span class="dv">14</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>vol28_21 <span class="op">=</span> split_dataset(btc, <span class="st">'σ_28'</span>, <span class="dv">21</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>vol28_28 <span class="op">=</span> split_dataset(btc, <span class="st">'σ_28'</span>, <span class="dv">28</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tamaños de los conjuntos de datos para la variable σ_28 con τ = 7
Conjunto de entrenamiento: 4943
Conjunto de validación: 7
Conjunto de prueba: 7

Tamaños de los conjuntos de datos para la variable σ_28 con τ = 14
Conjunto de entrenamiento: 4943
Conjunto de validación: 14
Conjunto de prueba: 14

Tamaños de los conjuntos de datos para la variable σ_28 con τ = 21
Conjunto de entrenamiento: 4943
Conjunto de validación: 21
Conjunto de prueba: 21

Tamaños de los conjuntos de datos para la variable σ_28 con τ = 28
Conjunto de entrenamiento: 4943
Conjunto de validación: 28
Conjunto de prueba: 28
</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="aplicación-de-los-modelos-estadísticos" class="level1">
<h1>Aplicación de los modelos estadísticos</h1>
<p>Luego de construir nuestros conjuntos de datos para cada una de las variables de interés podemos proceder a construir los modelos estadísticos mencionados al inicio de este capítulo. De esta forma, luego de obtener los resultados podremos evaluar cuál modelo captura la tendencia con mayor precisión para las variables objetivo.</p>
<section id="exponential-smoothing" class="level2">
<h2 class="anchored" data-anchor-id="exponential-smoothing">Exponential Smoothing</h2>
<p>Sabemos que una suavización exponencial está dada por:</p>
<p><span class="math display">\[
\tilde{y} = \lambda y_T + (1 - \lambda) \tilde{y}_{T - 1}
\]</span></p>
<p>tal que <span class="math inline">\(\lambda\)</span> es nuestro parámetro a optimizar en este tipo de modelos. Además, note que <span class="math inline">\(\tilde{y}\)</span> es nuestra serie de tiempo suavizada de forma que <span class="math inline">\(y_T = \tilde{y}^{0}\)</span>.</p>
<p>Para obtener nuestras suavizaciones sin librería construyamos algunas funciones importantes para su construcción:</p>
<div id="fd2466e7" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ExponentialSmoothing:</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, data: pd.Series, param: <span class="bu">float</span>, start: Optional[<span class="bu">float</span>] <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data <span class="op">=</span> data</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.param <span class="op">=</span> param</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.start <span class="op">=</span> start <span class="cf">if</span> start <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span> <span class="cf">else</span> data.iloc[<span class="dv">0</span>]</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> smooth(<span class="va">self</span>) <span class="op">-&gt;</span> pd.Series:</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> <span class="va">self</span>.data.copy()</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>        y.iloc[<span class="dv">0</span>] <span class="op">=</span> <span class="va">self</span>.param <span class="op">*</span> y.iloc[<span class="dv">0</span>] <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> <span class="va">self</span>.param) <span class="op">*</span> <span class="va">self</span>.start</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(y)):</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>            y.iloc[i] <span class="op">=</span> <span class="va">self</span>.param <span class="op">*</span> y.iloc[i] <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> <span class="va">self</span>.param) <span class="op">*</span> y.iloc[i <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> y</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> evaluate(<span class="va">self</span>, smoothed_data: Optional[pd.Series] <span class="op">=</span> <span class="va">None</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> smoothed_data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>            smoothed_data <span class="op">=</span> <span class="va">self</span>.smooth()</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>        T <span class="op">=</span> <span class="bu">len</span>(<span class="va">self</span>.data)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>        actual_values <span class="op">=</span> <span class="va">self</span>.data.values</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>        predicted_values <span class="op">=</span> pd.concat([pd.Series([<span class="va">self</span>.data.iloc[<span class="dv">0</span>]]), smoothed_data.iloc[:<span class="op">-</span><span class="dv">1</span>]], ignore_index<span class="op">=</span><span class="va">True</span>).values</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>        error <span class="op">=</span> actual_values <span class="op">-</span> predicted_values</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>        mean_actual <span class="op">=</span> np.mean(actual_values)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>        SSE <span class="op">=</span> <span class="bu">sum</span>(error<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>        MAPE <span class="op">=</span> <span class="dv">100</span> <span class="op">*</span> <span class="bu">sum</span>(<span class="bu">abs</span>(error <span class="op">/</span> actual_values)) <span class="op">/</span> T</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>        MAE <span class="op">=</span> np.mean(np.<span class="bu">abs</span>(error))</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>        MSE <span class="op">=</span> SSE <span class="op">/</span> T</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>        RMSE <span class="op">=</span> np.sqrt(MSE)</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>        R2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (SSE <span class="op">/</span> (np.<span class="bu">sum</span>((actual_values <span class="op">-</span> mean_actual) <span class="op">**</span> <span class="dv">2</span>)))</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pd.DataFrame({</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">'MAPE'</span>: [MAPE],</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">'MAE'</span>: [MAE],</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">'RMSE'</span>: [RMSE],</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">'MSE'</span>: [MSE],</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">'R2'</span>: [R2]</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> optimize_param(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>        smoothed_data <span class="op">=</span> <span class="va">self</span>.smooth()</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.evaluate(smoothed_data)[<span class="st">'MAE'</span>].values[<span class="dv">0</span>]</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_metrics(<span class="va">self</span>, y: pd.Series, y_pred: pd.Series, metric_name: <span class="bu">str</span>, case: <span class="bu">str</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>        residuals <span class="op">=</span> y <span class="op">-</span> y_pred</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>        metrics_df <span class="op">=</span> <span class="va">self</span>.evaluate(y_pred)</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>        metrics_df.index <span class="op">=</span> metrics_df.index.<span class="bu">map</span>({<span class="dv">0</span>: <span class="ss">f'</span><span class="sc">{</span>metric_name<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>case<span class="sc">}</span><span class="ss">'</span>})</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>        max_lag <span class="op">=</span> <span class="bu">min</span>(<span class="dv">10</span>, <span class="bu">len</span>(residuals) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> max_lag <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>            ljung_box_pval <span class="op">=</span> acorr_ljungbox(residuals, lags<span class="op">=</span>[max_lag], return_df<span class="op">=</span><span class="va">True</span>)[<span class="st">'lb_pvalue'</span>].iloc[<span class="dv">0</span>]</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>            ljung_box_pval <span class="op">=</span> np.nan</span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>        jb_pvalue <span class="op">=</span> jarque_bera(residuals)[<span class="dv">1</span>]</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>        metrics_df[<span class="st">'Ljung-Box p-value'</span>] <span class="op">=</span> ljung_box_pval</span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>        metrics_df[<span class="st">'Jarque-Bera p-value'</span>] <span class="op">=</span> jb_pvalue</span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> metrics_df, residuals</span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> plot_residuals(<span class="va">self</span>, residuals: pd.Series, model_name: <span class="bu">str</span>):</span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>        fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="fl">8.6</span>, <span class="dv">5</span>))</span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>        ax.plot(residuals.index, residuals.values, color<span class="op">=</span><span class="st">'#1f77b4'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, markersize<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="ss">f'</span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>        ax.set_xlabel(<span class="st">'Índice'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(<span class="st">'Residuo'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>        ax.grid(<span class="va">True</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> plot_diagnostics(<span class="va">self</span>, residuals: pd.Series, model_name: <span class="bu">str</span>):</span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a>        fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">2</span>, ncols<span class="op">=</span><span class="dv">1</span>, figsize<span class="op">=</span>(<span class="fl">7.6</span>, <span class="dv">6</span>))</span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a>        sm.qqplot(residuals, line<span class="op">=</span><span class="st">'s'</span>, ax<span class="op">=</span>axes[<span class="dv">0</span>])</span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>].set_title(<span class="st">'QQ Plot de los Residuos'</span>)</span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a>        sm.graphics.tsa.plot_pacf(residuals, lags<span class="op">=</span><span class="dv">30</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>].set_title(<span class="st">'Autocorrelación Parcial de los Residuos'</span>)</span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a>        plt.suptitle(<span class="ss">f'</span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a>        plt.tight_layout(rect<span class="op">=</span>[<span class="dv">0</span>, <span class="fl">0.03</span>, <span class="dv">1</span>, <span class="fl">0.95</span>])</span>
<span id="cb20-80"><a href="#cb20-80" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb20-81"><a href="#cb20-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-82"><a href="#cb20-82" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> residuals(<span class="va">self</span>, model_name: <span class="bu">str</span>, metric_name: <span class="bu">str</span>, case: <span class="bu">str</span>, y: pd.Series, y_pred: pd.Series, show_info: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb20-83"><a href="#cb20-83" aria-hidden="true" tabindex="-1"></a>        metrics_df, residuals <span class="op">=</span> <span class="va">self</span>.calculate_metrics(y, y_pred, metric_name, case)</span>
<span id="cb20-84"><a href="#cb20-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-85"><a href="#cb20-85" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> show_info:</span>
<span id="cb20-86"><a href="#cb20-86" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.plot_residuals(residuals, model_name)</span>
<span id="cb20-87"><a href="#cb20-87" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.plot_diagnostics(residuals, model_name)</span>
<span id="cb20-88"><a href="#cb20-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-89"><a href="#cb20-89" aria-hidden="true" tabindex="-1"></a>            ljung_box_pval <span class="op">=</span> metrics_df[<span class="st">'Ljung-Box p-value'</span>].iloc[<span class="dv">0</span>]</span>
<span id="cb20-90"><a href="#cb20-90" aria-hidden="true" tabindex="-1"></a>            jb_pvalue <span class="op">=</span> metrics_df[<span class="st">'Jarque-Bera p-value'</span>].iloc[<span class="dv">0</span>]</span>
<span id="cb20-91"><a href="#cb20-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-92"><a href="#cb20-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> ljung_box_pval <span class="op">&gt;</span> <span class="fl">0.05</span>:</span>
<span id="cb20-93"><a href="#cb20-93" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'No se rechaza H0: los residuales son independientes (no correlacionados).'</span>)</span>
<span id="cb20-94"><a href="#cb20-94" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb20-95"><a href="#cb20-95" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'Se rechaza H0: hay autocorrelación en los residuales.'</span>)</span>
<span id="cb20-96"><a href="#cb20-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-97"><a href="#cb20-97" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f'Jarque-Bera p-value: </span><span class="sc">{</span>jb_pvalue<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb20-98"><a href="#cb20-98" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> jb_pvalue <span class="op">&gt;</span> <span class="fl">0.05</span>:</span>
<span id="cb20-99"><a href="#cb20-99" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'No se rechaza H0: los residuales siguen una distribución normal.'</span>)</span>
<span id="cb20-100"><a href="#cb20-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb20-101"><a href="#cb20-101" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'Se rechaza H0: los residuales no siguen una distribución normal.'</span>)</span>
<span id="cb20-102"><a href="#cb20-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-103"><a href="#cb20-103" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> metrics_df</span>
<span id="cb20-104"><a href="#cb20-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-105"><a href="#cb20-105" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> plot_preds(<span class="va">self</span>, y_train: pd.Series, y_val: pd.Series, y_test: pd.Series,</span>
<span id="cb20-106"><a href="#cb20-106" aria-hidden="true" tabindex="-1"></a>                            y_pred_train: pd.Series, y_pred_val: pd.Series, y_pred_test: pd.Series):</span>
<span id="cb20-107"><a href="#cb20-107" aria-hidden="true" tabindex="-1"></a>        fig <span class="op">=</span> go.Figure()</span>
<span id="cb20-108"><a href="#cb20-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-109"><a href="#cb20-109" aria-hidden="true" tabindex="-1"></a>        fig.add_trace(go.Scatter(x<span class="op">=</span>y_train[<span class="op">-</span><span class="dv">250</span>:].index, y<span class="op">=</span>y_train[<span class="op">-</span><span class="dv">250</span>:], mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'y_train'</span>, line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#FDDBBB'</span>, dash <span class="op">=</span> <span class="st">'dash'</span>)))</span>
<span id="cb20-110"><a href="#cb20-110" aria-hidden="true" tabindex="-1"></a>        fig.add_trace(go.Scatter(x<span class="op">=</span>y_val.index, y<span class="op">=</span>y_val, mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'y_val'</span>, line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#BFECFF'</span>, dash <span class="op">=</span> <span class="st">'dash'</span>)))</span>
<span id="cb20-111"><a href="#cb20-111" aria-hidden="true" tabindex="-1"></a>        fig.add_trace(go.Scatter(x<span class="op">=</span>y_test.index, y<span class="op">=</span>y_test, mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'y_test'</span>, line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#C9E9D2'</span>, dash <span class="op">=</span> <span class="st">'dash'</span>)))</span>
<span id="cb20-112"><a href="#cb20-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-113"><a href="#cb20-113" aria-hidden="true" tabindex="-1"></a>        fig.add_trace(go.Scatter(x<span class="op">=</span>y_pred_train[<span class="op">-</span><span class="dv">250</span>:].index, y<span class="op">=</span>y_pred_train[<span class="op">-</span><span class="dv">250</span>:], mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'y_pred_train'</span>,</span>
<span id="cb20-114"><a href="#cb20-114" aria-hidden="true" tabindex="-1"></a>                                 line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#CB9DF0'</span>, dash<span class="op">=</span><span class="st">'dash'</span>)))</span>
<span id="cb20-115"><a href="#cb20-115" aria-hidden="true" tabindex="-1"></a>        fig.add_trace(go.Scatter(x<span class="op">=</span>y_pred_val.index, y<span class="op">=</span>y_pred_val, mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'y_pred_val'</span>,</span>
<span id="cb20-116"><a href="#cb20-116" aria-hidden="true" tabindex="-1"></a>                                 line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#FFCCEA'</span>, dash<span class="op">=</span><span class="st">'dash'</span>)))</span>
<span id="cb20-117"><a href="#cb20-117" aria-hidden="true" tabindex="-1"></a>        fig.add_trace(go.Scatter(x<span class="op">=</span>y_pred_test.index, y<span class="op">=</span>y_pred_test, mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'y_pred_test'</span>,</span>
<span id="cb20-118"><a href="#cb20-118" aria-hidden="true" tabindex="-1"></a>                                 line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#EEEEEE'</span>, dash<span class="op">=</span><span class="st">'dash'</span>)))</span>
<span id="cb20-119"><a href="#cb20-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-120"><a href="#cb20-120" aria-hidden="true" tabindex="-1"></a>        fig.update_layout(</span>
<span id="cb20-121"><a href="#cb20-121" aria-hidden="true" tabindex="-1"></a>            title<span class="op">=</span><span class="st">"Comparación de y v.s. y_pred"</span>,</span>
<span id="cb20-122"><a href="#cb20-122" aria-hidden="true" tabindex="-1"></a>            xaxis_title<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb20-123"><a href="#cb20-123" aria-hidden="true" tabindex="-1"></a>            yaxis_title<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb20-124"><a href="#cb20-124" aria-hidden="true" tabindex="-1"></a>            legend_title<span class="op">=</span><span class="st">"Series"</span>,</span>
<span id="cb20-125"><a href="#cb20-125" aria-hidden="true" tabindex="-1"></a>            margin<span class="op">=</span>{<span class="st">'b'</span>: <span class="dv">0</span>, <span class="st">'r'</span>: <span class="dv">30</span>, <span class="st">'l'</span>: <span class="dv">30</span>, <span class="st">'t'</span>: <span class="dv">80</span>},</span>
<span id="cb20-126"><a href="#cb20-126" aria-hidden="true" tabindex="-1"></a>            plot_bgcolor<span class="op">=</span><span class="st">'rgba(0, 0, 0, 0.0)'</span>,</span>
<span id="cb20-127"><a href="#cb20-127" aria-hidden="true" tabindex="-1"></a>            paper_bgcolor<span class="op">=</span><span class="st">'rgba(0, 0, 0, 0.0)'</span>,</span>
<span id="cb20-128"><a href="#cb20-128" aria-hidden="true" tabindex="-1"></a>            font_color<span class="op">=</span><span class="st">"white"</span>,</span>
<span id="cb20-129"><a href="#cb20-129" aria-hidden="true" tabindex="-1"></a>            hoverlabel<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb20-130"><a href="#cb20-130" aria-hidden="true" tabindex="-1"></a>                bgcolor<span class="op">=</span><span class="st">"#222"</span></span>
<span id="cb20-131"><a href="#cb20-131" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb20-132"><a href="#cb20-132" aria-hidden="true" tabindex="-1"></a>            xaxis<span class="op">=</span><span class="bu">dict</span>(gridcolor<span class="op">=</span><span class="st">'#222'</span>, tickfont<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'white'</span>)),</span>
<span id="cb20-133"><a href="#cb20-133" aria-hidden="true" tabindex="-1"></a>            yaxis<span class="op">=</span><span class="bu">dict</span>(gridcolor<span class="op">=</span><span class="st">'#222'</span>, tickfont<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'white'</span>)),</span>
<span id="cb20-134"><a href="#cb20-134" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb20-135"><a href="#cb20-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-136"><a href="#cb20-136" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> fig</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para encontrar el mejor modelo y optimizar el hiperparámetro <span class="math inline">\(\lambda\)</span> evaluaremos nuestro modelo para <span class="math inline">\(\lambda\)</span> = 0.1, 0.2, 0.3, …, 1. De esta forma, creemos nuestro vector de posibles parámetros</p>
<div id="c95a8e90" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> np.arange(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="caso-simple-sin-librería" class="level3">
<h3 class="anchored" data-anchor-id="caso-simple-sin-librería">Caso simple sin librería</h3>
<section id="price" class="level4">
<h4 class="anchored" data-anchor-id="price">Price</h4>
<section id="tau-7" class="level5">
<h5 class="anchored" data-anchor-id="tau-7"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="fae60601" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(price7[<span class="dv">0</span>], param)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.127488</td>
<td>674.145803</td>
<td>1543.999512</td>
<td>2.383934e+06</td>
<td>0.989635</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>5.635438</td>
<td>465.403502</td>
<td>1099.627177</td>
<td>1.209180e+06</td>
<td>0.994743</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4.594736</td>
<td>384.453951</td>
<td>916.213559</td>
<td>8.394473e+05</td>
<td>0.996350</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4.014740</td>
<td>338.103495</td>
<td>814.197857</td>
<td>6.629181e+05</td>
<td>0.997118</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3.644007</td>
<td>307.473577</td>
<td>750.827255</td>
<td>5.637416e+05</td>
<td>0.997549</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>3.396538</td>
<td>286.395022</td>
<td>709.679738</td>
<td>5.036453e+05</td>
<td>0.997810</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>3.226568</td>
<td>271.655603</td>
<td>683.013517</td>
<td>4.665075e+05</td>
<td>0.997972</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>3.112007</td>
<td>262.536871</td>
<td>666.757236</td>
<td>4.445652e+05</td>
<td>0.998067</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>3.046369</td>
<td>259.080426</td>
<td>658.687453</td>
<td>4.338692e+05</td>
<td>0.998114</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="8990f7cb" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-16-output-1.png" width="593" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="ccfdbe15" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price7[<span class="dv">0</span>], best_param)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>price7_se <span class="op">=</span> model.smooth()</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>metrics_price7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, price7[<span class="dv">0</span>], price7_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-17-output-1.png" width="726" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-17-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="5269569a" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price7[<span class="dv">1</span>], best_param)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>price7_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price7[<span class="dv">2</span>], best_param)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>price7_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>metrics_price7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, price7[<span class="dv">1</span>], price7_se_val)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>metrics_price7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, price7[<span class="dv">2</span>], price7_se_test)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_price7, metrics_price7_val, metrics_price7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>3.046369</td>
<td>259.080426</td>
<td>658.687453</td>
<td>4.338692e+05</td>
<td>0.998114</td>
<td>2.388399e-11</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>5.515992</td>
<td>2595.563591</td>
<td>3259.226089</td>
<td>1.062255e+07</td>
<td>-1.436019</td>
<td>3.537907e-01</td>
<td>0.713997</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>1.900521</td>
<td>876.181038</td>
<td>1056.085949</td>
<td>1.115318e+06</td>
<td>0.744230</td>
<td>3.443839e-01</td>
<td>0.877127</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="812eabd6" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(price7[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], price7[<span class="dv">1</span>], price7[<span class="dv">2</span>], price7_se, price7_se_val, price7_se_test)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_price7.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14" class="level5">
<h5 class="anchored" data-anchor-id="tau-14"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="72dd64c7" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price14[<span class="dv">0</span>], best_param)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>price14_se <span class="op">=</span> model.smooth()</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>metrics_price14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, price14[<span class="dv">0</span>], price14_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-21-output-1.png" width="726" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-21-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="854bf775" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price14[<span class="dv">1</span>], best_param)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>price14_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price14[<span class="dv">2</span>], best_param)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>price14_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>metrics_price14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, price14[<span class="dv">1</span>], price14_se_val)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>metrics_price14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, price14[<span class="dv">2</span>], price14_se_test)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_price14, metrics_price14_val, metrics_price14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>3.046369</td>
<td>259.080426</td>
<td>658.687453</td>
<td>4.338692e+05</td>
<td>0.998114</td>
<td>2.388399e-11</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>13.835246</td>
<td>7146.479407</td>
<td>7626.989891</td>
<td>5.817097e+07</td>
<td>-99.599588</td>
<td>1.086528e-02</td>
<td>0.536111</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>0.976014</td>
<td>503.811603</td>
<td>686.143049</td>
<td>4.707923e+05</td>
<td>0.185822</td>
<td>2.466010e-01</td>
<td>0.033318</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="c4f0618c" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(price14[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], price14[<span class="dv">1</span>], price14[<span class="dv">2</span>], price14_se, price14_se_val, price14_se_test)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_price14.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21" class="level5">
<h5 class="anchored" data-anchor-id="tau-21"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="72c9c0d5" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price21[<span class="dv">0</span>], best_param)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>price21_se <span class="op">=</span> model.smooth()</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>metrics_price21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, price21[<span class="dv">0</span>], price21_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-25-output-1.png" width="726" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-25-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="9b2869d1" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price21[<span class="dv">1</span>], best_param)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>price21_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price21[<span class="dv">2</span>], best_param)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>price21_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>metrics_price21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, price21[<span class="dv">1</span>], price21_se_val)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>metrics_price21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, price21[<span class="dv">2</span>], price21_se_test)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_price21, metrics_price21_val, metrics_price21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>3.046369</td>
<td>259.080426</td>
<td>658.687453</td>
<td>4.338692e+05</td>
<td>0.998114</td>
<td>2.388399e-11</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>21.587948</td>
<td>13201.685005</td>
<td>14045.488475</td>
<td>1.972757e+08</td>
<td>-3.394583</td>
<td>2.492182e-02</td>
<td>0.328854</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>2.479540</td>
<td>1528.328258</td>
<td>2218.995130</td>
<td>4.923939e+06</td>
<td>0.890313</td>
<td>8.062632e-01</td>
<td>0.378663</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="236e6d39" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(price21[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], price21[<span class="dv">1</span>], price21[<span class="dv">2</span>], price21_se, price21_se_val, price21_se_test)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_price21.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28" class="level5">
<h5 class="anchored" data-anchor-id="tau-28"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="4fac11cf" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price28[<span class="dv">0</span>], best_param)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>price28_se <span class="op">=</span> model.smooth()</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>metrics_price28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, price28[<span class="dv">0</span>], price28_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-29-output-1.png" width="726" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-29-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="06035a0d" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price28[<span class="dv">1</span>], best_param)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>price28_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price28[<span class="dv">2</span>], best_param)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>price28_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>metrics_price28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, price28[<span class="dv">1</span>], price28_se_val)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>metrics_price28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, price28[<span class="dv">2</span>], price28_se_test)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_price28, metrics_price28_val, metrics_price28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>3.046369</td>
<td>259.080426</td>
<td>658.687453</td>
<td>4.338692e+05</td>
<td>0.998114</td>
<td>2.388399e-11</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>26.932500</td>
<td>17886.266519</td>
<td>18638.252370</td>
<td>3.473845e+08</td>
<td>-18.054225</td>
<td>1.716122e-03</td>
<td>0.185748</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>3.260694</td>
<td>2141.568336</td>
<td>2761.802083</td>
<td>7.627551e+06</td>
<td>0.581625</td>
<td>6.889920e-01</td>
<td>0.953362</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="4b34b087" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(price28[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], price28[<span class="dv">1</span>], price28[<span class="dv">2</span>], price28_se, price28_se_val, price28_se_test)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_price28.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="57c29c89" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>metrics_price <span class="op">=</span> pd.concat([</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    metrics_price7, metrics_price7_val, metrics_price7_test,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    metrics_price14, metrics_price14_val, metrics_price14_test,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    metrics_price21, metrics_price21_val, metrics_price21_test,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    metrics_price28, metrics_price28_val, metrics_price28_test</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="retorno-acumulado" class="level4">
<h4 class="anchored" data-anchor-id="retorno-acumulado">Retorno acumulado</h4>
<section id="tau-7-1" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-1"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="45061890" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(A_t7[<span class="dv">0</span>], param)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>0.093896</td>
<td>0.183250</td>
<td>0.033581</td>
<td>0.999102</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>0.061176</td>
<td>0.127675</td>
<td>0.016301</td>
<td>0.999564</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>0.048750</td>
<td>0.105511</td>
<td>0.011132</td>
<td>0.999702</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>0.042050</td>
<td>0.093687</td>
<td>0.008777</td>
<td>0.999765</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>0.037878</td>
<td>0.086676</td>
<td>0.007513</td>
<td>0.999799</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>0.035097</td>
<td>0.082335</td>
<td>0.006779</td>
<td>0.999819</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>0.033219</td>
<td>0.079635</td>
<td>0.006342</td>
<td>0.999830</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>0.031947</td>
<td>0.078023</td>
<td>0.006088</td>
<td>0.999837</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>0.031174</td>
<td>0.077196</td>
<td>0.005959</td>
<td>0.999841</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="9f2f4195" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-35-output-1.png" width="597" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="179be965" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t7[<span class="dv">0</span>], best_param)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>A_t7_se <span class="op">=</span> model.smooth()</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>metrics_A_t7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, A_t7[<span class="dv">0</span>], A_t7_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-36-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-36-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="1482e3db" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t7[<span class="dv">1</span>], best_param)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>A_t7_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t7[<span class="dv">2</span>], best_param)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>A_t7_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>metrics_A_t7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, A_t7[<span class="dv">1</span>], A_t7_se_val)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>metrics_A_t7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, A_t7[<span class="dv">2</span>], A_t7_se_test)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_A_t7, metrics_A_t7_val, metrics_A_t7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>NaN</td>
<td>0.031174</td>
<td>0.077196</td>
<td>0.005959</td>
<td>0.999841</td>
<td>1.962549e-52</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>0.250985</td>
<td>0.058543</td>
<td>0.073220</td>
<td>0.005361</td>
<td>-1.466918</td>
<td>3.598554e-01</td>
<td>0.713362</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>0.083911</td>
<td>0.019555</td>
<td>0.023601</td>
<td>0.000557</td>
<td>0.743702</td>
<td>3.236181e-01</td>
<td>0.861572</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="1758eac3" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(A_t7[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], A_t7[<span class="dv">1</span>], A_t7[<span class="dv">2</span>], A_t7_se, A_t7_se_val, A_t7_se_test)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_A_t7.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-1" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-1"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="128e46b4" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t14[<span class="dv">0</span>], best_param)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>A_t14_se <span class="op">=</span> model.smooth()</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>metrics_A_t14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, A_t14[<span class="dv">0</span>], A_t14_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-40-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-40-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="9a4b5dc5" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t14[<span class="dv">1</span>], best_param)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>A_t14_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t14[<span class="dv">2</span>], best_param)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>A_t14_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>metrics_A_t14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, A_t14[<span class="dv">1</span>], A_t14_se_val)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>metrics_A_t14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, A_t14[<span class="dv">2</span>], A_t14_se_test)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_A_t14, metrics_A_t14_val, metrics_A_t14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>NaN</td>
<td>0.031174</td>
<td>0.077196</td>
<td>0.005959</td>
<td>0.999841</td>
<td>1.962549e-52</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>0.654477</td>
<td>0.153282</td>
<td>0.163826</td>
<td>0.026839</td>
<td>-115.084439</td>
<td>1.399318e-02</td>
<td>0.556588</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>0.042235</td>
<td>0.009891</td>
<td>0.013638</td>
<td>0.000186</td>
<td>0.195563</td>
<td>2.670533e-01</td>
<td>0.020649</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="e87439ae" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(A_t14[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], A_t14[<span class="dv">1</span>], A_t14[<span class="dv">2</span>], A_t14_se, A_t14_se_val, A_t14_se_test)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_A_t14.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-1" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-1"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="f8729cb4" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t21[<span class="dv">0</span>], best_param)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>A_t21_se <span class="op">=</span> model.smooth()</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>metrics_A_t21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, A_t21[<span class="dv">0</span>], A_t21_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-44-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-44-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="3f17c459" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t21[<span class="dv">1</span>], best_param)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>A_t21_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t21[<span class="dv">2</span>], best_param)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>A_t21_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>metrics_A_t21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, A_t21[<span class="dv">1</span>], A_t21_se_val)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>metrics_A_t21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, A_t21[<span class="dv">2</span>], A_t21_se_test)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_A_t21, metrics_A_t21_val, metrics_A_t21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>NaN</td>
<td>0.031174</td>
<td>0.077196</td>
<td>0.005959</td>
<td>0.999841</td>
<td>1.962549e-52</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>1.080485</td>
<td>0.254931</td>
<td>0.268152</td>
<td>0.071905</td>
<td>-4.091669</td>
<td>1.539759e-02</td>
<td>0.360388</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>0.108676</td>
<td>0.025648</td>
<td>0.037183</td>
<td>0.001383</td>
<td>0.902099</td>
<td>8.409056e-01</td>
<td>0.317597</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="f6254143" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(A_t21[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], A_t21[<span class="dv">1</span>], A_t21[<span class="dv">2</span>], A_t21_se, A_t21_se_val, A_t21_se_test)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_A_t21.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-1" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-1"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="b98a952d" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t28[<span class="dv">0</span>], best_param)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>A_t28_se <span class="op">=</span> model.smooth()</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>metrics_A_t28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, A_t28[<span class="dv">0</span>], A_t28_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-48-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-48-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="7044dfb9" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t28[<span class="dv">1</span>], best_param)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>A_t28_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t28[<span class="dv">2</span>], best_param)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>A_t28_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>metrics_A_t28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, A_t28[<span class="dv">1</span>], A_t28_se_val)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>metrics_A_t28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, A_t28[<span class="dv">2</span>], A_t28_se_test)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_A_t28, metrics_A_t28_val, metrics_A_t28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>NaN</td>
<td>0.031174</td>
<td>0.077196</td>
<td>0.005959</td>
<td>0.999841</td>
<td>1.962549e-52</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>1.415508</td>
<td>0.335268</td>
<td>0.348769</td>
<td>0.121640</td>
<td>-23.813500</td>
<td>1.094760e-03</td>
<td>0.180574</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>0.139763</td>
<td>0.033090</td>
<td>0.043296</td>
<td>0.001875</td>
<td>0.617614</td>
<td>7.767905e-01</td>
<td>0.984256</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="17d006e5" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(A_t28[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], A_t28[<span class="dv">1</span>], A_t28[<span class="dv">2</span>], A_t28_se, A_t28_se_val, A_t28_se_test)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_A_t28.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="41bcb76c" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>metrics_A_t <span class="op">=</span> pd.concat([</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    metrics_A_t7, metrics_A_t7_val, metrics_A_t7_test,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    metrics_A_t14, metrics_A_t14_val, metrics_A_t14_test,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    metrics_A_t21, metrics_A_t21_val, metrics_A_t21_test,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    metrics_A_t28, metrics_A_t28_val, metrics_A_t28_test</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="volatilidad-omega-7" class="level4">
<h4 class="anchored" data-anchor-id="volatilidad-omega-7">Volatilidad <span class="math inline">\(\omega = 7\)</span></h4>
<section id="tau-7-2" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-2"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="4763f174" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(vol7_7[<span class="dv">0</span>], param)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>0.017460</td>
<td>0.049634</td>
<td>0.002464</td>
<td>0.418100</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>0.014276</td>
<td>0.042103</td>
<td>0.001773</td>
<td>0.581291</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>0.011940</td>
<td>0.036801</td>
<td>0.001354</td>
<td>0.680098</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>0.010206</td>
<td>0.033026</td>
<td>0.001091</td>
<td>0.742373</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>0.008933</td>
<td>0.030342</td>
<td>0.000921</td>
<td>0.782540</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>0.007981</td>
<td>0.028454</td>
<td>0.000810</td>
<td>0.808759</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>0.007244</td>
<td>0.027155</td>
<td>0.000737</td>
<td>0.825820</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>0.006675</td>
<td>0.026304</td>
<td>0.000692</td>
<td>0.836575</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>0.006238</td>
<td>0.025808</td>
<td>0.000666</td>
<td>0.842670</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="8126260a" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-54-output-1.png" width="606" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="853f479a" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_7[<span class="dv">0</span>], best_param)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>vol7_7_se <span class="op">=</span> model.smooth()</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>metrics_vol7_7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, vol7_7[<span class="dv">0</span>], vol7_7_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-55-output-1.png" width="738" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-55-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="f6316717" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_7[<span class="dv">1</span>], best_param)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>vol7_7_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_7[<span class="dv">2</span>], best_param)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>vol7_7_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>metrics_vol7_7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, vol7_7[<span class="dv">1</span>], vol7_7_se_val)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>metrics_vol7_7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, vol7_7[<span class="dv">2</span>], vol7_7_se_test)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol7_7, metrics_vol7_7_val, metrics_vol7_7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>NaN</td>
<td>0.006238</td>
<td>0.025808</td>
<td>0.000666</td>
<td>0.842670</td>
<td>5.398223e-219</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>38.582404</td>
<td>0.004440</td>
<td>0.005734</td>
<td>0.000033</td>
<td>-1.529547</td>
<td>7.971377e-01</td>
<td>0.133831</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>16.090127</td>
<td>0.002291</td>
<td>0.002913</td>
<td>0.000008</td>
<td>0.347288</td>
<td>6.168363e-01</td>
<td>0.873767</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="77397178" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol7_7[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol7_7[<span class="dv">1</span>], vol7_7[<span class="dv">2</span>], vol7_7_se, vol7_7_se_val, vol7_7_se_test)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol7_7.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-2" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-2"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="2eb75bfa" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_14[<span class="dv">0</span>], best_param)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>vol7_14_se <span class="op">=</span> model.smooth()</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>metrics_vol7_14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, vol7_14[<span class="dv">0</span>], vol7_14_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-59-output-1.png" width="738" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-59-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="b0ef5054" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_14[<span class="dv">1</span>], best_param)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>vol7_14_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_14[<span class="dv">2</span>], best_param)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>vol7_14_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>metrics_vol7_14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, vol7_14[<span class="dv">1</span>], vol7_14_se_val)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>metrics_vol7_14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, vol7_14[<span class="dv">2</span>], vol7_14_se_test)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol7_14, metrics_vol7_14_val, metrics_vol7_14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>NaN</td>
<td>0.006238</td>
<td>0.025808</td>
<td>0.000666</td>
<td>0.842670</td>
<td>5.398223e-219</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>28.684157</td>
<td>0.003924</td>
<td>0.004494</td>
<td>0.000020</td>
<td>-0.240202</td>
<td>4.915045e-01</td>
<td>0.598503</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>15.542838</td>
<td>0.001834</td>
<td>0.002845</td>
<td>0.000008</td>
<td>0.503033</td>
<td>7.350284e-01</td>
<td>0.000542</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="96d8b4c3" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol7_14[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol7_14[<span class="dv">1</span>], vol7_14[<span class="dv">2</span>], vol7_14_se, vol7_14_se_val, vol7_14_se_test)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol7_14.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-2" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-2"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="4a600360" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_21[<span class="dv">0</span>], best_param)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>vol7_21_se <span class="op">=</span> model.smooth()</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>metrics_vol7_21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, vol7_21[<span class="dv">0</span>], vol7_21_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-63-output-1.png" width="738" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-63-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="11d22566" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_21[<span class="dv">1</span>], best_param)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>vol7_21_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_21[<span class="dv">2</span>], best_param)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>vol7_21_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>metrics_vol7_21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, vol7_21[<span class="dv">1</span>], vol7_21_se_val)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>metrics_vol7_21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, vol7_21[<span class="dv">2</span>], vol7_21_se_test)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol7_21, metrics_vol7_21_val, metrics_vol7_21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>NaN</td>
<td>0.006238</td>
<td>0.025808</td>
<td>0.000666</td>
<td>0.842670</td>
<td>5.398223e-219</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>65.284736</td>
<td>0.019478</td>
<td>0.022630</td>
<td>0.000512</td>
<td>-1.216606</td>
<td>8.974552e-01</td>
<td>0.179385</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>15.627563</td>
<td>0.003870</td>
<td>0.005863</td>
<td>0.000034</td>
<td>0.851225</td>
<td>8.721455e-01</td>
<td>0.556941</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="4708786a" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol7_21[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol7_21[<span class="dv">1</span>], vol7_21[<span class="dv">2</span>], vol7_21_se, vol7_21_se_val, vol7_21_se_test)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol7_21.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-2" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-2"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="a87df3d6" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_28[<span class="dv">0</span>], best_param)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>vol7_28_se <span class="op">=</span> model.smooth()</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>metrics_vol7_28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, vol7_28[<span class="dv">0</span>], vol7_28_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-67-output-1.png" width="738" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-67-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="0c6489b1" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_28[<span class="dv">1</span>], best_param)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>vol7_28_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_28[<span class="dv">2</span>], best_param)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>vol7_28_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>metrics_vol7_28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, vol7_28[<span class="dv">1</span>], vol7_28_se_val)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>metrics_vol7_28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, vol7_28[<span class="dv">2</span>], vol7_28_se_test)</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol7_28, metrics_vol7_28_val, metrics_vol7_28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>NaN</td>
<td>0.006238</td>
<td>0.025808</td>
<td>0.000666</td>
<td>0.842670</td>
<td>5.398223e-219</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>56.158278</td>
<td>0.025475</td>
<td>0.029637</td>
<td>0.000878</td>
<td>-4.649790</td>
<td>7.826934e-01</td>
<td>0.033274</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>15.058436</td>
<td>0.005253</td>
<td>0.007240</td>
<td>0.000052</td>
<td>0.662862</td>
<td>1.952917e-02</td>
<td>0.686641</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="013b9d0d" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol7_28[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol7_28[<span class="dv">1</span>], vol7_28[<span class="dv">2</span>], vol7_28_se, vol7_28_se_val, vol7_28_se_test)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol7_28.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="f373054e" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>metrics_vol7 <span class="op">=</span> pd.concat([</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    metrics_vol7_7, metrics_vol7_7_val, metrics_vol7_7_test,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    metrics_vol7_14, metrics_vol7_14_val, metrics_vol7_14_test,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    metrics_vol7_21, metrics_vol7_21_val, metrics_vol7_21_test,</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>    metrics_vol7_28, metrics_vol7_28_val, metrics_vol7_28_test</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="volatilidad-omega-14" class="level4">
<h4 class="anchored" data-anchor-id="volatilidad-omega-14">Volatilidad <span class="math inline">\(\omega = 14\)</span></h4>
<section id="tau-7-3" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-3"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="a0096d25" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(vol14_7[<span class="dv">0</span>], param)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>0.013117</td>
<td>0.040219</td>
<td>0.001618</td>
<td>0.590116</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>0.009063</td>
<td>0.030808</td>
<td>0.000949</td>
<td>0.759490</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>0.006962</td>
<td>0.025391</td>
<td>0.000645</td>
<td>0.836636</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>0.005679</td>
<td>0.022119</td>
<td>0.000489</td>
<td>0.876023</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>0.004826</td>
<td>0.020053</td>
<td>0.000402</td>
<td>0.898106</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>0.004227</td>
<td>0.018704</td>
<td>0.000350</td>
<td>0.911352</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>0.003787</td>
<td>0.017814</td>
<td>0.000317</td>
<td>0.919583</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>0.003459</td>
<td>0.017243</td>
<td>0.000297</td>
<td>0.924663</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>0.003213</td>
<td>0.016910</td>
<td>0.000286</td>
<td>0.927538</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="18ca840e" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-73-output-1.png" width="606" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="362cd734" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_7[<span class="dv">0</span>], best_param)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>vol14_7_se <span class="op">=</span> model.smooth()</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>metrics_vol14_7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, vol14_7[<span class="dv">0</span>], vol14_7_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-74-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-74-output-2.png" width="711" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="b6c08bfd" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_7[<span class="dv">1</span>], best_param)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>vol14_7_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_7[<span class="dv">2</span>], best_param)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>vol14_7_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>metrics_vol14_7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, vol14_7[<span class="dv">1</span>], vol14_7_se_val)</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>metrics_vol14_7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, vol14_7[<span class="dv">2</span>], vol14_7_se_test)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol14_7, metrics_vol14_7_val, metrics_vol14_7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>NaN</td>
<td>0.003213</td>
<td>0.016910</td>
<td>2.859626e-04</td>
<td>0.927538</td>
<td>3.661844e-46</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>31.829856</td>
<td>0.005188</td>
<td>0.005659</td>
<td>3.202489e-05</td>
<td>-113.279909</td>
<td>7.904339e-01</td>
<td>0.082897</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>2.433294</td>
<td>0.000401</td>
<td>0.000611</td>
<td>3.730931e-07</td>
<td>-0.331372</td>
<td>9.197661e-01</td>
<td>0.916042</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="2ce3cb92" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol14_7[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol14_7[<span class="dv">1</span>], vol14_7[<span class="dv">2</span>], vol14_7_se, vol14_7_se_val, vol14_7_se_test)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol14_7.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-3" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-3"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="69b05680" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_14[<span class="dv">0</span>], best_param)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>vol14_14_se <span class="op">=</span> model.smooth()</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>metrics_vol14_14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, vol14_14[<span class="dv">0</span>], vol14_14_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-78-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-78-output-2.png" width="711" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="a3b43120" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_14[<span class="dv">1</span>], best_param)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>vol14_14_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_14[<span class="dv">2</span>], best_param)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>vol14_14_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>metrics_vol14_14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, vol14_14[<span class="dv">1</span>], vol14_14_se_val)</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>metrics_vol14_14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, vol14_14[<span class="dv">2</span>], vol14_14_se_test)</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol14_14, metrics_vol14_14_val, metrics_vol14_14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>NaN</td>
<td>0.003213</td>
<td>0.016910</td>
<td>2.859626e-04</td>
<td>0.927538</td>
<td>3.661844e-46</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>17.921353</td>
<td>0.003009</td>
<td>0.003957</td>
<td>1.566023e-05</td>
<td>-47.451388</td>
<td>6.316147e-01</td>
<td>0.000001</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>2.844051</td>
<td>0.000477</td>
<td>0.000673</td>
<td>4.523776e-07</td>
<td>-0.399617</td>
<td>9.775644e-02</td>
<td>0.193811</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="aca30dbc" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol14_14[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol14_14[<span class="dv">1</span>], vol14_14[<span class="dv">2</span>], vol14_14_se, vol14_14_se_val, vol14_14_se_test)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol14_14.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-3" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-3"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="d0b13567" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_21[<span class="dv">0</span>], best_param)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>vol14_21_se <span class="op">=</span> model.smooth()</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>metrics_vol14_21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, vol14_21[<span class="dv">0</span>], vol14_21_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-82-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-82-output-2.png" width="711" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="ef8f4113" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_21[<span class="dv">1</span>], best_param)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>vol14_21_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_21[<span class="dv">2</span>], best_param)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>vol14_21_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>metrics_vol14_21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, vol14_21[<span class="dv">1</span>], vol14_21_se_val)</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>metrics_vol14_21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, vol14_21[<span class="dv">2</span>], vol14_21_se_test)</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol14_21, metrics_vol14_21_val, metrics_vol14_21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>NaN</td>
<td>0.003213</td>
<td>0.016910</td>
<td>0.000286</td>
<td>0.927538</td>
<td>3.661844e-46</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>42.080250</td>
<td>0.013563</td>
<td>0.016111</td>
<td>0.000260</td>
<td>-1.492731</td>
<td>7.237061e-01</td>
<td>3.961840e-18</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>5.559147</td>
<td>0.001618</td>
<td>0.002897</td>
<td>0.000008</td>
<td>0.919391</td>
<td>9.538744e-02</td>
<td>6.903126e-04</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="c66a2bb9" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol14_21[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol14_21[<span class="dv">1</span>], vol14_21[<span class="dv">2</span>], vol14_21_se, vol14_21_se_val, vol14_21_se_test)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol14_21.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-3" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-3"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="b564006b" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_28[<span class="dv">0</span>], best_param)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>vol14_28_se <span class="op">=</span> model.smooth()</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>metrics_vol14_28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, vol14_28[<span class="dv">0</span>], vol14_28_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-86-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-86-output-2.png" width="711" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="9b8ab7eb" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_28[<span class="dv">1</span>], best_param)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>vol14_28_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_28[<span class="dv">2</span>], best_param)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>vol14_28_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>metrics_vol14_28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, vol14_28[<span class="dv">1</span>], vol14_28_se_val)</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>metrics_vol14_28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, vol14_28[<span class="dv">2</span>], vol14_28_se_test)</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol14_28, metrics_vol14_28_val, metrics_vol14_28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>NaN</td>
<td>0.003213</td>
<td>0.016910</td>
<td>0.000286</td>
<td>0.927538</td>
<td>3.661844e-46</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>48.974542</td>
<td>0.019458</td>
<td>0.021177</td>
<td>0.000448</td>
<td>-8.941659</td>
<td>7.769108e-01</td>
<td>7.033859e-33</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>6.124939</td>
<td>0.002218</td>
<td>0.003413</td>
<td>0.000012</td>
<td>0.741739</td>
<td>8.302782e-02</td>
<td>4.251965e-01</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="ef2169ac" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol14_28[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol14_28[<span class="dv">1</span>], vol14_28[<span class="dv">2</span>], vol14_28_se, vol14_28_se_val, vol14_28_se_test)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol14_28.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="3fc47725" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>metrics_vol14 <span class="op">=</span> pd.concat([</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>    metrics_vol14_7, metrics_vol14_7_val, metrics_vol14_7_test,</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>    metrics_vol14_14, metrics_vol14_14_val, metrics_vol14_14_test,</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>    metrics_vol14_21, metrics_vol14_21_val, metrics_vol14_21_test,</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>    metrics_vol14_28, metrics_vol14_28_val, metrics_vol14_28_test</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="volatilidad-omega-21" class="level4">
<h4 class="anchored" data-anchor-id="volatilidad-omega-21">Volatilidad <span class="math inline">\(\omega = 21\)</span></h4>
<section id="tau-7-4" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-4"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="9a2a5b94" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(vol21_7[<span class="dv">0</span>], param)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="90">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>0.010916</td>
<td>0.034353</td>
<td>0.001180</td>
<td>0.689858</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>0.006902</td>
<td>0.024920</td>
<td>0.000621</td>
<td>0.836804</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>0.005065</td>
<td>0.020224</td>
<td>0.000409</td>
<td>0.892515</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>0.004044</td>
<td>0.017568</td>
<td>0.000309</td>
<td>0.918895</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>0.003409</td>
<td>0.015927</td>
<td>0.000254</td>
<td>0.933338</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>0.002965</td>
<td>0.014864</td>
<td>0.000221</td>
<td>0.941938</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>0.002642</td>
<td>0.014166</td>
<td>0.000201</td>
<td>0.947262</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>0.002399</td>
<td>0.013719</td>
<td>0.000188</td>
<td>0.950536</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>0.002215</td>
<td>0.013461</td>
<td>0.000181</td>
<td>0.952378</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="ab5a709e" class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-92-output-1.png" width="606" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="e19e4859" class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_7[<span class="dv">0</span>], best_param)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>vol21_7_se <span class="op">=</span> model.smooth()</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>metrics_vol21_7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, vol21_7[<span class="dv">0</span>], vol21_7_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-93-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-93-output-2.png" width="728" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="570e922b" class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_7[<span class="dv">1</span>], best_param)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>vol21_7_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_7[<span class="dv">2</span>], best_param)</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>vol21_7_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>metrics_vol21_7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, vol21_7[<span class="dv">1</span>], vol21_7_se_val)</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>metrics_vol21_7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, vol21_7[<span class="dv">2</span>], vol21_7_se_test)</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol21_7, metrics_vol21_7_val, metrics_vol21_7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="93">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>NaN</td>
<td>0.002215</td>
<td>0.013461</td>
<td>1.812115e-04</td>
<td>0.952378</td>
<td>3.427794e-46</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>20.487936</td>
<td>0.004030</td>
<td>0.005142</td>
<td>2.643715e-05</td>
<td>-77.322445</td>
<td>9.767082e-01</td>
<td>0.063760</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>2.902855</td>
<td>0.000574</td>
<td>0.000807</td>
<td>6.517640e-07</td>
<td>-0.930910</td>
<td>4.601006e-01</td>
<td>0.973017</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="5b7e2c62" class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol21_7[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol21_7[<span class="dv">1</span>], vol21_7[<span class="dv">2</span>], vol21_7_se, vol21_7_se_val, vol21_7_se_test)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol21_7.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-4" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-4"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="1b1d4463" class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_14[<span class="dv">0</span>], best_param)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>vol21_14_se <span class="op">=</span> model.smooth()</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>metrics_vol21_14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, vol21_14[<span class="dv">0</span>], vol21_14_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-97-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-97-output-2.png" width="728" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="cf3f088c" class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_14[<span class="dv">1</span>], best_param)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>vol21_14_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_14[<span class="dv">2</span>], best_param)</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>vol21_14_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>metrics_vol21_14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, vol21_14[<span class="dv">1</span>], vol21_14_se_val)</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>metrics_vol21_14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, vol21_14[<span class="dv">2</span>], vol21_14_se_test)</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol21_14, metrics_vol21_14_val, metrics_vol21_14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="97">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>NaN</td>
<td>0.002215</td>
<td>0.013461</td>
<td>1.812115e-04</td>
<td>0.952378</td>
<td>3.427794e-46</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>29.520160</td>
<td>0.004966</td>
<td>0.005738</td>
<td>3.292506e-05</td>
<td>-73.852531</td>
<td>9.018475e-01</td>
<td>6.075171e-08</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>2.824281</td>
<td>0.000473</td>
<td>0.000665</td>
<td>4.424062e-07</td>
<td>-0.005776</td>
<td>3.931241e-01</td>
<td>3.397258e-01</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="51c42dd8" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol21_14[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol21_14[<span class="dv">1</span>], vol21_14[<span class="dv">2</span>], vol21_14_se, vol21_14_se_val, vol21_14_se_test)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol21_14.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-4" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-4"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="a554d332" class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_21[<span class="dv">0</span>], best_param)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>vol21_21_se <span class="op">=</span> model.smooth()</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>metrics_vol21_21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, vol21_21[<span class="dv">0</span>], vol21_21_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-101-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-101-output-2.png" width="728" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="8cfb321e" class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_21[<span class="dv">1</span>], best_param)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>vol21_21_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_21[<span class="dv">2</span>], best_param)</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>vol21_21_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>metrics_vol21_21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, vol21_21[<span class="dv">1</span>], vol21_21_se_val)</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>metrics_vol21_21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, vol21_21[<span class="dv">2</span>], vol21_21_se_test)</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol21_21, metrics_vol21_21_val, metrics_vol21_21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="101">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>NaN</td>
<td>0.002215</td>
<td>0.013461</td>
<td>0.000181</td>
<td>0.952378</td>
<td>3.427794e-46</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>38.079290</td>
<td>0.010021</td>
<td>0.011686</td>
<td>0.000137</td>
<td>-1.198899</td>
<td>4.569950e-01</td>
<td>5.726914e-07</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>4.595185</td>
<td>0.001179</td>
<td>0.002118</td>
<td>0.000004</td>
<td>0.927733</td>
<td>1.123216e-01</td>
<td>5.485603e-04</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="7ee30aed" class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol21_21[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol21_21[<span class="dv">1</span>], vol21_21[<span class="dv">2</span>], vol21_21_se, vol21_21_se_val, vol21_21_se_test)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol21_21.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-4" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-4"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="a5e1a596" class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_28[<span class="dv">0</span>], best_param)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>vol21_28_se <span class="op">=</span> model.smooth()</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>metrics_vol21_28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, vol21_28[<span class="dv">0</span>], vol21_28_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-105-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-105-output-2.png" width="728" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="fb01d10b" class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_28[<span class="dv">1</span>], best_param)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>vol21_28_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_28[<span class="dv">2</span>], best_param)</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>vol21_28_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>metrics_vol21_28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, vol21_28[<span class="dv">1</span>], vol21_28_se_val)</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>metrics_vol21_28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, vol21_28[<span class="dv">2</span>], vol21_28_se_test)</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol21_28, metrics_vol21_28_val, metrics_vol21_28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="105">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>NaN</td>
<td>0.002215</td>
<td>0.013461</td>
<td>0.000181</td>
<td>0.952378</td>
<td>3.427794e-46</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>42.779302</td>
<td>0.016402</td>
<td>0.018792</td>
<td>0.000353</td>
<td>-5.889967</td>
<td>5.193451e-01</td>
<td>5.208990e-17</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>3.613422</td>
<td>0.001193</td>
<td>0.002050</td>
<td>0.000004</td>
<td>0.917982</td>
<td>4.577967e-01</td>
<td>7.541113e-05</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="26766bf0" class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol21_28[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol21_28[<span class="dv">1</span>], vol21_28[<span class="dv">2</span>], vol21_28_se, vol21_28_se_val, vol21_28_se_test)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol21_28.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="88ca5ae7" class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>metrics_vol21 <span class="op">=</span> pd.concat([</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>    metrics_vol21_7, metrics_vol21_7_val, metrics_vol21_7_test,</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>    metrics_vol21_14, metrics_vol21_14_val, metrics_vol21_14_test,</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>    metrics_vol21_21, metrics_vol21_21_val, metrics_vol21_21_test,</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>    metrics_vol21_28, metrics_vol21_28_val, metrics_vol21_28_test</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="volatilidad-omega-28" class="level4">
<h4 class="anchored" data-anchor-id="volatilidad-omega-28">Volatilidad <span class="math inline">\(\omega = 28\)</span></h4>
<section id="tau-7-5" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-5"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="6c975f6a" class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(vol28_7[<span class="dv">0</span>], param)</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="109">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>0.009313</td>
<td>0.030121</td>
<td>0.000907</td>
<td>0.754956</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>0.005598</td>
<td>0.021227</td>
<td>0.000451</td>
<td>0.878301</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>0.004076</td>
<td>0.017158</td>
<td>0.000294</td>
<td>0.920488</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>0.003240</td>
<td>0.014906</td>
<td>0.000222</td>
<td>0.939987</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>0.002708</td>
<td>0.013524</td>
<td>0.000183</td>
<td>0.950601</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>0.002343</td>
<td>0.012632</td>
<td>0.000160</td>
<td>0.956901</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>0.002078</td>
<td>0.012050</td>
<td>0.000145</td>
<td>0.960784</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>0.001880</td>
<td>0.011680</td>
<td>0.000136</td>
<td>0.963152</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>0.001729</td>
<td>0.011472</td>
<td>0.000132</td>
<td>0.964457</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="c33c05bc" class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-111-output-1.png" width="606" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="5b66c663" class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_7[<span class="dv">0</span>], best_param)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>vol28_7_se <span class="op">=</span> model.smooth()</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>metrics_vol28_7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, vol28_7[<span class="dv">0</span>], vol28_7_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-112-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-112-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="83d346f4" class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_7[<span class="dv">1</span>], best_param)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>vol28_7_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_7[<span class="dv">2</span>], best_param)</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>vol28_7_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>metrics_vol28_7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, vol28_7[<span class="dv">1</span>], vol28_7_se_val)</span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>metrics_vol28_7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, vol28_7[<span class="dv">2</span>], vol28_7_se_test)</span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol28_7, metrics_vol28_7_val, metrics_vol28_7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="112">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>NaN</td>
<td>0.001729</td>
<td>0.011472</td>
<td>0.000132</td>
<td>0.964457</td>
<td>2.080088e-42</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>22.776284</td>
<td>0.004897</td>
<td>0.005409</td>
<td>0.000029</td>
<td>-9.049319</td>
<td>4.853045e-01</td>
<td>0.363816</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>4.049157</td>
<td>0.000847</td>
<td>0.001453</td>
<td>0.000002</td>
<td>0.274886</td>
<td>9.865148e-01</td>
<td>0.180878</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="2a1fb42d" class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol28_7[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol28_7[<span class="dv">1</span>], vol28_7[<span class="dv">2</span>], vol28_7_se, vol28_7_se_val, vol28_7_se_test)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol28_7.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-5" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-5"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="60999695" class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_14[<span class="dv">0</span>], best_param)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>vol28_14_se <span class="op">=</span> model.smooth()</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>metrics_vol28_14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, vol28_14[<span class="dv">0</span>], vol28_14_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-116-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-116-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="d9617c4f" class="cell" data-execution_count="116">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_14[<span class="dv">1</span>], best_param)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>vol28_14_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_14[<span class="dv">2</span>], best_param)</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>vol28_14_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>metrics_vol28_14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, vol28_14[<span class="dv">1</span>], vol28_14_se_val)</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>metrics_vol28_14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, vol28_14[<span class="dv">2</span>], vol28_14_se_test)</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol28_14, metrics_vol28_14_val, metrics_vol28_14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="116">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>NaN</td>
<td>0.001729</td>
<td>0.011472</td>
<td>0.000132</td>
<td>0.964457</td>
<td>2.080088e-42</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>36.666901</td>
<td>0.006637</td>
<td>0.007027</td>
<td>0.000049</td>
<td>-12.781781</td>
<td>3.199223e-01</td>
<td>0.055452</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>3.334943</td>
<td>0.000588</td>
<td>0.001032</td>
<td>0.000001</td>
<td>0.702910</td>
<td>1.836634e-01</td>
<td>0.006907</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="281400fa" class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol28_14[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol28_14[<span class="dv">1</span>], vol28_14[<span class="dv">2</span>], vol28_14_se, vol28_14_se_val, vol28_14_se_test)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol28_14.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-5" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-5"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="f33c9330" class="cell" data-execution_count="119">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_21[<span class="dv">0</span>], best_param)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>vol28_21_se <span class="op">=</span> model.smooth()</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>metrics_vol28_21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, vol28_21[<span class="dv">0</span>], vol28_21_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-120-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-120-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="bfce2817" class="cell" data-execution_count="120">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_21[<span class="dv">1</span>], best_param)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>vol28_21_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_21[<span class="dv">2</span>], best_param)</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>vol28_21_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>metrics_vol28_21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, vol28_21[<span class="dv">1</span>], vol28_21_se_val)</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>metrics_vol28_21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, vol28_21[<span class="dv">2</span>], vol28_21_se_test)</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol28_21, metrics_vol28_21_val, metrics_vol28_21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="120">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>NaN</td>
<td>0.001729</td>
<td>0.011472</td>
<td>0.000132</td>
<td>0.964457</td>
<td>2.080088e-42</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>37.235382</td>
<td>0.008127</td>
<td>0.009179</td>
<td>0.000084</td>
<td>-1.115749</td>
<td>1.548663e-01</td>
<td>0.000681</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>4.143860</td>
<td>0.000994</td>
<td>0.001802</td>
<td>0.000003</td>
<td>0.918428</td>
<td>1.884342e-01</td>
<td>0.000639</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="1e4acab5" class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol28_21[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol28_21[<span class="dv">1</span>], vol28_21[<span class="dv">2</span>], vol28_21_se, vol28_21_se_val, vol28_21_se_test)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol28_21.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-5" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-5"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="33e2de2c" class="cell" data-execution_count="123">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_28[<span class="dv">0</span>], best_param)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>vol28_28_se <span class="op">=</span> model.smooth()</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>metrics_vol28_28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, vol28_28[<span class="dv">0</span>], vol28_28_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-124-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-124-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="c54d4b9a" class="cell" data-execution_count="124">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_28[<span class="dv">1</span>], best_param)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>vol28_28_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_28[<span class="dv">2</span>], best_param)</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>vol28_28_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>metrics_vol28_28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, vol28_28[<span class="dv">1</span>], vol28_28_se_val)</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>metrics_vol28_28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, vol28_28[<span class="dv">2</span>], vol28_28_se_test)</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol28_28, metrics_vol28_28_val, metrics_vol28_28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="124">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>NaN</td>
<td>0.001729</td>
<td>0.011472</td>
<td>0.000132</td>
<td>0.964457</td>
<td>2.080088e-42</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>34.594749</td>
<td>0.012416</td>
<td>0.015259</td>
<td>0.000233</td>
<td>-3.315288</td>
<td>9.806432e-03</td>
<td>0.000266</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>3.738236</td>
<td>0.001167</td>
<td>0.001900</td>
<td>0.000004</td>
<td>0.933102</td>
<td>1.810440e-01</td>
<td>0.003661</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="3125bb1f" class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol28_28[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol28_28[<span class="dv">1</span>], vol28_28[<span class="dv">2</span>], vol28_28_se, vol28_28_se_val, vol28_28_se_test)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol28_28.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="09bb1578" class="cell" data-execution_count="127">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>metrics_vol28 <span class="op">=</span> pd.concat([</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>    metrics_vol28_7, metrics_vol28_7_val, metrics_vol28_7_test,</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>    metrics_vol28_14, metrics_vol28_14_val, metrics_vol28_14_test,</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>    metrics_vol28_21, metrics_vol28_21_val, metrics_vol28_21_test,</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>    metrics_vol28_28, metrics_vol28_28_val, metrics_vol28_28_test</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="caso-doble-sin-librería" class="level3">
<h3 class="anchored" data-anchor-id="caso-doble-sin-librería">Caso doble sin librería</h3>
<section id="price-1" class="level4">
<h4 class="anchored" data-anchor-id="price-1">Price</h4>
<section id="tau-7-6" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-6"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="a839934e" class="cell" data-execution_count="128">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(price7_se, param)</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="128">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.045131</td>
<td>669.388624</td>
<td>1529.357614</td>
<td>2.338935e+06</td>
<td>0.989828</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>5.536273</td>
<td>456.978816</td>
<td>1078.011744</td>
<td>1.162109e+06</td>
<td>0.994946</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4.475046</td>
<td>374.166563</td>
<td>888.816295</td>
<td>7.899944e+05</td>
<td>0.996564</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3.877030</td>
<td>326.568147</td>
<td>781.476255</td>
<td>6.107051e+05</td>
<td>0.997344</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3.489181</td>
<td>294.898951</td>
<td>712.982225</td>
<td>5.083437e+05</td>
<td>0.997789</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>3.219411</td>
<td>271.905114</td>
<td>666.763782</td>
<td>4.445739e+05</td>
<td>0.998067</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>3.027411</td>
<td>255.515647</td>
<td>634.968296</td>
<td>4.031847e+05</td>
<td>0.998247</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2.890954</td>
<td>243.801900</td>
<td>613.422621</td>
<td>3.762873e+05</td>
<td>0.998364</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>2.793634</td>
<td>236.131931</td>
<td>599.793220</td>
<td>3.597519e+05</td>
<td>0.998435</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="c19be200" class="cell" data-execution_count="129">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-130-output-1.png" width="593" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="8feef41e" class="cell" data-execution_count="130">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price7_se, best_param)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>price7_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>metrics_price7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, price7_se, price7_se2, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-131-output-1.png" width="726" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-131-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="efef0b9e" class="cell" data-execution_count="131">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price7_se_val, best_param)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>price7_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price7_se_test, best_param)</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>price7_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>metrics_price7_val_ <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, price7_se_val, price7_se_val2)</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>metrics_price7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, price7_se_test, price7_se_test2)</span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_price7, metrics_price7_val, metrics_price7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="131">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>2.793634</td>
<td>236.131931</td>
<td>599.793220</td>
<td>3.597519e+05</td>
<td>0.998435</td>
<td>3.340594e-36</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>5.515992</td>
<td>2595.563591</td>
<td>3259.226089</td>
<td>1.062255e+07</td>
<td>-1.436019</td>
<td>3.537907e-01</td>
<td>0.713997</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>1.880853</td>
<td>866.113474</td>
<td>1032.913565</td>
<td>1.066910e+06</td>
<td>0.749018</td>
<td>2.900096e-01</td>
<td>0.914023</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="8bb90f63" class="cell" data-execution_count="132">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(price7_se[<span class="op">-</span><span class="dv">500</span>:], price7_se_val, price7_se_test, price7_se2, price7_se_val2, price7_se_test2)</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_price7_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-6" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-6"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="f0d90ac3" class="cell" data-execution_count="134">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price14_se, best_param)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>price14_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>metrics_price14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, price14_se, price14_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-135-output-1.png" width="726" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-135-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="2e5725e2" class="cell" data-execution_count="135">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price14_se_val, best_param)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>price14_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price14_se_test, best_param)</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>price14_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>metrics_price14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, price14_se_val, price14_se_val2)</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>metrics_price14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, price14_se_test, price14_se_test2)</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_price14, metrics_price14_val, metrics_price14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="135">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>2.793634</td>
<td>236.131931</td>
<td>599.793220</td>
<td>3.597519e+05</td>
<td>0.998435</td>
<td>3.340594e-36</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>13.879273</td>
<td>7166.514862</td>
<td>7633.896707</td>
<td>5.827638e+07</td>
<td>-105.162620</td>
<td>4.163556e-03</td>
<td>0.550624</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>0.897345</td>
<td>462.661103</td>
<td>618.859887</td>
<td>3.829876e+05</td>
<td>0.302308</td>
<td>2.892078e-01</td>
<td>0.066354</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="6751fe41" class="cell" data-execution_count="136">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(price14_se[<span class="op">-</span><span class="dv">500</span>:], price14_se_val, price14_se_test, price14_se2, price14_se_val2, price14_se_test2)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_price14_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-6" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-6"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="3000c1df" class="cell" data-execution_count="138">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price21_se, best_param)</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>price21_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>metrics_price21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, price21_se, price21_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-139-output-1.png" width="726" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-139-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="3b23106c" class="cell" data-execution_count="139">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price21_se_val, best_param)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>price21_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price21_se_test, best_param)</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>price21_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>metrics_price21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, price21_se_val, price21_se_val2)</span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>metrics_price21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, price21_se_test, price21_se_test2)</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_price21, metrics_price21_val, metrics_price21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="139">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>2.793634</td>
<td>236.131931</td>
<td>599.793220</td>
<td>3.597519e+05</td>
<td>0.998435</td>
<td>3.340594e-36</td>
<td>0.00000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>21.552227</td>
<td>13155.722231</td>
<td>13983.888897</td>
<td>1.955491e+08</td>
<td>-3.416158</td>
<td>3.472683e-03</td>
<td>0.38113</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>2.214729</td>
<td>1359.353803</td>
<td>2014.121606</td>
<td>4.056686e+06</td>
<td>0.908386</td>
<td>8.888633e-01</td>
<td>0.20822</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="eff20a05" class="cell" data-execution_count="140">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(price21_se[<span class="op">-</span><span class="dv">500</span>:], price21_se_val, price21_se_test, price21_se2, price21_se_val2, price21_se_test2)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_price21_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-6" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-6"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="e0a92a7c" class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price28_se, best_param)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>price28_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>metrics_price28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, price28_se, price28_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-143-output-1.png" width="726" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-143-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="717ab338" class="cell" data-execution_count="143">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price28_se_val, best_param)</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>price28_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price28_se_test, best_param)</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>price28_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>metrics_price28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, price28_se_val, price28_se_val2)</span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>metrics_price28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, price28_se_test, price28_se_test2)</span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_price28, metrics_price28_val, metrics_price28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="143">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>2.793634</td>
<td>236.131931</td>
<td>599.793220</td>
<td>3.597519e+05</td>
<td>0.998435</td>
<td>3.340594e-36</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>26.935401</td>
<td>17869.336011</td>
<td>18604.732800</td>
<td>3.461361e+08</td>
<td>-18.263227</td>
<td>7.163089e-05</td>
<td>0.235948</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>2.826882</td>
<td>1854.230239</td>
<td>2444.620007</td>
<td>5.976167e+06</td>
<td>0.667413</td>
<td>8.427913e-01</td>
<td>0.936190</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="52b4662a" class="cell" data-execution_count="144">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(price28_se[<span class="op">-</span><span class="dv">500</span>:], price28_se_val, price28_se_test, price28_se2, price28_se_val2, price28_se_test2)</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_price28_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="c0403887" class="cell" data-execution_count="146">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>metrics_price_d <span class="op">=</span> pd.concat([</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>    metrics_price7, metrics_price7_val, metrics_price7_test,</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>    metrics_price14, metrics_price14_val, metrics_price14_test,</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>    metrics_price21, metrics_price21_val, metrics_price21_test,</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>    metrics_price28, metrics_price28_val, metrics_price28_test</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="retorno-acumulado-1" class="level4">
<h4 class="anchored" data-anchor-id="retorno-acumulado-1">Retorno acumulado</h4>
<section id="tau-7-7" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-7"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="2412266f" class="cell" data-execution_count="147">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(A_t7[<span class="dv">0</span>], param)</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="147">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>0.093896</td>
<td>0.183250</td>
<td>0.033581</td>
<td>0.999102</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>0.061176</td>
<td>0.127675</td>
<td>0.016301</td>
<td>0.999564</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>0.048750</td>
<td>0.105511</td>
<td>0.011132</td>
<td>0.999702</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>0.042050</td>
<td>0.093687</td>
<td>0.008777</td>
<td>0.999765</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>0.037878</td>
<td>0.086676</td>
<td>0.007513</td>
<td>0.999799</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>0.035097</td>
<td>0.082335</td>
<td>0.006779</td>
<td>0.999819</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>0.033219</td>
<td>0.079635</td>
<td>0.006342</td>
<td>0.999830</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>0.031947</td>
<td>0.078023</td>
<td>0.006088</td>
<td>0.999837</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>0.031174</td>
<td>0.077196</td>
<td>0.005959</td>
<td>0.999841</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="1f033ebe" class="cell" data-execution_count="148">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-149-output-1.png" width="597" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="79b029d4" class="cell" data-execution_count="149">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t7_se, best_param)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>A_t7_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>metrics_A_t7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, A_t7_se, A_t7_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-150-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-150-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="6a7f7029" class="cell" data-execution_count="150">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t7_se_val, best_param)</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>A_t7_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t7_se_test, best_param)</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>A_t7_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>metrics_A_t7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, A_t7_se_val, A_t7_se_val2)</span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>metrics_A_t7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, A_t7_se_test, A_t7_se_test2)</span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_A_t7, metrics_A_t7_val, metrics_A_t7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="150">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>NaN</td>
<td>0.028736</td>
<td>0.070272</td>
<td>0.004938</td>
<td>0.999868</td>
<td>1.629383e-71</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>0.243336</td>
<td>0.056755</td>
<td>0.071366</td>
<td>0.005093</td>
<td>-1.400565</td>
<td>2.949738e-01</td>
<td>0.726934</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>0.083004</td>
<td>0.019342</td>
<td>0.023081</td>
<td>0.000533</td>
<td>0.748906</td>
<td>2.762726e-01</td>
<td>0.897414</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="e1e1f0dd" class="cell" data-execution_count="151">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(A_t7_se[<span class="op">-</span><span class="dv">500</span>:], A_t7_se_val, A_t7_se_test, A_t7_se2, A_t7_se_val2, A_t7_se_test2)</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_A_t7_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-7" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-7"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="1fa31d62" class="cell" data-execution_count="153">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t14_se, best_param)</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>A_t14_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>metrics_A_t14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, A_t14_se, A_t14_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-154-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-154-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="8c97e433" class="cell" data-execution_count="154">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t14_se_val, best_param)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>A_t14_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t14_se_test, best_param)</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>A_t14_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>metrics_A_t14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, A_t14_se_val, A_t14_se_val2)</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>metrics_A_t14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, A_t14_se_test, A_t14_se_test2)</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_A_t14, metrics_A_t14_val, metrics_A_t14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="154">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>NaN</td>
<td>0.028736</td>
<td>0.070272</td>
<td>0.004938</td>
<td>0.999868</td>
<td>1.629383e-71</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>0.656525</td>
<td>0.153759</td>
<td>0.164007</td>
<td>0.026898</td>
<td>-121.349253</td>
<td>5.357212e-03</td>
<td>0.566548</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>0.038828</td>
<td>0.009093</td>
<td>0.012303</td>
<td>0.000151</td>
<td>0.311457</td>
<td>3.092052e-01</td>
<td>0.044403</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="b623d573" class="cell" data-execution_count="155">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(A_t14_se[<span class="op">-</span><span class="dv">500</span>:], A_t14_se_val, A_t14_se_test, A_t14_se2, A_t14_se_val2, A_t14_se_test2)</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_A_t14_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-7" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-7"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="43665a78" class="cell" data-execution_count="157">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t21_se, best_param)</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>A_t21_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>metrics_A_t21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, A_t21_se, A_t21_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-158-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-158-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="6360f2d9" class="cell" data-execution_count="158">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t21_se_val, best_param)</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>A_t21_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t21_se_test, best_param)</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>A_t21_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>metrics_A_t21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, A_t21_se_val, A_t21_se_val2)</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>metrics_A_t21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, A_t21_se_test, A_t21_se_test2)</span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_A_t21, metrics_A_t21_val, metrics_A_t21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="158">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>NaN</td>
<td>0.028736</td>
<td>0.070272</td>
<td>0.004938</td>
<td>0.999868</td>
<td>1.629383e-71</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>1.077922</td>
<td>0.254305</td>
<td>0.267282</td>
<td>0.071440</td>
<td>-4.117570</td>
<td>1.966422e-03</td>
<td>0.404310</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>0.097026</td>
<td>0.022894</td>
<td>0.034064</td>
<td>0.001160</td>
<td>0.916878</td>
<td>8.745393e-01</td>
<td>0.139848</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="f89d5439" class="cell" data-execution_count="159">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(A_t21_se[<span class="op">-</span><span class="dv">500</span>:], A_t21_se_val, A_t21_se_test, A_t21_se2, A_t21_se_val2, A_t21_se_test2)</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_A_t21_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-7" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-7"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="f8d907ad" class="cell" data-execution_count="161">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t28_se, best_param)</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>A_t28_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>metrics_A_t28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, A_t28_se, A_t28_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-162-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-162-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="82e78f16" class="cell" data-execution_count="162">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t28_se_val, best_param)</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>A_t28_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t28_se_test, best_param)</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>A_t28_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>metrics_A_t28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, A_t28_se_val, A_t28_se_val2)</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>metrics_A_t28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, A_t28_se_test, A_t28_se_test2)</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_A_t28, metrics_A_t28_val, metrics_A_t28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="162">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>NaN</td>
<td>0.028736</td>
<td>0.070272</td>
<td>0.004938</td>
<td>0.999868</td>
<td>1.629383e-71</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>1.414642</td>
<td>0.335046</td>
<td>0.348306</td>
<td>0.121317</td>
<td>-23.919565</td>
<td>4.212720e-05</td>
<td>0.219773</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>0.121057</td>
<td>0.028659</td>
<td>0.038435</td>
<td>0.001477</td>
<td>0.696563</td>
<td>8.993733e-01</td>
<td>0.975459</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="daa1d42f" class="cell" data-execution_count="163">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(A_t28_se[<span class="op">-</span><span class="dv">500</span>:], A_t28_se_val, A_t28_se_test, A_t28_se2, A_t28_se_val2, A_t28_se_test2)</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_A_t28_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="a7ca3383" class="cell" data-execution_count="165">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>metrics_A_t_d <span class="op">=</span> pd.concat([</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>    metrics_A_t7, metrics_A_t7_val, metrics_A_t7_test,</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>    metrics_A_t14, metrics_A_t14_val, metrics_A_t14_test,</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>    metrics_A_t21, metrics_A_t21_val, metrics_A_t21_test,</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>    metrics_A_t28, metrics_A_t28_val, metrics_A_t28_test</span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="volatilidad-omega-7-1" class="level4">
<h4 class="anchored" data-anchor-id="volatilidad-omega-7-1">Volatilidad <span class="math inline">\(\omega = 7\)</span></h4>
<section id="tau-7-8" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-8"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="cf332b33" class="cell" data-execution_count="166">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(vol7_7_se, param)</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="166">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>0.017234</td>
<td>0.048916</td>
<td>0.002393</td>
<td>0.425776</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>0.014061</td>
<td>0.041230</td>
<td>0.001700</td>
<td>0.592065</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>0.011750</td>
<td>0.035770</td>
<td>0.001279</td>
<td>0.692948</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>0.010017</td>
<td>0.031828</td>
<td>0.001013</td>
<td>0.756894</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>0.008745</td>
<td>0.028969</td>
<td>0.000839</td>
<td>0.798603</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>0.007781</td>
<td>0.026898</td>
<td>0.000724</td>
<td>0.826372</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>0.007036</td>
<td>0.025408</td>
<td>0.000646</td>
<td>0.845080</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>0.006448</td>
<td>0.024355</td>
<td>0.000593</td>
<td>0.857648</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>0.005980</td>
<td>0.023647</td>
<td>0.000559</td>
<td>0.865810</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="ef0ef589" class="cell" data-execution_count="167">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-168-output-1.png" width="606" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="2948dc4f" class="cell" data-execution_count="168">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_7_se, best_param)</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>vol7_7_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>metrics_vol7_7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, vol7_7_se, vol7_7_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-169-output-1.png" width="738" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-169-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="5f468448" class="cell" data-execution_count="169">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_7_se_val, best_param)</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>vol7_7_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_7_se_test, best_param)</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>vol7_7_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>metrics_vol7_7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, vol7_7_se_val, vol7_7_se_val2)</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>metrics_vol7_7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, vol7_7_se_test, vol7_7_se_test2)</span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol7_7, metrics_vol7_7_val, metrics_vol7_7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="169">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>NaN</td>
<td>0.005980</td>
<td>0.023647</td>
<td>0.000559</td>
<td>0.865810</td>
<td>1.301410e-268</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>39.131154</td>
<td>0.004442</td>
<td>0.005800</td>
<td>0.000034</td>
<td>-1.681537</td>
<td>7.546915e-01</td>
<td>0.182257</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>14.913519</td>
<td>0.002094</td>
<td>0.002700</td>
<td>0.000007</td>
<td>0.418664</td>
<td>5.304739e-01</td>
<td>0.880066</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="a4c2b147" class="cell" data-execution_count="170">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol7_7_se[<span class="op">-</span><span class="dv">500</span>:], vol7_7_se_val, vol7_7_se_test, vol7_7_se2, vol7_7_se_val2, vol7_7_se_test2)</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol7_7_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-8" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-8"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="0429dfe7" class="cell" data-execution_count="172">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_14_se, best_param)</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>vol7_14_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>metrics_vol7_14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, vol7_14_se, vol7_14_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-173-output-1.png" width="738" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-173-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="c5ec656b" class="cell" data-execution_count="173">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_14_se_val, best_param)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>vol7_14_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_14_se_test, best_param)</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>vol7_14_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>metrics_vol7_14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, vol7_14_se_val, vol7_14_se_val2)</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>metrics_vol7_14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, vol7_14_se_test, vol7_14_se_test2)</span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol7_14, metrics_vol7_14_val, metrics_vol7_14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="173">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>NaN</td>
<td>0.005980</td>
<td>0.023647</td>
<td>0.000559</td>
<td>0.865810</td>
<td>1.301410e-268</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>27.809711</td>
<td>0.003799</td>
<td>0.004325</td>
<td>0.000019</td>
<td>-0.214463</td>
<td>4.295016e-01</td>
<td>0.652980</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>14.072095</td>
<td>0.001731</td>
<td>0.002604</td>
<td>0.000007</td>
<td>0.559776</td>
<td>6.193442e-01</td>
<td>0.000996</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="1e07732e" class="cell" data-execution_count="174">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol7_14_se[<span class="op">-</span><span class="dv">500</span>:], vol7_14_se_val, vol7_14_se_test, vol7_14_se2, vol7_14_se_val2, vol7_14_se_test2)</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol7_14_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-8" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-8"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="b865acaa" class="cell" data-execution_count="176">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_21_se, best_param)</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>vol7_21_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>metrics_vol7_21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, vol7_21_se, vol7_21_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-177-output-1.png" width="738" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-177-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="bb072663" class="cell" data-execution_count="177">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_21_se_val, best_param)</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>vol7_21_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_21_se_test, best_param)</span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>vol7_21_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>metrics_vol7_21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, vol7_21_se_val, vol7_21_se_val2)</span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>metrics_vol7_21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, vol7_21_se_test, vol7_21_se_test2)</span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol7_21, metrics_vol7_21_val, metrics_vol7_21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="177">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>NaN</td>
<td>0.005980</td>
<td>0.023647</td>
<td>0.000559</td>
<td>0.865810</td>
<td>1.301410e-268</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>64.193928</td>
<td>0.019320</td>
<td>0.022442</td>
<td>0.000504</td>
<td>-1.211611</td>
<td>8.771825e-01</td>
<td>0.232819</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>14.464250</td>
<td>0.003616</td>
<td>0.005397</td>
<td>0.000029</td>
<td>0.872078</td>
<td>7.713427e-01</td>
<td>0.456959</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="425f8964" class="cell" data-execution_count="178">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol7_21_se[<span class="op">-</span><span class="dv">500</span>:], vol7_21_se_val, vol7_21_se_test, vol7_21_se2, vol7_21_se_val2, vol7_21_se_test2)</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol7_21_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-8" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-8"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="4fea0c98" class="cell" data-execution_count="180">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_28_se, best_param)</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>vol7_28_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>metrics_vol7_28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, vol7_28_se, vol7_28_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-181-output-1.png" width="738" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-181-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="758f5d0d" class="cell" data-execution_count="181">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_28_se_val, best_param)</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>vol7_28_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_28_se_test, best_param)</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>vol7_28_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>metrics_vol7_28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, vol7_28_se_val, vol7_28_se_val2)</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>metrics_vol7_28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, vol7_28_se_test, vol7_28_se_test2)</span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol7_28, metrics_vol7_28_val, metrics_vol7_28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="181">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>NaN</td>
<td>0.005980</td>
<td>0.023647</td>
<td>0.000559</td>
<td>0.865810</td>
<td>1.301410e-268</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>56.137852</td>
<td>0.025307</td>
<td>0.029381</td>
<td>0.000863</td>
<td>-4.741277</td>
<td>6.406643e-01</td>
<td>0.055422</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>14.127762</td>
<td>0.004961</td>
<td>0.006745</td>
<td>0.000045</td>
<td>0.697439</td>
<td>9.614044e-03</td>
<td>0.631850</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="c97f6fa6" class="cell" data-execution_count="182">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol7_28_se[<span class="op">-</span><span class="dv">500</span>:], vol7_28_se_val, vol7_28_se_test, vol7_28_se2, vol7_28_se_val2, vol7_28_se_test2)</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol7_28_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="cebf3e62" class="cell" data-execution_count="184">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>metrics_vol7_d <span class="op">=</span> pd.concat([</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>    metrics_vol7_7, metrics_vol7_7_val, metrics_vol7_7_test,</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>    metrics_vol7_14, metrics_vol7_14_val, metrics_vol7_14_test,</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>    metrics_vol7_21, metrics_vol7_21_val, metrics_vol7_21_test,</span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>    metrics_vol7_28, metrics_vol7_28_val, metrics_vol7_28_test</span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="volatilidad-omega-14-1" class="level4">
<h4 class="anchored" data-anchor-id="volatilidad-omega-14-1">Volatilidad <span class="math inline">\(\omega = 14\)</span></h4>
<section id="tau-7-9" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-9"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="b3001fb2" class="cell" data-execution_count="185">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(vol14_7[<span class="dv">0</span>], param)</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="185">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>0.013117</td>
<td>0.040219</td>
<td>0.001618</td>
<td>0.590116</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>0.009063</td>
<td>0.030808</td>
<td>0.000949</td>
<td>0.759490</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>0.006962</td>
<td>0.025391</td>
<td>0.000645</td>
<td>0.836636</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>0.005679</td>
<td>0.022119</td>
<td>0.000489</td>
<td>0.876023</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>0.004826</td>
<td>0.020053</td>
<td>0.000402</td>
<td>0.898106</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>0.004227</td>
<td>0.018704</td>
<td>0.000350</td>
<td>0.911352</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>0.003787</td>
<td>0.017814</td>
<td>0.000317</td>
<td>0.919583</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>0.003459</td>
<td>0.017243</td>
<td>0.000297</td>
<td>0.924663</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>0.003213</td>
<td>0.016910</td>
<td>0.000286</td>
<td>0.927538</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="fdc039e8" class="cell" data-execution_count="186">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-187-output-1.png" width="606" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="85c5cddb" class="cell" data-execution_count="187">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_7[<span class="dv">0</span>], best_param)</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>vol14_7_se <span class="op">=</span> model.smooth()</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>metrics_vol14_7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, vol14_7[<span class="dv">0</span>], vol14_7_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-188-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-188-output-2.png" width="711" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="308353e6" class="cell" data-execution_count="188">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_7[<span class="dv">1</span>], best_param)</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>vol14_7_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_7[<span class="dv">2</span>], best_param)</span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>vol14_7_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>metrics_vol14_7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, vol14_7[<span class="dv">1</span>], vol14_7_se_val)</span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>metrics_vol14_7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, vol14_7[<span class="dv">2</span>], vol14_7_se_test)</span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol14_7, metrics_vol14_7_val, metrics_vol14_7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="188">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>NaN</td>
<td>0.003213</td>
<td>0.016910</td>
<td>2.859626e-04</td>
<td>0.927538</td>
<td>3.661844e-46</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>31.829856</td>
<td>0.005188</td>
<td>0.005659</td>
<td>3.202489e-05</td>
<td>-113.279909</td>
<td>7.904339e-01</td>
<td>0.082897</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>2.433294</td>
<td>0.000401</td>
<td>0.000611</td>
<td>3.730931e-07</td>
<td>-0.331372</td>
<td>9.197661e-01</td>
<td>0.916042</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="83c268df" class="cell" data-execution_count="189">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol14_7[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol14_7[<span class="dv">1</span>], vol14_7[<span class="dv">2</span>], vol14_7_se, vol14_7_se_val, vol14_7_se_test)</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol14_7.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-9" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-9"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="006f842d" class="cell" data-execution_count="191">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_14[<span class="dv">0</span>], best_param)</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>vol14_14_se <span class="op">=</span> model.smooth()</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>metrics_vol14_14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, vol14_14[<span class="dv">0</span>], vol14_14_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-192-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-192-output-2.png" width="711" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="faa76602" class="cell" data-execution_count="192">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_14[<span class="dv">1</span>], best_param)</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>vol14_14_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_14[<span class="dv">2</span>], best_param)</span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>vol14_14_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a>metrics_vol14_14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, vol14_14[<span class="dv">1</span>], vol14_14_se_val)</span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a>metrics_vol14_14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, vol14_14[<span class="dv">2</span>], vol14_14_se_test)</span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol14_14, metrics_vol14_14_val, metrics_vol14_14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="192">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>NaN</td>
<td>0.003213</td>
<td>0.016910</td>
<td>2.859626e-04</td>
<td>0.927538</td>
<td>3.661844e-46</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>17.921353</td>
<td>0.003009</td>
<td>0.003957</td>
<td>1.566023e-05</td>
<td>-47.451388</td>
<td>6.316147e-01</td>
<td>0.000001</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>2.844051</td>
<td>0.000477</td>
<td>0.000673</td>
<td>4.523776e-07</td>
<td>-0.399617</td>
<td>9.775644e-02</td>
<td>0.193811</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="4ccfbe9f" class="cell" data-execution_count="193">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol14_14[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol14_14[<span class="dv">1</span>], vol14_14[<span class="dv">2</span>], vol14_14_se, vol14_14_se_val, vol14_14_se_test)</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol14_14.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-9" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-9"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="6a0657e0" class="cell" data-execution_count="195">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_21[<span class="dv">0</span>], best_param)</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>vol14_21_se <span class="op">=</span> model.smooth()</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>metrics_vol14_21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, vol14_21[<span class="dv">0</span>], vol14_21_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-196-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-196-output-2.png" width="711" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="2d020e2b" class="cell" data-execution_count="196">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_21[<span class="dv">1</span>], best_param)</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>vol14_21_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_21[<span class="dv">2</span>], best_param)</span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>vol14_21_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>metrics_vol14_21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, vol14_21[<span class="dv">1</span>], vol14_21_se_val)</span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a>metrics_vol14_21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, vol14_21[<span class="dv">2</span>], vol14_21_se_test)</span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol14_21, metrics_vol14_21_val, metrics_vol14_21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="196">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>NaN</td>
<td>0.003213</td>
<td>0.016910</td>
<td>0.000286</td>
<td>0.927538</td>
<td>3.661844e-46</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>42.080250</td>
<td>0.013563</td>
<td>0.016111</td>
<td>0.000260</td>
<td>-1.492731</td>
<td>7.237061e-01</td>
<td>3.961840e-18</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>5.559147</td>
<td>0.001618</td>
<td>0.002897</td>
<td>0.000008</td>
<td>0.919391</td>
<td>9.538744e-02</td>
<td>6.903126e-04</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="2b28806c" class="cell" data-execution_count="197">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol14_21[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol14_21[<span class="dv">1</span>], vol14_21[<span class="dv">2</span>], vol14_21_se, vol14_21_se_val, vol14_21_se_test)</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol14_21.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-9" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-9"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="747a1b43" class="cell" data-execution_count="199">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_28[<span class="dv">0</span>], best_param)</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>vol14_28_se <span class="op">=</span> model.smooth()</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>metrics_vol14_28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, vol14_28[<span class="dv">0</span>], vol14_28_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-200-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-200-output-2.png" width="711" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="7dc3da3d" class="cell" data-execution_count="200">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_28[<span class="dv">1</span>], best_param)</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>vol14_28_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_28[<span class="dv">2</span>], best_param)</span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>vol14_28_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a>metrics_vol14_28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, vol14_28[<span class="dv">1</span>], vol14_28_se_val)</span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a>metrics_vol14_28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, vol14_28[<span class="dv">2</span>], vol14_28_se_test)</span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol14_28, metrics_vol14_28_val, metrics_vol14_28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="200">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>NaN</td>
<td>0.003213</td>
<td>0.016910</td>
<td>0.000286</td>
<td>0.927538</td>
<td>3.661844e-46</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>48.974542</td>
<td>0.019458</td>
<td>0.021177</td>
<td>0.000448</td>
<td>-8.941659</td>
<td>7.769108e-01</td>
<td>7.033859e-33</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>6.124939</td>
<td>0.002218</td>
<td>0.003413</td>
<td>0.000012</td>
<td>0.741739</td>
<td>8.302782e-02</td>
<td>4.251965e-01</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="7c00d5a2" class="cell" data-execution_count="201">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol14_28[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol14_28[<span class="dv">1</span>], vol14_28[<span class="dv">2</span>], vol14_28_se, vol14_28_se_val, vol14_28_se_test)</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol14_28.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="88055dec" class="cell" data-execution_count="203">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>metrics_vol14_d <span class="op">=</span> pd.concat([</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>    metrics_vol14_7, metrics_vol14_7_val, metrics_vol14_7_test,</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>    metrics_vol14_14, metrics_vol14_14_val, metrics_vol14_14_test,</span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>    metrics_vol14_21, metrics_vol14_21_val, metrics_vol14_21_test,</span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>    metrics_vol14_28, metrics_vol14_28_val, metrics_vol14_28_test</span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="volatilidad-omega-21-1" class="level4">
<h4 class="anchored" data-anchor-id="volatilidad-omega-21-1">Volatilidad <span class="math inline">\(\omega = 21\)</span></h4>
<section id="tau-7-10" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-10"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="7dec7c5c" class="cell" data-execution_count="204">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(vol21_7[<span class="dv">0</span>], param)</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="204">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>0.010916</td>
<td>0.034353</td>
<td>0.001180</td>
<td>0.689858</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>0.006902</td>
<td>0.024920</td>
<td>0.000621</td>
<td>0.836804</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>0.005065</td>
<td>0.020224</td>
<td>0.000409</td>
<td>0.892515</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>0.004044</td>
<td>0.017568</td>
<td>0.000309</td>
<td>0.918895</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>0.003409</td>
<td>0.015927</td>
<td>0.000254</td>
<td>0.933338</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>0.002965</td>
<td>0.014864</td>
<td>0.000221</td>
<td>0.941938</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>0.002642</td>
<td>0.014166</td>
<td>0.000201</td>
<td>0.947262</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>0.002399</td>
<td>0.013719</td>
<td>0.000188</td>
<td>0.950536</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>0.002215</td>
<td>0.013461</td>
<td>0.000181</td>
<td>0.952378</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="8dd7a3ff" class="cell" data-execution_count="205">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-206-output-1.png" width="606" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="14f7787b" class="cell" data-execution_count="206">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_7[<span class="dv">0</span>], best_param)</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>vol21_7_se <span class="op">=</span> model.smooth()</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a>metrics_vol21_7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, vol21_7[<span class="dv">0</span>], vol21_7_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-207-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-207-output-2.png" width="728" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="9c95478b" class="cell" data-execution_count="207">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_7[<span class="dv">1</span>], best_param)</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>vol21_7_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_7[<span class="dv">2</span>], best_param)</span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>vol21_7_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a>metrics_vol21_7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, vol21_7[<span class="dv">1</span>], vol21_7_se_val)</span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a>metrics_vol21_7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, vol21_7[<span class="dv">2</span>], vol21_7_se_test)</span>
<span id="cb216-9"><a href="#cb216-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-10"><a href="#cb216-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol21_7, metrics_vol21_7_val, metrics_vol21_7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="207">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>NaN</td>
<td>0.002215</td>
<td>0.013461</td>
<td>1.812115e-04</td>
<td>0.952378</td>
<td>3.427794e-46</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>20.487936</td>
<td>0.004030</td>
<td>0.005142</td>
<td>2.643715e-05</td>
<td>-77.322445</td>
<td>9.767082e-01</td>
<td>0.063760</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>2.902855</td>
<td>0.000574</td>
<td>0.000807</td>
<td>6.517640e-07</td>
<td>-0.930910</td>
<td>4.601006e-01</td>
<td>0.973017</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="65e7b63e" class="cell" data-execution_count="208">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol21_7[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol21_7[<span class="dv">1</span>], vol21_7[<span class="dv">2</span>], vol21_7_se, vol21_7_se_val, vol21_7_se_test)</span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol21_7.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-10" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-10"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="acc4d409" class="cell" data-execution_count="210">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_14[<span class="dv">0</span>], best_param)</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>vol21_14_se <span class="op">=</span> model.smooth()</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>metrics_vol21_14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, vol21_14[<span class="dv">0</span>], vol21_14_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-211-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-211-output-2.png" width="728" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="85b2161c" class="cell" data-execution_count="211">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_14[<span class="dv">1</span>], best_param)</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>vol21_14_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_14[<span class="dv">2</span>], best_param)</span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>vol21_14_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>metrics_vol21_14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, vol21_14[<span class="dv">1</span>], vol21_14_se_val)</span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>metrics_vol21_14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, vol21_14[<span class="dv">2</span>], vol21_14_se_test)</span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol21_14, metrics_vol21_14_val, metrics_vol21_14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="211">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>NaN</td>
<td>0.002215</td>
<td>0.013461</td>
<td>1.812115e-04</td>
<td>0.952378</td>
<td>3.427794e-46</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>29.520160</td>
<td>0.004966</td>
<td>0.005738</td>
<td>3.292506e-05</td>
<td>-73.852531</td>
<td>9.018475e-01</td>
<td>6.075171e-08</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>2.824281</td>
<td>0.000473</td>
<td>0.000665</td>
<td>4.424062e-07</td>
<td>-0.005776</td>
<td>3.931241e-01</td>
<td>3.397258e-01</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="99f66ead" class="cell" data-execution_count="212">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol21_14[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol21_14[<span class="dv">1</span>], vol21_14[<span class="dv">2</span>], vol21_14_se, vol21_14_se_val, vol21_14_se_test)</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol21_14.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-10" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-10"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="2340483c" class="cell" data-execution_count="214">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_21[<span class="dv">0</span>], best_param)</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>vol21_21_se <span class="op">=</span> model.smooth()</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>metrics_vol21_21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, vol21_21[<span class="dv">0</span>], vol21_21_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-215-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-215-output-2.png" width="728" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="ff231b9f" class="cell" data-execution_count="215">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_21[<span class="dv">1</span>], best_param)</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>vol21_21_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_21[<span class="dv">2</span>], best_param)</span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>vol21_21_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a>metrics_vol21_21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, vol21_21[<span class="dv">1</span>], vol21_21_se_val)</span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>metrics_vol21_21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, vol21_21[<span class="dv">2</span>], vol21_21_se_test)</span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol21_21, metrics_vol21_21_val, metrics_vol21_21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="215">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>NaN</td>
<td>0.002215</td>
<td>0.013461</td>
<td>0.000181</td>
<td>0.952378</td>
<td>3.427794e-46</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>38.079290</td>
<td>0.010021</td>
<td>0.011686</td>
<td>0.000137</td>
<td>-1.198899</td>
<td>4.569950e-01</td>
<td>5.726914e-07</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>4.595185</td>
<td>0.001179</td>
<td>0.002118</td>
<td>0.000004</td>
<td>0.927733</td>
<td>1.123216e-01</td>
<td>5.485603e-04</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="1919b401" class="cell" data-execution_count="216">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol21_21[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol21_21[<span class="dv">1</span>], vol21_21[<span class="dv">2</span>], vol21_21_se, vol21_21_se_val, vol21_21_se_test)</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol21_21.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-10" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-10"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="03a68e58" class="cell" data-execution_count="218">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_28[<span class="dv">0</span>], best_param)</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>vol21_28_se <span class="op">=</span> model.smooth()</span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>metrics_vol21_28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, vol21_28[<span class="dv">0</span>], vol21_28_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-219-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-219-output-2.png" width="728" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="aad12a63" class="cell" data-execution_count="219">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_28[<span class="dv">1</span>], best_param)</span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>vol21_28_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_28[<span class="dv">2</span>], best_param)</span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a>vol21_28_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a>metrics_vol21_28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, vol21_28[<span class="dv">1</span>], vol21_28_se_val)</span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a>metrics_vol21_28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, vol21_28[<span class="dv">2</span>], vol21_28_se_test)</span>
<span id="cb228-9"><a href="#cb228-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-10"><a href="#cb228-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol21_28, metrics_vol21_28_val, metrics_vol21_28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="219">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>NaN</td>
<td>0.002215</td>
<td>0.013461</td>
<td>0.000181</td>
<td>0.952378</td>
<td>3.427794e-46</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>42.779302</td>
<td>0.016402</td>
<td>0.018792</td>
<td>0.000353</td>
<td>-5.889967</td>
<td>5.193451e-01</td>
<td>5.208990e-17</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>3.613422</td>
<td>0.001193</td>
<td>0.002050</td>
<td>0.000004</td>
<td>0.917982</td>
<td>4.577967e-01</td>
<td>7.541113e-05</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="103b32b5" class="cell" data-execution_count="220">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol21_28[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol21_28[<span class="dv">1</span>], vol21_28[<span class="dv">2</span>], vol21_28_se, vol21_28_se_val, vol21_28_se_test)</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol21_28.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="c3972557" class="cell" data-execution_count="222">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>metrics_vol21_d <span class="op">=</span> pd.concat([</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>    metrics_vol21_7, metrics_vol21_7_val, metrics_vol21_7_test,</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>    metrics_vol21_14, metrics_vol21_14_val, metrics_vol21_14_test,</span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>    metrics_vol21_21, metrics_vol21_21_val, metrics_vol21_21_test,</span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>    metrics_vol21_28, metrics_vol21_28_val, metrics_vol21_28_test</span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="volatilidad-omega-28-1" class="level4">
<h4 class="anchored" data-anchor-id="volatilidad-omega-28-1">Volatilidad <span class="math inline">\(\omega = 28\)</span></h4>
<section id="tau-7-11" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-11"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="7fe1a1dd" class="cell" data-execution_count="223">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(vol28_7[<span class="dv">0</span>], param)</span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb231-8"><a href="#cb231-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-9"><a href="#cb231-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb231-10"><a href="#cb231-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="223">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>0.009313</td>
<td>0.030121</td>
<td>0.000907</td>
<td>0.754956</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>0.005598</td>
<td>0.021227</td>
<td>0.000451</td>
<td>0.878301</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>0.004076</td>
<td>0.017158</td>
<td>0.000294</td>
<td>0.920488</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>0.003240</td>
<td>0.014906</td>
<td>0.000222</td>
<td>0.939987</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>0.002708</td>
<td>0.013524</td>
<td>0.000183</td>
<td>0.950601</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>0.002343</td>
<td>0.012632</td>
<td>0.000160</td>
<td>0.956901</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>0.002078</td>
<td>0.012050</td>
<td>0.000145</td>
<td>0.960784</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>0.001880</td>
<td>0.011680</td>
<td>0.000136</td>
<td>0.963152</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>0.001729</td>
<td>0.011472</td>
<td>0.000132</td>
<td>0.964457</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="99d705c1" class="cell" data-execution_count="224">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-225-output-1.png" width="606" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="dcba145b" class="cell" data-execution_count="225">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_7[<span class="dv">0</span>], best_param)</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>vol28_7_se <span class="op">=</span> model.smooth()</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a>metrics_vol28_7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, vol28_7[<span class="dv">0</span>], vol28_7_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-226-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-226-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="56b1cce4" class="cell" data-execution_count="226">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_7[<span class="dv">1</span>], best_param)</span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>vol28_7_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_7[<span class="dv">2</span>], best_param)</span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>vol28_7_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a>metrics_vol28_7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, vol28_7[<span class="dv">1</span>], vol28_7_se_val)</span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a>metrics_vol28_7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, vol28_7[<span class="dv">2</span>], vol28_7_se_test)</span>
<span id="cb235-9"><a href="#cb235-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-10"><a href="#cb235-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol28_7, metrics_vol28_7_val, metrics_vol28_7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="226">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>NaN</td>
<td>0.001729</td>
<td>0.011472</td>
<td>0.000132</td>
<td>0.964457</td>
<td>2.080088e-42</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>22.776284</td>
<td>0.004897</td>
<td>0.005409</td>
<td>0.000029</td>
<td>-9.049319</td>
<td>4.853045e-01</td>
<td>0.363816</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>4.049157</td>
<td>0.000847</td>
<td>0.001453</td>
<td>0.000002</td>
<td>0.274886</td>
<td>9.865148e-01</td>
<td>0.180878</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="d5126e1b" class="cell" data-execution_count="227">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol28_7[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol28_7[<span class="dv">1</span>], vol28_7[<span class="dv">2</span>], vol28_7_se, vol28_7_se_val, vol28_7_se_test)</span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol28_7.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-11" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-11"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="fb79999e" class="cell" data-execution_count="229">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_14[<span class="dv">0</span>], best_param)</span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>vol28_14_se <span class="op">=</span> model.smooth()</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a>metrics_vol28_14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, vol28_14[<span class="dv">0</span>], vol28_14_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-230-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-230-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="cff46c43" class="cell" data-execution_count="230">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_14[<span class="dv">1</span>], best_param)</span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>vol28_14_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_14[<span class="dv">2</span>], best_param)</span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a>vol28_14_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-7"><a href="#cb239-7" aria-hidden="true" tabindex="-1"></a>metrics_vol28_14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, vol28_14[<span class="dv">1</span>], vol28_14_se_val)</span>
<span id="cb239-8"><a href="#cb239-8" aria-hidden="true" tabindex="-1"></a>metrics_vol28_14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, vol28_14[<span class="dv">2</span>], vol28_14_se_test)</span>
<span id="cb239-9"><a href="#cb239-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-10"><a href="#cb239-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol28_14, metrics_vol28_14_val, metrics_vol28_14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="230">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>NaN</td>
<td>0.001729</td>
<td>0.011472</td>
<td>0.000132</td>
<td>0.964457</td>
<td>2.080088e-42</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>36.666901</td>
<td>0.006637</td>
<td>0.007027</td>
<td>0.000049</td>
<td>-12.781781</td>
<td>3.199223e-01</td>
<td>0.055452</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>3.334943</td>
<td>0.000588</td>
<td>0.001032</td>
<td>0.000001</td>
<td>0.702910</td>
<td>1.836634e-01</td>
<td>0.006907</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="75a4406c" class="cell" data-execution_count="231">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol28_14[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol28_14[<span class="dv">1</span>], vol28_14[<span class="dv">2</span>], vol28_14_se, vol28_14_se_val, vol28_14_se_test)</span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol28_14.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-11" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-11"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="93f4ea0d" class="cell" data-execution_count="233">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_21[<span class="dv">0</span>], best_param)</span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>vol28_21_se <span class="op">=</span> model.smooth()</span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>metrics_vol28_21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, vol28_21[<span class="dv">0</span>], vol28_21_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-234-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-234-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="5716725d" class="cell" data-execution_count="234">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_21[<span class="dv">1</span>], best_param)</span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>vol28_21_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_21[<span class="dv">2</span>], best_param)</span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a>vol28_21_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-7"><a href="#cb243-7" aria-hidden="true" tabindex="-1"></a>metrics_vol28_21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, vol28_21[<span class="dv">1</span>], vol28_21_se_val)</span>
<span id="cb243-8"><a href="#cb243-8" aria-hidden="true" tabindex="-1"></a>metrics_vol28_21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, vol28_21[<span class="dv">2</span>], vol28_21_se_test)</span>
<span id="cb243-9"><a href="#cb243-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-10"><a href="#cb243-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol28_21, metrics_vol28_21_val, metrics_vol28_21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="234">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>NaN</td>
<td>0.001729</td>
<td>0.011472</td>
<td>0.000132</td>
<td>0.964457</td>
<td>2.080088e-42</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>37.235382</td>
<td>0.008127</td>
<td>0.009179</td>
<td>0.000084</td>
<td>-1.115749</td>
<td>1.548663e-01</td>
<td>0.000681</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>4.143860</td>
<td>0.000994</td>
<td>0.001802</td>
<td>0.000003</td>
<td>0.918428</td>
<td>1.884342e-01</td>
<td>0.000639</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="f01a6698" class="cell" data-execution_count="235">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol28_21[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol28_21[<span class="dv">1</span>], vol28_21[<span class="dv">2</span>], vol28_21_se, vol28_21_se_val, vol28_21_se_test)</span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol28_21.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-11" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-11"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="02c3ca04" class="cell" data-execution_count="237">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_28[<span class="dv">0</span>], best_param)</span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>vol28_28_se <span class="op">=</span> model.smooth()</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>metrics_vol28_28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, vol28_28[<span class="dv">0</span>], vol28_28_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-238-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-238-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="4847c7ac" class="cell" data-execution_count="238">
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_28[<span class="dv">1</span>], best_param)</span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>vol28_28_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_28[<span class="dv">2</span>], best_param)</span>
<span id="cb247-5"><a href="#cb247-5" aria-hidden="true" tabindex="-1"></a>vol28_28_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb247-6"><a href="#cb247-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-7"><a href="#cb247-7" aria-hidden="true" tabindex="-1"></a>metrics_vol28_28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, vol28_28[<span class="dv">1</span>], vol28_28_se_val)</span>
<span id="cb247-8"><a href="#cb247-8" aria-hidden="true" tabindex="-1"></a>metrics_vol28_28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, vol28_28[<span class="dv">2</span>], vol28_28_se_test)</span>
<span id="cb247-9"><a href="#cb247-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-10"><a href="#cb247-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol28_28, metrics_vol28_28_val, metrics_vol28_28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="238">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>NaN</td>
<td>0.001729</td>
<td>0.011472</td>
<td>0.000132</td>
<td>0.964457</td>
<td>2.080088e-42</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>34.594749</td>
<td>0.012416</td>
<td>0.015259</td>
<td>0.000233</td>
<td>-3.315288</td>
<td>9.806432e-03</td>
<td>0.000266</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>3.738236</td>
<td>0.001167</td>
<td>0.001900</td>
<td>0.000004</td>
<td>0.933102</td>
<td>1.810440e-01</td>
<td>0.003661</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="830875c1" class="cell" data-execution_count="239">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol28_28[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol28_28[<span class="dv">1</span>], vol28_28[<span class="dv">2</span>], vol28_28_se, vol28_28_se_val, vol28_28_se_test)</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol28_28.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="d39f24e5" class="cell" data-execution_count="241">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>metrics_vol28_d <span class="op">=</span> pd.concat([</span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>    metrics_vol28_7, metrics_vol28_7_val, metrics_vol28_7_test,</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a>    metrics_vol28_14, metrics_vol28_14_val, metrics_vol28_14_test,</span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a>    metrics_vol28_21, metrics_vol28_21_val, metrics_vol28_21_test,</span>
<span id="cb249-5"><a href="#cb249-5" aria-hidden="true" tabindex="-1"></a>    metrics_vol28_28, metrics_vol28_28_val, metrics_vol28_28_test</span>
<span id="cb249-6"><a href="#cb249-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="caso-simple-usando-statsmodels" class="level3">
<h3 class="anchored" data-anchor-id="caso-simple-usando-statsmodels">Caso simple usando <code>statsmodels</code></h3>
<p>A continuación, usaremos la librería <code>statsmodels</code> para computar nuestra suavización exponencial mediante la función de HolterWinters.</p>
<div id="a6c27b68" class="cell" data-execution_count="242">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ExponentialSmoothing:</span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, data: pd.Series, trend: Optional[<span class="bu">str</span>] <span class="op">=</span> <span class="va">None</span>, seasonal: Optional[<span class="bu">str</span>] <span class="op">=</span> <span class="va">None</span>, seasonal_periods: Optional[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span>, smoothing_level: Optional[<span class="bu">float</span>] <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data <span class="op">=</span> data</span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.trend <span class="op">=</span> trend</span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.seasonal <span class="op">=</span> seasonal</span>
<span id="cb250-6"><a href="#cb250-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.seasonal_periods <span class="op">=</span> seasonal_periods</span>
<span id="cb250-7"><a href="#cb250-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.smoothing_level <span class="op">=</span> smoothing_level</span>
<span id="cb250-8"><a href="#cb250-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-9"><a href="#cb250-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> smooth(<span class="va">self</span>) <span class="op">-&gt;</span> pd.Series:</span>
<span id="cb250-10"><a href="#cb250-10" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> ExponentialSmoothingLib(<span class="va">self</span>.data, trend<span class="op">=</span><span class="va">self</span>.trend, seasonal<span class="op">=</span><span class="va">self</span>.seasonal, seasonal_periods<span class="op">=</span><span class="va">self</span>.seasonal_periods)</span>
<span id="cb250-11"><a href="#cb250-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fitted_model <span class="op">=</span> model.fit(smoothing_level<span class="op">=</span><span class="va">self</span>.smoothing_level)</span>
<span id="cb250-12"><a href="#cb250-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fitted_model.fittedvalues</span>
<span id="cb250-13"><a href="#cb250-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-14"><a href="#cb250-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> evaluate(<span class="va">self</span>, smoothed_data: Optional[pd.Series] <span class="op">=</span> <span class="va">None</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb250-15"><a href="#cb250-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> smoothed_data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb250-16"><a href="#cb250-16" aria-hidden="true" tabindex="-1"></a>            smoothed_data <span class="op">=</span> <span class="va">self</span>.smooth()</span>
<span id="cb250-17"><a href="#cb250-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-18"><a href="#cb250-18" aria-hidden="true" tabindex="-1"></a>        T <span class="op">=</span> <span class="bu">len</span>(<span class="va">self</span>.data)</span>
<span id="cb250-19"><a href="#cb250-19" aria-hidden="true" tabindex="-1"></a>        actual_values <span class="op">=</span> <span class="va">self</span>.data.values</span>
<span id="cb250-20"><a href="#cb250-20" aria-hidden="true" tabindex="-1"></a>        predicted_values <span class="op">=</span> pd.concat([pd.Series([<span class="va">self</span>.data.iloc[<span class="dv">0</span>]]), smoothed_data.iloc[:<span class="op">-</span><span class="dv">1</span>]], ignore_index<span class="op">=</span><span class="va">True</span>).values</span>
<span id="cb250-21"><a href="#cb250-21" aria-hidden="true" tabindex="-1"></a>        error <span class="op">=</span> actual_values <span class="op">-</span> predicted_values</span>
<span id="cb250-22"><a href="#cb250-22" aria-hidden="true" tabindex="-1"></a>        mean_actual <span class="op">=</span> np.mean(actual_values)</span>
<span id="cb250-23"><a href="#cb250-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-24"><a href="#cb250-24" aria-hidden="true" tabindex="-1"></a>        SSE <span class="op">=</span> <span class="bu">sum</span>(error<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb250-25"><a href="#cb250-25" aria-hidden="true" tabindex="-1"></a>        MAPE <span class="op">=</span> <span class="dv">100</span> <span class="op">*</span> <span class="bu">sum</span>(<span class="bu">abs</span>(error <span class="op">/</span> actual_values)) <span class="op">/</span> T</span>
<span id="cb250-26"><a href="#cb250-26" aria-hidden="true" tabindex="-1"></a>        MAE <span class="op">=</span> np.mean(np.<span class="bu">abs</span>(error))</span>
<span id="cb250-27"><a href="#cb250-27" aria-hidden="true" tabindex="-1"></a>        MSE <span class="op">=</span> SSE <span class="op">/</span> T</span>
<span id="cb250-28"><a href="#cb250-28" aria-hidden="true" tabindex="-1"></a>        RMSE <span class="op">=</span> np.sqrt(MSE)</span>
<span id="cb250-29"><a href="#cb250-29" aria-hidden="true" tabindex="-1"></a>        R2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (SSE <span class="op">/</span> (np.<span class="bu">sum</span>((actual_values <span class="op">-</span> mean_actual) <span class="op">**</span> <span class="dv">2</span>)))</span>
<span id="cb250-30"><a href="#cb250-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-31"><a href="#cb250-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pd.DataFrame({</span>
<span id="cb250-32"><a href="#cb250-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">'MAPE'</span>: [MAPE],</span>
<span id="cb250-33"><a href="#cb250-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">'MAE'</span>: [MAE],</span>
<span id="cb250-34"><a href="#cb250-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">'RMSE'</span>: [RMSE],</span>
<span id="cb250-35"><a href="#cb250-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">'MSE'</span>: [MSE],</span>
<span id="cb250-36"><a href="#cb250-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">'R2'</span>: [R2]</span>
<span id="cb250-37"><a href="#cb250-37" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb250-38"><a href="#cb250-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-39"><a href="#cb250-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> optimize_param(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb250-40"><a href="#cb250-40" aria-hidden="true" tabindex="-1"></a>        smoothed_data <span class="op">=</span> <span class="va">self</span>.smooth()</span>
<span id="cb250-41"><a href="#cb250-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.evaluate(smoothed_data)[<span class="st">'MAE'</span>].values[<span class="dv">0</span>]</span>
<span id="cb250-42"><a href="#cb250-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-43"><a href="#cb250-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_metrics(<span class="va">self</span>, y: pd.Series, y_pred: pd.Series, metric_name: <span class="bu">str</span>, case: <span class="bu">str</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb250-44"><a href="#cb250-44" aria-hidden="true" tabindex="-1"></a>        residuals <span class="op">=</span> y <span class="op">-</span> y_pred</span>
<span id="cb250-45"><a href="#cb250-45" aria-hidden="true" tabindex="-1"></a>        metrics_df <span class="op">=</span> <span class="va">self</span>.evaluate(y_pred)</span>
<span id="cb250-46"><a href="#cb250-46" aria-hidden="true" tabindex="-1"></a>        metrics_df.index <span class="op">=</span> metrics_df.index.<span class="bu">map</span>({<span class="dv">0</span>: <span class="ss">f'</span><span class="sc">{</span>metric_name<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>case<span class="sc">}</span><span class="ss">'</span>})</span>
<span id="cb250-47"><a href="#cb250-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-48"><a href="#cb250-48" aria-hidden="true" tabindex="-1"></a>        max_lag <span class="op">=</span> <span class="bu">min</span>(<span class="dv">10</span>, <span class="bu">len</span>(residuals) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb250-49"><a href="#cb250-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> max_lag <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb250-50"><a href="#cb250-50" aria-hidden="true" tabindex="-1"></a>            ljung_box_pval <span class="op">=</span> acorr_ljungbox(residuals, lags<span class="op">=</span>[max_lag], return_df<span class="op">=</span><span class="va">True</span>)[<span class="st">'lb_pvalue'</span>].iloc[<span class="dv">0</span>]</span>
<span id="cb250-51"><a href="#cb250-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb250-52"><a href="#cb250-52" aria-hidden="true" tabindex="-1"></a>            ljung_box_pval <span class="op">=</span> np.nan</span>
<span id="cb250-53"><a href="#cb250-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-54"><a href="#cb250-54" aria-hidden="true" tabindex="-1"></a>        jb_pvalue <span class="op">=</span> jarque_bera(residuals)[<span class="dv">1</span>]</span>
<span id="cb250-55"><a href="#cb250-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-56"><a href="#cb250-56" aria-hidden="true" tabindex="-1"></a>        metrics_df[<span class="st">'Ljung-Box p-value'</span>] <span class="op">=</span> ljung_box_pval</span>
<span id="cb250-57"><a href="#cb250-57" aria-hidden="true" tabindex="-1"></a>        metrics_df[<span class="st">'Jarque-Bera p-value'</span>] <span class="op">=</span> jb_pvalue</span>
<span id="cb250-58"><a href="#cb250-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> metrics_df, residuals</span>
<span id="cb250-59"><a href="#cb250-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-60"><a href="#cb250-60" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> plot_residuals(<span class="va">self</span>, residuals: pd.Series, model_name: <span class="bu">str</span>):</span>
<span id="cb250-61"><a href="#cb250-61" aria-hidden="true" tabindex="-1"></a>        fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="fl">8.6</span>, <span class="dv">5</span>))</span>
<span id="cb250-62"><a href="#cb250-62" aria-hidden="true" tabindex="-1"></a>        ax.plot(residuals.index, residuals.values, color<span class="op">=</span><span class="st">'#1f77b4'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, markersize<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb250-63"><a href="#cb250-63" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="ss">f'</span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb250-64"><a href="#cb250-64" aria-hidden="true" tabindex="-1"></a>        ax.set_xlabel(<span class="st">'Índice'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb250-65"><a href="#cb250-65" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(<span class="st">'Residuo'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb250-66"><a href="#cb250-66" aria-hidden="true" tabindex="-1"></a>        ax.grid(<span class="va">True</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb250-67"><a href="#cb250-67" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb250-68"><a href="#cb250-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-69"><a href="#cb250-69" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> plot_diagnostics(<span class="va">self</span>, residuals: pd.Series, model_name: <span class="bu">str</span>):</span>
<span id="cb250-70"><a href="#cb250-70" aria-hidden="true" tabindex="-1"></a>        fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">2</span>, ncols<span class="op">=</span><span class="dv">1</span>, figsize<span class="op">=</span>(<span class="fl">7.6</span>, <span class="dv">6</span>))</span>
<span id="cb250-71"><a href="#cb250-71" aria-hidden="true" tabindex="-1"></a>        sm.qqplot(residuals, line<span class="op">=</span><span class="st">'s'</span>, ax<span class="op">=</span>axes[<span class="dv">0</span>])</span>
<span id="cb250-72"><a href="#cb250-72" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>].set_title(<span class="st">'QQ Plot de los Residuos'</span>)</span>
<span id="cb250-73"><a href="#cb250-73" aria-hidden="true" tabindex="-1"></a>        sm.graphics.tsa.plot_pacf(residuals, lags<span class="op">=</span><span class="dv">30</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb250-74"><a href="#cb250-74" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>].set_title(<span class="st">'Autocorrelación Parcial de los Residuos'</span>)</span>
<span id="cb250-75"><a href="#cb250-75" aria-hidden="true" tabindex="-1"></a>        plt.suptitle(<span class="ss">f'</span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb250-76"><a href="#cb250-76" aria-hidden="true" tabindex="-1"></a>        plt.tight_layout(rect<span class="op">=</span>[<span class="dv">0</span>, <span class="fl">0.03</span>, <span class="dv">1</span>, <span class="fl">0.95</span>])</span>
<span id="cb250-77"><a href="#cb250-77" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb250-78"><a href="#cb250-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-79"><a href="#cb250-79" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> residuals(<span class="va">self</span>, model_name: <span class="bu">str</span>, metric_name: <span class="bu">str</span>, case: <span class="bu">str</span>, y: pd.Series, y_pred: pd.Series, show_info: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb250-80"><a href="#cb250-80" aria-hidden="true" tabindex="-1"></a>        metrics_df, residuals <span class="op">=</span> <span class="va">self</span>.calculate_metrics(y, y_pred, metric_name, case)</span>
<span id="cb250-81"><a href="#cb250-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-82"><a href="#cb250-82" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> show_info:</span>
<span id="cb250-83"><a href="#cb250-83" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.plot_residuals(residuals, model_name)</span>
<span id="cb250-84"><a href="#cb250-84" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.plot_diagnostics(residuals, model_name)</span>
<span id="cb250-85"><a href="#cb250-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-86"><a href="#cb250-86" aria-hidden="true" tabindex="-1"></a>            ljung_box_pval <span class="op">=</span> metrics_df[<span class="st">'Ljung-Box p-value'</span>].iloc[<span class="dv">0</span>]</span>
<span id="cb250-87"><a href="#cb250-87" aria-hidden="true" tabindex="-1"></a>            jb_pvalue <span class="op">=</span> metrics_df[<span class="st">'Jarque-Bera p-value'</span>].iloc[<span class="dv">0</span>]</span>
<span id="cb250-88"><a href="#cb250-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-89"><a href="#cb250-89" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> ljung_box_pval <span class="op">&gt;</span> <span class="fl">0.05</span>:</span>
<span id="cb250-90"><a href="#cb250-90" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'No se rechaza H0: los residuales son independientes (no correlacionados).'</span>)</span>
<span id="cb250-91"><a href="#cb250-91" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb250-92"><a href="#cb250-92" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'Se rechaza H0: hay autocorrelación en los residuales.'</span>)</span>
<span id="cb250-93"><a href="#cb250-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-94"><a href="#cb250-94" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f'Jarque-Bera p-value: </span><span class="sc">{</span>jb_pvalue<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb250-95"><a href="#cb250-95" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> jb_pvalue <span class="op">&gt;</span> <span class="fl">0.05</span>:</span>
<span id="cb250-96"><a href="#cb250-96" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'No se rechaza H0: los residuales siguen una distribución normal.'</span>)</span>
<span id="cb250-97"><a href="#cb250-97" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb250-98"><a href="#cb250-98" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'Se rechaza H0: los residuales no siguen una distribución normal.'</span>)</span>
<span id="cb250-99"><a href="#cb250-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-100"><a href="#cb250-100" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> metrics_df</span>
<span id="cb250-101"><a href="#cb250-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-102"><a href="#cb250-102" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> plot_preds(<span class="va">self</span>, y_train: pd.Series, y_val: pd.Series, y_test: pd.Series,</span>
<span id="cb250-103"><a href="#cb250-103" aria-hidden="true" tabindex="-1"></a>                            y_pred_train: pd.Series, y_pred_val: pd.Series, y_pred_test: pd.Series):</span>
<span id="cb250-104"><a href="#cb250-104" aria-hidden="true" tabindex="-1"></a>        fig <span class="op">=</span> go.Figure()</span>
<span id="cb250-105"><a href="#cb250-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-106"><a href="#cb250-106" aria-hidden="true" tabindex="-1"></a>        fig.add_trace(go.Scatter(x<span class="op">=</span>y_train[<span class="op">-</span><span class="dv">250</span>:].index, y<span class="op">=</span>y_train[<span class="op">-</span><span class="dv">250</span>:], mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'y_train'</span>, line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#FDDBBB'</span>, dash <span class="op">=</span> <span class="st">'dash'</span>)))</span>
<span id="cb250-107"><a href="#cb250-107" aria-hidden="true" tabindex="-1"></a>        fig.add_trace(go.Scatter(x<span class="op">=</span>y_val.index, y<span class="op">=</span>y_val, mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'y_val'</span>, line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#BFECFF'</span>, dash <span class="op">=</span> <span class="st">'dash'</span>)))</span>
<span id="cb250-108"><a href="#cb250-108" aria-hidden="true" tabindex="-1"></a>        fig.add_trace(go.Scatter(x<span class="op">=</span>y_test.index, y<span class="op">=</span>y_test, mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'y_test'</span>, line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#C9E9D2'</span>, dash <span class="op">=</span> <span class="st">'dash'</span>)))</span>
<span id="cb250-109"><a href="#cb250-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-110"><a href="#cb250-110" aria-hidden="true" tabindex="-1"></a>        fig.add_trace(go.Scatter(x<span class="op">=</span>y_pred_train[<span class="op">-</span><span class="dv">250</span>:].index, y<span class="op">=</span>y_pred_train[<span class="op">-</span><span class="dv">250</span>:], mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'y_pred_train'</span>,</span>
<span id="cb250-111"><a href="#cb250-111" aria-hidden="true" tabindex="-1"></a>                                 line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#CB9DF0'</span>, dash<span class="op">=</span><span class="st">'dash'</span>)))</span>
<span id="cb250-112"><a href="#cb250-112" aria-hidden="true" tabindex="-1"></a>        fig.add_trace(go.Scatter(x<span class="op">=</span>y_pred_val.index, y<span class="op">=</span>y_pred_val, mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'y_pred_val'</span>,</span>
<span id="cb250-113"><a href="#cb250-113" aria-hidden="true" tabindex="-1"></a>                                 line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#FFCCEA'</span>, dash<span class="op">=</span><span class="st">'dash'</span>)))</span>
<span id="cb250-114"><a href="#cb250-114" aria-hidden="true" tabindex="-1"></a>        fig.add_trace(go.Scatter(x<span class="op">=</span>y_pred_test.index, y<span class="op">=</span>y_pred_test, mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'y_pred_test'</span>,</span>
<span id="cb250-115"><a href="#cb250-115" aria-hidden="true" tabindex="-1"></a>                                 line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#EEEEEE'</span>, dash<span class="op">=</span><span class="st">'dash'</span>)))</span>
<span id="cb250-116"><a href="#cb250-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-117"><a href="#cb250-117" aria-hidden="true" tabindex="-1"></a>        fig.update_layout(</span>
<span id="cb250-118"><a href="#cb250-118" aria-hidden="true" tabindex="-1"></a>            title<span class="op">=</span><span class="st">"Comparación de y v.s. y_pred"</span>,</span>
<span id="cb250-119"><a href="#cb250-119" aria-hidden="true" tabindex="-1"></a>            xaxis_title<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb250-120"><a href="#cb250-120" aria-hidden="true" tabindex="-1"></a>            yaxis_title<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb250-121"><a href="#cb250-121" aria-hidden="true" tabindex="-1"></a>            legend_title<span class="op">=</span><span class="st">"Series"</span>,</span>
<span id="cb250-122"><a href="#cb250-122" aria-hidden="true" tabindex="-1"></a>            margin<span class="op">=</span>{<span class="st">'b'</span>: <span class="dv">0</span>, <span class="st">'r'</span>: <span class="dv">30</span>, <span class="st">'l'</span>: <span class="dv">30</span>, <span class="st">'t'</span>: <span class="dv">80</span>},</span>
<span id="cb250-123"><a href="#cb250-123" aria-hidden="true" tabindex="-1"></a>            plot_bgcolor<span class="op">=</span><span class="st">'rgba(0, 0, 0, 0.0)'</span>,</span>
<span id="cb250-124"><a href="#cb250-124" aria-hidden="true" tabindex="-1"></a>            paper_bgcolor<span class="op">=</span><span class="st">'rgba(0, 0, 0, 0.0)'</span>,</span>
<span id="cb250-125"><a href="#cb250-125" aria-hidden="true" tabindex="-1"></a>            font_color<span class="op">=</span><span class="st">"white"</span>,</span>
<span id="cb250-126"><a href="#cb250-126" aria-hidden="true" tabindex="-1"></a>            hoverlabel<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb250-127"><a href="#cb250-127" aria-hidden="true" tabindex="-1"></a>                bgcolor<span class="op">=</span><span class="st">"#222"</span></span>
<span id="cb250-128"><a href="#cb250-128" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb250-129"><a href="#cb250-129" aria-hidden="true" tabindex="-1"></a>            xaxis<span class="op">=</span><span class="bu">dict</span>(gridcolor<span class="op">=</span><span class="st">'#222'</span>, tickfont<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'white'</span>)),</span>
<span id="cb250-130"><a href="#cb250-130" aria-hidden="true" tabindex="-1"></a>            yaxis<span class="op">=</span><span class="bu">dict</span>(gridcolor<span class="op">=</span><span class="st">'#222'</span>, tickfont<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'white'</span>)),</span>
<span id="cb250-131"><a href="#cb250-131" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb250-132"><a href="#cb250-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-133"><a href="#cb250-133" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> fig</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="price-2" class="level4">
<h4 class="anchored" data-anchor-id="price-2">Price</h4>
<section id="tau-7-12" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-12"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="37a7cbfe" class="cell" data-execution_count="243">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(price7[<span class="dv">0</span>], smoothing_level <span class="op">=</span> param)</span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb251-8"><a href="#cb251-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-9"><a href="#cb251-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb251-10"><a href="#cb251-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="243">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.876271</td>
<td>737.275460</td>
<td>1684.977617</td>
<td>2.839150e+06</td>
<td>0.987656</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>6.609508</td>
<td>544.141311</td>
<td>1282.635726</td>
<td>1.645154e+06</td>
<td>0.992847</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5.705266</td>
<td>474.744387</td>
<td>1125.003019</td>
<td>1.265632e+06</td>
<td>0.994497</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>5.224338</td>
<td>437.207197</td>
<td>1040.017149</td>
<td>1.081636e+06</td>
<td>0.995297</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4.928682</td>
<td>413.858858</td>
<td>988.328221</td>
<td>9.767927e+05</td>
<td>0.995753</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>4.752038</td>
<td>398.667162</td>
<td>955.240544</td>
<td>9.124845e+05</td>
<td>0.996033</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>4.637379</td>
<td>387.862341</td>
<td>933.984231</td>
<td>8.723265e+05</td>
<td>0.996207</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>4.566312</td>
<td>381.205526</td>
<td>921.051463</td>
<td>8.483358e+05</td>
<td>0.996312</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>4.525583</td>
<td>377.548171</td>
<td>914.523836</td>
<td>8.363538e+05</td>
<td>0.996364</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="a904c478" class="cell" data-execution_count="244">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb252-7"><a href="#cb252-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb252-8"><a href="#cb252-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb252-9"><a href="#cb252-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-245-output-1.png" width="593" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="e30b712b" class="cell" data-execution_count="245">
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price7[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a>price7_se <span class="op">=</span> model.smooth()</span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a>metrics_price7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, price7[<span class="dv">0</span>], price7_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-246-output-1.png" width="734" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-246-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="aa2949d6" class="cell" data-execution_count="246">
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price7[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>price7_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price7[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a>price7_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb255-6"><a href="#cb255-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-7"><a href="#cb255-7" aria-hidden="true" tabindex="-1"></a>metrics_price7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, price7[<span class="dv">1</span>], price7_se_val)</span>
<span id="cb255-8"><a href="#cb255-8" aria-hidden="true" tabindex="-1"></a>metrics_price7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, price7[<span class="dv">2</span>], price7_se_test)</span>
<span id="cb255-9"><a href="#cb255-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-10"><a href="#cb255-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_price7, metrics_price7_val, metrics_price7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="246">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>4.525583</td>
<td>377.548171</td>
<td>914.523836</td>
<td>8.363538e+05</td>
<td>0.996364</td>
<td>2.388399e-11</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>5.410749</td>
<td>2551.131517</td>
<td>3274.988349</td>
<td>1.072555e+07</td>
<td>-1.459638</td>
<td>3.353613e-01</td>
<td>0.723077</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>3.398894</td>
<td>1579.028366</td>
<td>1880.961863</td>
<td>3.538018e+06</td>
<td>0.188644</td>
<td>3.429490e-01</td>
<td>0.898806</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="32a08bb2" class="cell" data-execution_count="247">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(price7[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], price7[<span class="dv">1</span>], price7[<span class="dv">2</span>], price7_se, price7_se_val, price7_se_test)</span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_price7.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-12" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-12"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="e5b6a4af" class="cell" data-execution_count="249">
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price14[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>price14_se <span class="op">=</span> model.smooth()</span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true" tabindex="-1"></a>metrics_price14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, price14[<span class="dv">0</span>], price14_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-250-output-1.png" width="734" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-250-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="ba1572e9" class="cell" data-execution_count="250">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price14[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a>price14_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-4"><a href="#cb259-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price14[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb259-5"><a href="#cb259-5" aria-hidden="true" tabindex="-1"></a>price14_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb259-6"><a href="#cb259-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-7"><a href="#cb259-7" aria-hidden="true" tabindex="-1"></a>metrics_price14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, price14[<span class="dv">1</span>], price14_se_val)</span>
<span id="cb259-8"><a href="#cb259-8" aria-hidden="true" tabindex="-1"></a>metrics_price14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, price14[<span class="dv">2</span>], price14_se_test)</span>
<span id="cb259-9"><a href="#cb259-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-10"><a href="#cb259-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_price14, metrics_price14_val, metrics_price14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="250">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>4.525583</td>
<td>377.548171</td>
<td>914.523836</td>
<td>8.363538e+05</td>
<td>0.996364</td>
<td>2.388399e-11</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>14.450054</td>
<td>7462.100293</td>
<td>7866.289479</td>
<td>6.187851e+07</td>
<td>-106.011317</td>
<td>1.141840e-02</td>
<td>0.539228</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>1.177869</td>
<td>607.576676</td>
<td>907.969720</td>
<td>8.244090e+05</td>
<td>-0.425715</td>
<td>2.465928e-01</td>
<td>0.033361</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="96cd4b37" class="cell" data-execution_count="251">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(price14[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], price14[<span class="dv">1</span>], price14[<span class="dv">2</span>], price14_se, price14_se_val, price14_se_test)</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_price14.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-12" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-12"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="70e13c67" class="cell" data-execution_count="253">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price21[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>price21_se <span class="op">=</span> model.smooth()</span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a>metrics_price21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, price21[<span class="dv">0</span>], price21_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-254-output-1.png" width="734" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-254-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="af96ea18" class="cell" data-execution_count="254">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price21[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>price21_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price21[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a>price21_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb263-6"><a href="#cb263-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-7"><a href="#cb263-7" aria-hidden="true" tabindex="-1"></a>metrics_price21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, price21[<span class="dv">1</span>], price21_se_val)</span>
<span id="cb263-8"><a href="#cb263-8" aria-hidden="true" tabindex="-1"></a>metrics_price21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, price21[<span class="dv">2</span>], price21_se_test)</span>
<span id="cb263-9"><a href="#cb263-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-10"><a href="#cb263-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_price21, metrics_price21_val, metrics_price21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="254">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>4.525583</td>
<td>377.548171</td>
<td>914.523836</td>
<td>8.363538e+05</td>
<td>0.996364</td>
<td>2.388399e-11</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>22.210727</td>
<td>13603.358996</td>
<td>14522.647188</td>
<td>2.109073e+08</td>
<td>-3.698244</td>
<td>2.561018e-02</td>
<td>0.330107</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>3.319735</td>
<td>2045.213849</td>
<td>2992.335215</td>
<td>8.954070e+06</td>
<td>0.800536</td>
<td>8.088324e-01</td>
<td>0.379845</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="b03ce81f" class="cell" data-execution_count="255">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(price21[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], price21[<span class="dv">1</span>], price21[<span class="dv">2</span>], price21_se, price21_se_val, price21_se_test)</span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_price21.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-12" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-12"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="9bf43551" class="cell" data-execution_count="257">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price28[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a>price28_se <span class="op">=</span> model.smooth()</span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a>metrics_price28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, price28[<span class="dv">0</span>], price28_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-258-output-1.png" width="734" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-258-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="d2f88f40" class="cell" data-execution_count="258">
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price28[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>price28_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price28[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a>price28_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true" tabindex="-1"></a>metrics_price28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, price28[<span class="dv">1</span>], price28_se_val)</span>
<span id="cb267-8"><a href="#cb267-8" aria-hidden="true" tabindex="-1"></a>metrics_price28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, price28[<span class="dv">2</span>], price28_se_test)</span>
<span id="cb267-9"><a href="#cb267-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-10"><a href="#cb267-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_price28, metrics_price28_val, metrics_price28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="258">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>4.525583</td>
<td>377.548171</td>
<td>914.523836</td>
<td>8.363538e+05</td>
<td>0.996364</td>
<td>2.388399e-11</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>27.350017</td>
<td>18180.475472</td>
<td>18998.294049</td>
<td>3.609352e+08</td>
<td>-18.797489</td>
<td>1.791521e-03</td>
<td>0.187340</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>3.870259</td>
<td>2534.638645</td>
<td>3252.079320</td>
<td>1.057602e+07</td>
<td>0.419900</td>
<td>6.980119e-01</td>
<td>0.957407</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="4831a34d" class="cell" data-execution_count="259">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(price28[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], price28[<span class="dv">1</span>], price28[<span class="dv">2</span>], price28_se, price28_se_val, price28_se_test)</span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_price28.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="c4f0af7b" class="cell" data-execution_count="261">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a>metrics_price <span class="op">=</span> pd.concat([</span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>    metrics_price7, metrics_price7_val, metrics_price7_test,</span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>    metrics_price14, metrics_price14_val, metrics_price14_test,</span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a>    metrics_price21, metrics_price21_val, metrics_price21_test,</span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a>    metrics_price28, metrics_price28_val, metrics_price28_test</span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="retorno-acumulado-2" class="level4">
<h4 class="anchored" data-anchor-id="retorno-acumulado-2">Retorno acumulado</h4>
<section id="tau-7-13" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-13"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="f6034cdd" class="cell" data-execution_count="262">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(A_t7[<span class="dv">0</span>], smoothing_level <span class="op">=</span> param)</span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb270-8"><a href="#cb270-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-9"><a href="#cb270-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb270-10"><a href="#cb270-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="262">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>0.102749</td>
<td>0.200028</td>
<td>0.040011</td>
<td>0.998930</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>0.072009</td>
<td>0.148842</td>
<td>0.022154</td>
<td>0.999407</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>0.060886</td>
<td>0.129237</td>
<td>0.016702</td>
<td>0.999553</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>0.055120</td>
<td>0.119108</td>
<td>0.014187</td>
<td>0.999620</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>0.051761</td>
<td>0.113368</td>
<td>0.012852</td>
<td>0.999656</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>0.049592</td>
<td>0.110095</td>
<td>0.012121</td>
<td>0.999676</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>0.048146</td>
<td>0.108364</td>
<td>0.011743</td>
<td>0.999686</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>0.047216</td>
<td>0.107657</td>
<td>0.011590</td>
<td>0.999690</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>0.046706</td>
<td>0.107660</td>
<td>0.011591</td>
<td>0.999690</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="8170fb07" class="cell" data-execution_count="263">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb271-6"><a href="#cb271-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb271-7"><a href="#cb271-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb271-8"><a href="#cb271-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb271-9"><a href="#cb271-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-264-output-1.png" width="597" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="4c736c4c" class="cell" data-execution_count="264">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t7[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>A_t7_se <span class="op">=</span> model.smooth()</span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a>metrics_A_t7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, A_t7[<span class="dv">0</span>], A_t7_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-265-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-265-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="a15d5c44" class="cell" data-execution_count="265">
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t7[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>A_t7_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t7[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a>A_t7_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb274-6"><a href="#cb274-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-7"><a href="#cb274-7" aria-hidden="true" tabindex="-1"></a>metrics_A_t7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, A_t7[<span class="dv">1</span>], A_t7_se_val)</span>
<span id="cb274-8"><a href="#cb274-8" aria-hidden="true" tabindex="-1"></a>metrics_A_t7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, A_t7[<span class="dv">2</span>], A_t7_se_test)</span>
<span id="cb274-9"><a href="#cb274-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-10"><a href="#cb274-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_A_t7, metrics_A_t7_val, metrics_A_t7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="265">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>NaN</td>
<td>0.046706</td>
<td>0.107660</td>
<td>0.011591</td>
<td>0.999690</td>
<td>1.962549e-52</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>0.246643</td>
<td>0.057535</td>
<td>0.073593</td>
<td>0.005416</td>
<td>-1.492079</td>
<td>3.415244e-01</td>
<td>0.723094</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>0.151569</td>
<td>0.035334</td>
<td>0.042044</td>
<td>0.001768</td>
<td>0.186598</td>
<td>3.234844e-01</td>
<td>0.883296</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="19fabd90" class="cell" data-execution_count="266">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(A_t7[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], A_t7[<span class="dv">1</span>], A_t7[<span class="dv">2</span>], A_t7_se, A_t7_se_val, A_t7_se_test)</span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_A_t7.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-13" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-13"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="01debd64" class="cell" data-execution_count="268">
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t14[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a>A_t14_se <span class="op">=</span> model.smooth()</span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a>metrics_A_t14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, A_t14[<span class="dv">0</span>], A_t14_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-269-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-269-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="1a7ad40a" class="cell" data-execution_count="269">
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t14[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>A_t14_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t14[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a>A_t14_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-7"><a href="#cb278-7" aria-hidden="true" tabindex="-1"></a>metrics_A_t14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, A_t14[<span class="dv">1</span>], A_t14_se_val)</span>
<span id="cb278-8"><a href="#cb278-8" aria-hidden="true" tabindex="-1"></a>metrics_A_t14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, A_t14[<span class="dv">2</span>], A_t14_se_test)</span>
<span id="cb278-9"><a href="#cb278-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-10"><a href="#cb278-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_A_t14, metrics_A_t14_val, metrics_A_t14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="269">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>NaN</td>
<td>0.046706</td>
<td>0.107660</td>
<td>0.011591</td>
<td>0.999690</td>
<td>1.962549e-52</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>0.684678</td>
<td>0.160353</td>
<td>0.169150</td>
<td>0.028612</td>
<td>-122.751190</td>
<td>1.482738e-02</td>
<td>0.560407</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>0.051388</td>
<td>0.012035</td>
<td>0.018071</td>
<td>0.000327</td>
<td>-0.412516</td>
<td>2.670484e-01</td>
<td>0.020674</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="aab278a2" class="cell" data-execution_count="270">
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(A_t14[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], A_t14[<span class="dv">1</span>], A_t14[<span class="dv">2</span>], A_t14_se, A_t14_se_val, A_t14_se_test)</span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_A_t14.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-13" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-13"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="c910195f" class="cell" data-execution_count="272">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t21[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>A_t21_se <span class="op">=</span> model.smooth()</span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a>metrics_A_t21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, A_t21[<span class="dv">0</span>], A_t21_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-273-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-273-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="faebd741" class="cell" data-execution_count="273">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t21[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a>A_t21_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t21[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true" tabindex="-1"></a>A_t21_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-7"><a href="#cb282-7" aria-hidden="true" tabindex="-1"></a>metrics_A_t21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, A_t21[<span class="dv">1</span>], A_t21_se_val)</span>
<span id="cb282-8"><a href="#cb282-8" aria-hidden="true" tabindex="-1"></a>metrics_A_t21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, A_t21[<span class="dv">2</span>], A_t21_se_test)</span>
<span id="cb282-9"><a href="#cb282-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-10"><a href="#cb282-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_A_t21, metrics_A_t21_val, metrics_A_t21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="273">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>NaN</td>
<td>0.046706</td>
<td>0.107660</td>
<td>0.011591</td>
<td>0.999690</td>
<td>1.962549e-52</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>1.117020</td>
<td>0.263572</td>
<td>0.278311</td>
<td>0.077457</td>
<td>-4.484802</td>
<td>1.595702e-02</td>
<td>0.362303</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>0.150332</td>
<td>0.035479</td>
<td>0.052336</td>
<td>0.002739</td>
<td>0.806046</td>
<td>8.434113e-01</td>
<td>0.317602</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="ab83cd4b" class="cell" data-execution_count="274">
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(A_t21[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], A_t21[<span class="dv">1</span>], A_t21[<span class="dv">2</span>], A_t21_se, A_t21_se_val, A_t21_se_test)</span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_A_t21.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-13" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-13"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="898f912b" class="cell" data-execution_count="276">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t28[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>A_t28_se <span class="op">=</span> model.smooth()</span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a>metrics_A_t28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, A_t28[<span class="dv">0</span>], A_t28_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-277-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-277-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="6af034c1" class="cell" data-execution_count="277">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t28[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a>A_t28_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t28[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true" tabindex="-1"></a>A_t28_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb286-6"><a href="#cb286-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-7"><a href="#cb286-7" aria-hidden="true" tabindex="-1"></a>metrics_A_t28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, A_t28[<span class="dv">1</span>], A_t28_se_val)</span>
<span id="cb286-8"><a href="#cb286-8" aria-hidden="true" tabindex="-1"></a>metrics_A_t28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, A_t28[<span class="dv">2</span>], A_t28_se_test)</span>
<span id="cb286-9"><a href="#cb286-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-10"><a href="#cb286-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_A_t28, metrics_A_t28_val, metrics_A_t28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="277">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>NaN</td>
<td>0.046706</td>
<td>0.107660</td>
<td>0.011591</td>
<td>0.999690</td>
<td>1.962549e-52</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>1.442284</td>
<td>0.341625</td>
<td>0.356231</td>
<td>0.126900</td>
<td>-24.886559</td>
<td>1.160388e-03</td>
<td>0.182208</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>0.169122</td>
<td>0.040034</td>
<td>0.051840</td>
<td>0.002687</td>
<td>0.451802</td>
<td>7.820676e-01</td>
<td>0.978637</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="514c14fd" class="cell" data-execution_count="278">
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(A_t28[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], A_t28[<span class="dv">1</span>], A_t28[<span class="dv">2</span>], A_t28_se, A_t28_se_val, A_t28_se_test)</span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_A_t28.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="9a173716" class="cell" data-execution_count="280">
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>metrics_A_t <span class="op">=</span> pd.concat([</span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>    metrics_A_t7, metrics_A_t7_val, metrics_A_t7_test,</span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a>    metrics_A_t14, metrics_A_t14_val, metrics_A_t14_test,</span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a>    metrics_A_t21, metrics_A_t21_val, metrics_A_t21_test,</span>
<span id="cb288-5"><a href="#cb288-5" aria-hidden="true" tabindex="-1"></a>    metrics_A_t28, metrics_A_t28_val, metrics_A_t28_test</span>
<span id="cb288-6"><a href="#cb288-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="volatilidad-omega-7-2" class="level4">
<h4 class="anchored" data-anchor-id="volatilidad-omega-7-2">Volatilidad <span class="math inline">\(\omega = 7\)</span></h4>
<section id="tau-7-14" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-14"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="e184f8d7" class="cell" data-execution_count="281">
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(vol7_7[<span class="dv">0</span>], smoothing_level <span class="op">=</span> param)</span>
<span id="cb289-4"><a href="#cb289-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb289-5"><a href="#cb289-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb289-6"><a href="#cb289-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb289-7"><a href="#cb289-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb289-8"><a href="#cb289-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-9"><a href="#cb289-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb289-10"><a href="#cb289-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="281">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>0.019004</td>
<td>0.053951</td>
<td>0.002911</td>
<td>0.312482</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>0.016768</td>
<td>0.049053</td>
<td>0.002406</td>
<td>0.431635</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>0.015059</td>
<td>0.045384</td>
<td>0.002060</td>
<td>0.513477</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>0.013717</td>
<td>0.042620</td>
<td>0.001816</td>
<td>0.570938</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>0.012701</td>
<td>0.040561</td>
<td>0.001645</td>
<td>0.611401</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>0.011940</td>
<td>0.039055</td>
<td>0.001525</td>
<td>0.639726</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>0.011336</td>
<td>0.037981</td>
<td>0.001443</td>
<td>0.659258</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>0.010877</td>
<td>0.037245</td>
<td>0.001387</td>
<td>0.672334</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>0.010532</td>
<td>0.036776</td>
<td>0.001352</td>
<td>0.680547</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="a84a0a6d" class="cell" data-execution_count="282">
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb290-6"><a href="#cb290-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb290-7"><a href="#cb290-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb290-8"><a href="#cb290-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb290-9"><a href="#cb290-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-283-output-1.png" width="606" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="4bd64230" class="cell" data-execution_count="283">
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_7[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a>vol7_7_se <span class="op">=</span> model.smooth()</span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a>metrics_vol7_7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, vol7_7[<span class="dv">0</span>], vol7_7_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-284-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-284-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="700ee94c" class="cell" data-execution_count="284">
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_7[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a>vol7_7_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-4"><a href="#cb293-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_7[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb293-5"><a href="#cb293-5" aria-hidden="true" tabindex="-1"></a>vol7_7_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb293-6"><a href="#cb293-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-7"><a href="#cb293-7" aria-hidden="true" tabindex="-1"></a>metrics_vol7_7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, vol7_7[<span class="dv">1</span>], vol7_7_se_val)</span>
<span id="cb293-8"><a href="#cb293-8" aria-hidden="true" tabindex="-1"></a>metrics_vol7_7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, vol7_7[<span class="dv">2</span>], vol7_7_se_test)</span>
<span id="cb293-9"><a href="#cb293-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-10"><a href="#cb293-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol7_7, metrics_vol7_7_val, metrics_vol7_7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="284">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>NaN</td>
<td>0.010532</td>
<td>0.036776</td>
<td>0.001352</td>
<td>0.680547</td>
<td>5.398223e-219</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>37.628912</td>
<td>0.004382</td>
<td>0.005421</td>
<td>0.000029</td>
<td>-1.261051</td>
<td>7.971377e-01</td>
<td>0.133831</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>24.447876</td>
<td>0.003538</td>
<td>0.004207</td>
<td>0.000018</td>
<td>-0.361579</td>
<td>6.168363e-01</td>
<td>0.873767</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="00025783" class="cell" data-execution_count="285">
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol7_7[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol7_7[<span class="dv">1</span>], vol7_7[<span class="dv">2</span>], vol7_7_se, vol7_7_se_val, vol7_7_se_test)</span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol7_7.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-14" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-14"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="5cf058ae" class="cell" data-execution_count="287">
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_14[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a>vol7_14_se <span class="op">=</span> model.smooth()</span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-4"><a href="#cb295-4" aria-hidden="true" tabindex="-1"></a>metrics_vol7_14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, vol7_14[<span class="dv">0</span>], vol7_14_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-288-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-288-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="22b2ec73" class="cell" data-execution_count="288">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_14[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>vol7_14_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_14[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a>vol7_14_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb297-6"><a href="#cb297-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-7"><a href="#cb297-7" aria-hidden="true" tabindex="-1"></a>metrics_vol7_14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, vol7_14[<span class="dv">1</span>], vol7_14_se_val)</span>
<span id="cb297-8"><a href="#cb297-8" aria-hidden="true" tabindex="-1"></a>metrics_vol7_14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, vol7_14[<span class="dv">2</span>], vol7_14_se_test)</span>
<span id="cb297-9"><a href="#cb297-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-10"><a href="#cb297-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol7_14, metrics_vol7_14_val, metrics_vol7_14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="288">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>NaN</td>
<td>0.010532</td>
<td>0.036776</td>
<td>0.001352</td>
<td>0.680547</td>
<td>5.398223e-219</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>18.763997</td>
<td>0.002579</td>
<td>0.003219</td>
<td>0.000010</td>
<td>0.363582</td>
<td>5.166919e-01</td>
<td>0.608130</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>25.542794</td>
<td>0.002916</td>
<td>0.004003</td>
<td>0.000016</td>
<td>0.015807</td>
<td>7.364931e-01</td>
<td>0.000651</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="c96a004e" class="cell" data-execution_count="289">
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol7_14[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol7_14[<span class="dv">1</span>], vol7_14[<span class="dv">2</span>], vol7_14_se, vol7_14_se_val, vol7_14_se_test)</span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol7_14.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-14" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-14"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="9c4e13e6" class="cell" data-execution_count="291">
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_21[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a>vol7_21_se <span class="op">=</span> model.smooth()</span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a>metrics_vol7_21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, vol7_21[<span class="dv">0</span>], vol7_21_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-292-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-292-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="213bb5e4" class="cell" data-execution_count="292">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_21[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a>vol7_21_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-4"><a href="#cb301-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_21[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb301-5"><a href="#cb301-5" aria-hidden="true" tabindex="-1"></a>vol7_21_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb301-6"><a href="#cb301-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-7"><a href="#cb301-7" aria-hidden="true" tabindex="-1"></a>metrics_vol7_21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, vol7_21[<span class="dv">1</span>], vol7_21_se_val)</span>
<span id="cb301-8"><a href="#cb301-8" aria-hidden="true" tabindex="-1"></a>metrics_vol7_21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, vol7_21[<span class="dv">2</span>], vol7_21_se_test)</span>
<span id="cb301-9"><a href="#cb301-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-10"><a href="#cb301-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol7_21, metrics_vol7_21_val, metrics_vol7_21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="292">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>NaN</td>
<td>0.010532</td>
<td>0.036776</td>
<td>0.001352</td>
<td>0.680547</td>
<td>5.398223e-219</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>67.284730</td>
<td>0.019962</td>
<td>0.023077</td>
<td>0.000533</td>
<td>-1.305010</td>
<td>9.075412e-01</td>
<td>0.185958</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>24.853723</td>
<td>0.005817</td>
<td>0.008511</td>
<td>0.000072</td>
<td>0.686491</td>
<td>8.770575e-01</td>
<td>0.560071</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="ab568dd1" class="cell" data-execution_count="293">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol7_21[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol7_21[<span class="dv">1</span>], vol7_21[<span class="dv">2</span>], vol7_21_se, vol7_21_se_val, vol7_21_se_test)</span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol7_21.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-14" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-14"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="165ed8eb" class="cell" data-execution_count="295">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_28[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>vol7_28_se <span class="op">=</span> model.smooth()</span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a>metrics_vol7_28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, vol7_28[<span class="dv">0</span>], vol7_28_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-296-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-296-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="5e607056" class="cell" data-execution_count="296">
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_28[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>vol7_28_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_28[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb305-5"><a href="#cb305-5" aria-hidden="true" tabindex="-1"></a>vol7_28_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb305-6"><a href="#cb305-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-7"><a href="#cb305-7" aria-hidden="true" tabindex="-1"></a>metrics_vol7_28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, vol7_28[<span class="dv">1</span>], vol7_28_se_val)</span>
<span id="cb305-8"><a href="#cb305-8" aria-hidden="true" tabindex="-1"></a>metrics_vol7_28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, vol7_28[<span class="dv">2</span>], vol7_28_se_test)</span>
<span id="cb305-9"><a href="#cb305-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-10"><a href="#cb305-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol7_28, metrics_vol7_28_val, metrics_vol7_28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="296">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>NaN</td>
<td>0.010532</td>
<td>0.036776</td>
<td>0.001352</td>
<td>0.680547</td>
<td>5.398223e-219</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>56.155201</td>
<td>0.025201</td>
<td>0.029054</td>
<td>0.000844</td>
<td>-4.429505</td>
<td>7.972382e-01</td>
<td>0.034458</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>23.450565</td>
<td>0.007974</td>
<td>0.011143</td>
<td>0.000124</td>
<td>0.201312</td>
<td>1.851997e-02</td>
<td>0.696147</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="b2d0297f" class="cell" data-execution_count="297">
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol7_28[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol7_28[<span class="dv">1</span>], vol7_28[<span class="dv">2</span>], vol7_28_se, vol7_28_se_val, vol7_28_se_test)</span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol7_28.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="a68679f3" class="cell" data-execution_count="299">
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a>metrics_vol7 <span class="op">=</span> pd.concat([</span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>    metrics_vol7_7, metrics_vol7_7_val, metrics_vol7_7_test,</span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a>    metrics_vol7_14, metrics_vol7_14_val, metrics_vol7_14_test,</span>
<span id="cb307-4"><a href="#cb307-4" aria-hidden="true" tabindex="-1"></a>    metrics_vol7_21, metrics_vol7_21_val, metrics_vol7_21_test,</span>
<span id="cb307-5"><a href="#cb307-5" aria-hidden="true" tabindex="-1"></a>    metrics_vol7_28, metrics_vol7_28_val, metrics_vol7_28_test</span>
<span id="cb307-6"><a href="#cb307-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="volatilidad-omega-14-2" class="level4">
<h4 class="anchored" data-anchor-id="volatilidad-omega-14-2">Volatilidad <span class="math inline">\(\omega = 14\)</span></h4>
<section id="tau-7-15" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-15"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="f066af27" class="cell" data-execution_count="300">
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(vol14_7[<span class="dv">0</span>], smoothing_level <span class="op">=</span> param)</span>
<span id="cb308-4"><a href="#cb308-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb308-5"><a href="#cb308-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb308-6"><a href="#cb308-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb308-7"><a href="#cb308-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb308-8"><a href="#cb308-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-9"><a href="#cb308-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb308-10"><a href="#cb308-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="300">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>0.014361</td>
<td>0.043906</td>
<td>0.001928</td>
<td>0.511511</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>0.010759</td>
<td>0.036137</td>
<td>0.001306</td>
<td>0.669093</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>0.008880</td>
<td>0.031524</td>
<td>0.000994</td>
<td>0.748183</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>0.007712</td>
<td>0.028696</td>
<td>0.000823</td>
<td>0.791334</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>0.006944</td>
<td>0.026903</td>
<td>0.000724</td>
<td>0.816595</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>0.006409</td>
<td>0.025734</td>
<td>0.000662</td>
<td>0.832185</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>0.006021</td>
<td>0.024964</td>
<td>0.000623</td>
<td>0.842086</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>0.005731</td>
<td>0.024463</td>
<td>0.000598</td>
<td>0.848356</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>0.005515</td>
<td>0.024158</td>
<td>0.000584</td>
<td>0.852115</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="4f5ee8dc" class="cell" data-execution_count="301">
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb309-4"><a href="#cb309-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb309-5"><a href="#cb309-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb309-6"><a href="#cb309-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb309-7"><a href="#cb309-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb309-8"><a href="#cb309-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb309-9"><a href="#cb309-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-302-output-1.png" width="606" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="cbee4e5c" class="cell" data-execution_count="302">
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_7[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a>vol14_7_se <span class="op">=</span> model.smooth()</span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-4"><a href="#cb310-4" aria-hidden="true" tabindex="-1"></a>metrics_vol14_7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, vol14_7[<span class="dv">0</span>], vol14_7_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-303-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-303-output-2.png" width="711" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="e96b2b43" class="cell" data-execution_count="303">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_7[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a>vol14_7_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_7[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb312-5"><a href="#cb312-5" aria-hidden="true" tabindex="-1"></a>vol14_7_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb312-6"><a href="#cb312-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-7"><a href="#cb312-7" aria-hidden="true" tabindex="-1"></a>metrics_vol14_7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, vol14_7[<span class="dv">1</span>], vol14_7_se_val)</span>
<span id="cb312-8"><a href="#cb312-8" aria-hidden="true" tabindex="-1"></a>metrics_vol14_7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, vol14_7[<span class="dv">2</span>], vol14_7_se_test)</span>
<span id="cb312-9"><a href="#cb312-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-10"><a href="#cb312-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol14_7, metrics_vol14_7_val, metrics_vol14_7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="303">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>NaN</td>
<td>0.005515</td>
<td>0.024158</td>
<td>5.836072e-04</td>
<td>0.852115</td>
<td>3.661844e-46</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>33.823503</td>
<td>0.005510</td>
<td>0.006004</td>
<td>3.605256e-05</td>
<td>-127.652529</td>
<td>7.904339e-01</td>
<td>0.082897</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>4.052057</td>
<td>0.000671</td>
<td>0.000833</td>
<td>6.947101e-07</td>
<td>-1.479053</td>
<td>9.197661e-01</td>
<td>0.916042</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="772e0867" class="cell" data-execution_count="304">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol14_7[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol14_7[<span class="dv">1</span>], vol14_7[<span class="dv">2</span>], vol14_7_se, vol14_7_se_val, vol14_7_se_test)</span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol14_7.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-15" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-15"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="4d6df8fb" class="cell" data-execution_count="306">
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_14[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a>vol14_14_se <span class="op">=</span> model.smooth()</span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a>metrics_vol14_14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, vol14_14[<span class="dv">0</span>], vol14_14_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-307-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-307-output-2.png" width="711" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="cd9575c4" class="cell" data-execution_count="307">
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_14[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a>vol14_14_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_14[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb316-5"><a href="#cb316-5" aria-hidden="true" tabindex="-1"></a>vol14_14_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb316-6"><a href="#cb316-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-7"><a href="#cb316-7" aria-hidden="true" tabindex="-1"></a>metrics_vol14_14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, vol14_14[<span class="dv">1</span>], vol14_14_se_val)</span>
<span id="cb316-8"><a href="#cb316-8" aria-hidden="true" tabindex="-1"></a>metrics_vol14_14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, vol14_14[<span class="dv">2</span>], vol14_14_se_test)</span>
<span id="cb316-9"><a href="#cb316-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-10"><a href="#cb316-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol14_14, metrics_vol14_14_val, metrics_vol14_14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="307">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>NaN</td>
<td>0.005515</td>
<td>0.024158</td>
<td>5.836072e-04</td>
<td>0.852115</td>
<td>3.661844e-46</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>20.689774</td>
<td>0.003483</td>
<td>0.004332</td>
<td>1.877001e-05</td>
<td>-57.072766</td>
<td>6.315728e-01</td>
<td>0.000001</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>3.756666</td>
<td>0.000633</td>
<td>0.000757</td>
<td>5.729753e-07</td>
<td>-0.772735</td>
<td>1.073652e-01</td>
<td>0.220719</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="55ee5e32" class="cell" data-execution_count="308">
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol14_14[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol14_14[<span class="dv">1</span>], vol14_14[<span class="dv">2</span>], vol14_14_se, vol14_14_se_val, vol14_14_se_test)</span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol14_14.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-15" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-15"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="6b77b8f8" class="cell" data-execution_count="310">
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_21[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a>vol14_21_se <span class="op">=</span> model.smooth()</span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-4"><a href="#cb318-4" aria-hidden="true" tabindex="-1"></a>metrics_vol14_21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, vol14_21[<span class="dv">0</span>], vol14_21_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-311-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-311-output-2.png" width="711" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="f940ca89" class="cell" data-execution_count="311">
<div class="sourceCode cell-code" id="cb320"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_21[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true" tabindex="-1"></a>vol14_21_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb320-3"><a href="#cb320-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-4"><a href="#cb320-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_21[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb320-5"><a href="#cb320-5" aria-hidden="true" tabindex="-1"></a>vol14_21_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb320-6"><a href="#cb320-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-7"><a href="#cb320-7" aria-hidden="true" tabindex="-1"></a>metrics_vol14_21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, vol14_21[<span class="dv">1</span>], vol14_21_se_val)</span>
<span id="cb320-8"><a href="#cb320-8" aria-hidden="true" tabindex="-1"></a>metrics_vol14_21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, vol14_21[<span class="dv">2</span>], vol14_21_se_test)</span>
<span id="cb320-9"><a href="#cb320-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-10"><a href="#cb320-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol14_21, metrics_vol14_21_val, metrics_vol14_21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="311">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>NaN</td>
<td>0.005515</td>
<td>0.024158</td>
<td>0.000584</td>
<td>0.852115</td>
<td>3.661844e-46</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>41.685487</td>
<td>0.013470</td>
<td>0.016199</td>
<td>0.000262</td>
<td>-1.520083</td>
<td>7.230675e-01</td>
<td>3.959695e-18</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>9.584982</td>
<td>0.002913</td>
<td>0.004743</td>
<td>0.000022</td>
<td>0.783916</td>
<td>9.533840e-02</td>
<td>6.906289e-04</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="9b74e944" class="cell" data-execution_count="312">
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol14_21[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol14_21[<span class="dv">1</span>], vol14_21[<span class="dv">2</span>], vol14_21_se, vol14_21_se_val, vol14_21_se_test)</span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol14_21.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-15" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-15"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="5de22fda" class="cell" data-execution_count="314">
<div class="sourceCode cell-code" id="cb322"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_28[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb322-2"><a href="#cb322-2" aria-hidden="true" tabindex="-1"></a>vol14_28_se <span class="op">=</span> model.smooth()</span>
<span id="cb322-3"><a href="#cb322-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-4"><a href="#cb322-4" aria-hidden="true" tabindex="-1"></a>metrics_vol14_28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, vol14_28[<span class="dv">0</span>], vol14_28_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-315-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-315-output-2.png" width="711" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="cb4427ba" class="cell" data-execution_count="315">
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_28[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a>vol14_28_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-4"><a href="#cb324-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_28[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb324-5"><a href="#cb324-5" aria-hidden="true" tabindex="-1"></a>vol14_28_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb324-6"><a href="#cb324-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-7"><a href="#cb324-7" aria-hidden="true" tabindex="-1"></a>metrics_vol14_28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, vol14_28[<span class="dv">1</span>], vol14_28_se_val)</span>
<span id="cb324-8"><a href="#cb324-8" aria-hidden="true" tabindex="-1"></a>metrics_vol14_28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, vol14_28[<span class="dv">2</span>], vol14_28_se_test)</span>
<span id="cb324-9"><a href="#cb324-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-10"><a href="#cb324-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol14_28, metrics_vol14_28_val, metrics_vol14_28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="315">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>NaN</td>
<td>0.005515</td>
<td>0.024158</td>
<td>0.000584</td>
<td>0.852115</td>
<td>3.661844e-46</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>48.322368</td>
<td>0.019203</td>
<td>0.020935</td>
<td>0.000438</td>
<td>-8.715676</td>
<td>7.769449e-01</td>
<td>6.949045e-33</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>10.221859</td>
<td>0.003779</td>
<td>0.005210</td>
<td>0.000027</td>
<td>0.398179</td>
<td>8.146092e-02</td>
<td>4.263438e-01</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="72c094a1" class="cell" data-execution_count="316">
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol14_28[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol14_28[<span class="dv">1</span>], vol14_28[<span class="dv">2</span>], vol14_28_se, vol14_28_se_val, vol14_28_se_test)</span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol14_28.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="4db45f55" class="cell" data-execution_count="318">
<div class="sourceCode cell-code" id="cb326"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a>metrics_vol14 <span class="op">=</span> pd.concat([</span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a>    metrics_vol14_7, metrics_vol14_7_val, metrics_vol14_7_test,</span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a>    metrics_vol14_14, metrics_vol14_14_val, metrics_vol14_14_test,</span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a>    metrics_vol14_21, metrics_vol14_21_val, metrics_vol14_21_test,</span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a>    metrics_vol14_28, metrics_vol14_28_val, metrics_vol14_28_test</span>
<span id="cb326-6"><a href="#cb326-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="volatilidad-omega-21-2" class="level4">
<h4 class="anchored" data-anchor-id="volatilidad-omega-21-2">Volatilidad <span class="math inline">\(\omega = 21\)</span></h4>
<section id="tau-7-16" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-16"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="3a4dcbcd" class="cell" data-execution_count="319">
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(vol21_7[<span class="dv">0</span>], smoothing_level <span class="op">=</span> param)</span>
<span id="cb327-4"><a href="#cb327-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb327-5"><a href="#cb327-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb327-6"><a href="#cb327-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb327-7"><a href="#cb327-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb327-8"><a href="#cb327-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb327-9"><a href="#cb327-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb327-10"><a href="#cb327-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="319">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>0.011977</td>
<td>0.037543</td>
<td>0.001409</td>
<td>0.629595</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>0.008228</td>
<td>0.029254</td>
<td>0.000856</td>
<td>0.775093</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>0.006499</td>
<td>0.025110</td>
<td>0.000630</td>
<td>0.834308</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>0.005543</td>
<td>0.022778</td>
<td>0.000519</td>
<td>0.863656</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>0.004951</td>
<td>0.021346</td>
<td>0.000456</td>
<td>0.880255</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>0.004547</td>
<td>0.020424</td>
<td>0.000417</td>
<td>0.890372</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>0.004251</td>
<td>0.019822</td>
<td>0.000393</td>
<td>0.896747</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>0.004034</td>
<td>0.019434</td>
<td>0.000378</td>
<td>0.900745</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>0.003870</td>
<td>0.019202</td>
<td>0.000369</td>
<td>0.903106</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="383040af" class="cell" data-execution_count="320">
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb328-6"><a href="#cb328-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb328-7"><a href="#cb328-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb328-8"><a href="#cb328-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb328-9"><a href="#cb328-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-321-output-1.png" width="606" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="b76bcba2" class="cell" data-execution_count="321">
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_7[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a>vol21_7_se <span class="op">=</span> model.smooth()</span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-4"><a href="#cb329-4" aria-hidden="true" tabindex="-1"></a>metrics_vol21_7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, vol21_7[<span class="dv">0</span>], vol21_7_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-322-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-322-output-2.png" width="728" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="bd19fdf0" class="cell" data-execution_count="322">
<div class="sourceCode cell-code" id="cb331"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_7[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a>vol21_7_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb331-3"><a href="#cb331-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-4"><a href="#cb331-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_7[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb331-5"><a href="#cb331-5" aria-hidden="true" tabindex="-1"></a>vol21_7_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb331-6"><a href="#cb331-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-7"><a href="#cb331-7" aria-hidden="true" tabindex="-1"></a>metrics_vol21_7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, vol21_7[<span class="dv">1</span>], vol21_7_se_val)</span>
<span id="cb331-8"><a href="#cb331-8" aria-hidden="true" tabindex="-1"></a>metrics_vol21_7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, vol21_7[<span class="dv">2</span>], vol21_7_se_test)</span>
<span id="cb331-9"><a href="#cb331-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-10"><a href="#cb331-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol21_7, metrics_vol21_7_val, metrics_vol21_7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="322">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>NaN</td>
<td>0.003870</td>
<td>0.019202</td>
<td>3.687029e-04</td>
<td>0.903106</td>
<td>3.427794e-46</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>24.639399</td>
<td>0.004875</td>
<td>0.005659</td>
<td>3.202053e-05</td>
<td>-93.863726</td>
<td>9.767082e-01</td>
<td>0.063760</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>2.275079</td>
<td>0.000456</td>
<td>0.000654</td>
<td>4.281579e-07</td>
<td>-0.268456</td>
<td>4.601006e-01</td>
<td>0.973017</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="956c7588" class="cell" data-execution_count="323">
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol21_7[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol21_7[<span class="dv">1</span>], vol21_7[<span class="dv">2</span>], vol21_7_se, vol21_7_se_val, vol21_7_se_test)</span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol21_7.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-16" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-16"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="417d2e58" class="cell" data-execution_count="325">
<div class="sourceCode cell-code" id="cb333"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_14[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a>vol21_14_se <span class="op">=</span> model.smooth()</span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a>metrics_vol21_14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, vol21_14[<span class="dv">0</span>], vol21_14_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-326-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-326-output-2.png" width="728" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="269dc7b9" class="cell" data-execution_count="326">
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_14[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a>vol21_14_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb335-3"><a href="#cb335-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-4"><a href="#cb335-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_14[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb335-5"><a href="#cb335-5" aria-hidden="true" tabindex="-1"></a>vol21_14_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb335-6"><a href="#cb335-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-7"><a href="#cb335-7" aria-hidden="true" tabindex="-1"></a>metrics_vol21_14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, vol21_14[<span class="dv">1</span>], vol21_14_se_val)</span>
<span id="cb335-8"><a href="#cb335-8" aria-hidden="true" tabindex="-1"></a>metrics_vol21_14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, vol21_14[<span class="dv">2</span>], vol21_14_se_test)</span>
<span id="cb335-9"><a href="#cb335-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-10"><a href="#cb335-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol21_14, metrics_vol21_14_val, metrics_vol21_14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="326">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>NaN</td>
<td>0.003870</td>
<td>0.019202</td>
<td>3.687029e-04</td>
<td>0.903106</td>
<td>3.427794e-46</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>32.155220</td>
<td>0.005409</td>
<td>0.006234</td>
<td>3.885917e-05</td>
<td>-87.343266</td>
<td>9.018262e-01</td>
<td>6.074575e-08</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>4.408937</td>
<td>0.000741</td>
<td>0.000901</td>
<td>8.110631e-07</td>
<td>-0.843888</td>
<td>3.785980e-01</td>
<td>3.502899e-01</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="20a678ca" class="cell" data-execution_count="327">
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol21_14[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol21_14[<span class="dv">1</span>], vol21_14[<span class="dv">2</span>], vol21_14_se, vol21_14_se_val, vol21_14_se_test)</span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol21_14.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-16" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-16"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="dba11850" class="cell" data-execution_count="329">
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_21[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true" tabindex="-1"></a>vol21_21_se <span class="op">=</span> model.smooth()</span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true" tabindex="-1"></a>metrics_vol21_21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, vol21_21[<span class="dv">0</span>], vol21_21_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-330-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-330-output-2.png" width="728" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="f5fa27cb" class="cell" data-execution_count="330">
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_21[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a>vol21_21_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-4"><a href="#cb339-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_21[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb339-5"><a href="#cb339-5" aria-hidden="true" tabindex="-1"></a>vol21_21_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb339-6"><a href="#cb339-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-7"><a href="#cb339-7" aria-hidden="true" tabindex="-1"></a>metrics_vol21_21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, vol21_21[<span class="dv">1</span>], vol21_21_se_val)</span>
<span id="cb339-8"><a href="#cb339-8" aria-hidden="true" tabindex="-1"></a>metrics_vol21_21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, vol21_21[<span class="dv">2</span>], vol21_21_se_test)</span>
<span id="cb339-9"><a href="#cb339-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-10"><a href="#cb339-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol21_21, metrics_vol21_21_val, metrics_vol21_21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="330">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>NaN</td>
<td>0.003870</td>
<td>0.019202</td>
<td>0.000369</td>
<td>0.903106</td>
<td>3.427794e-46</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>39.490052</td>
<td>0.010181</td>
<td>0.011634</td>
<td>0.000135</td>
<td>-1.179671</td>
<td>4.597669e-01</td>
<td>5.724525e-07</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>7.883541</td>
<td>0.002106</td>
<td>0.003458</td>
<td>0.000012</td>
<td>0.807484</td>
<td>1.146190e-01</td>
<td>5.402006e-04</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="fca27d59" class="cell" data-execution_count="331">
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol21_21[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol21_21[<span class="dv">1</span>], vol21_21[<span class="dv">2</span>], vol21_21_se, vol21_21_se_val, vol21_21_se_test)</span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol21_21.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-16" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-16"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="2561548d" class="cell" data-execution_count="333">
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_28[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a>vol21_28_se <span class="op">=</span> model.smooth()</span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true" tabindex="-1"></a>metrics_vol21_28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, vol21_28[<span class="dv">0</span>], vol21_28_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-334-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-334-output-2.png" width="728" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="a1d45e17" class="cell" data-execution_count="334">
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_28[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a>vol21_28_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-4"><a href="#cb343-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_28[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb343-5"><a href="#cb343-5" aria-hidden="true" tabindex="-1"></a>vol21_28_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb343-6"><a href="#cb343-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-7"><a href="#cb343-7" aria-hidden="true" tabindex="-1"></a>metrics_vol21_28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, vol21_28[<span class="dv">1</span>], vol21_28_se_val)</span>
<span id="cb343-8"><a href="#cb343-8" aria-hidden="true" tabindex="-1"></a>metrics_vol21_28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, vol21_28[<span class="dv">2</span>], vol21_28_se_test)</span>
<span id="cb343-9"><a href="#cb343-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-10"><a href="#cb343-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol21_28, metrics_vol21_28_val, metrics_vol21_28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="334">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>NaN</td>
<td>0.003870</td>
<td>0.019202</td>
<td>0.000369</td>
<td>0.903106</td>
<td>3.427794e-46</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>41.624074</td>
<td>0.016049</td>
<td>0.018614</td>
<td>0.000346</td>
<td>-5.760398</td>
<td>5.223368e-01</td>
<td>5.210346e-17</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>6.174221</td>
<td>0.002060</td>
<td>0.003240</td>
<td>0.000010</td>
<td>0.795153</td>
<td>4.854350e-01</td>
<td>7.161414e-05</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="518410ab" class="cell" data-execution_count="335">
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol21_28[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol21_28[<span class="dv">1</span>], vol21_28[<span class="dv">2</span>], vol21_28_se, vol21_28_se_val, vol21_28_se_test)</span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol21_28.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="25e0d28c" class="cell" data-execution_count="337">
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a>metrics_vol21 <span class="op">=</span> pd.concat([</span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a>    metrics_vol21_7, metrics_vol21_7_val, metrics_vol21_7_test,</span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true" tabindex="-1"></a>    metrics_vol21_14, metrics_vol21_14_val, metrics_vol21_14_test,</span>
<span id="cb345-4"><a href="#cb345-4" aria-hidden="true" tabindex="-1"></a>    metrics_vol21_21, metrics_vol21_21_val, metrics_vol21_21_test,</span>
<span id="cb345-5"><a href="#cb345-5" aria-hidden="true" tabindex="-1"></a>    metrics_vol21_28, metrics_vol21_28_val, metrics_vol21_28_test</span>
<span id="cb345-6"><a href="#cb345-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="volatilidad-omega-28-2" class="level4">
<h4 class="anchored" data-anchor-id="volatilidad-omega-28-2">Volatilidad <span class="math inline">\(\omega = 28\)</span></h4>
<section id="tau-7-17" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-17"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="279145ce" class="cell" data-execution_count="338">
<div class="sourceCode cell-code" id="cb346"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb346-3"><a href="#cb346-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(vol28_7[<span class="dv">0</span>], smoothing_level <span class="op">=</span> param)</span>
<span id="cb346-4"><a href="#cb346-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb346-5"><a href="#cb346-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb346-6"><a href="#cb346-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb346-7"><a href="#cb346-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb346-8"><a href="#cb346-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-9"><a href="#cb346-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb346-10"><a href="#cb346-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="338">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>0.010221</td>
<td>0.032930</td>
<td>0.001084</td>
<td>0.707122</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>0.006674</td>
<td>0.024917</td>
<td>0.000621</td>
<td>0.832307</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>0.005232</td>
<td>0.021289</td>
<td>0.000453</td>
<td>0.877593</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>0.004451</td>
<td>0.019303</td>
<td>0.000373</td>
<td>0.899359</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>0.003956</td>
<td>0.018093</td>
<td>0.000327</td>
<td>0.911582</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>0.003620</td>
<td>0.017316</td>
<td>0.000300</td>
<td>0.919013</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>0.003376</td>
<td>0.016809</td>
<td>0.000283</td>
<td>0.923684</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>0.003193</td>
<td>0.016485</td>
<td>0.000272</td>
<td>0.926600</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>0.003055</td>
<td>0.016293</td>
<td>0.000265</td>
<td>0.928302</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="a5537f95" class="cell" data-execution_count="339">
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb347-4"><a href="#cb347-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb347-5"><a href="#cb347-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb347-6"><a href="#cb347-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb347-7"><a href="#cb347-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb347-8"><a href="#cb347-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb347-9"><a href="#cb347-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-340-output-1.png" width="606" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="5c35f56a" class="cell" data-execution_count="340">
<div class="sourceCode cell-code" id="cb348"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_7[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a>vol28_7_se <span class="op">=</span> model.smooth()</span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true" tabindex="-1"></a>metrics_vol28_7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, vol28_7[<span class="dv">0</span>], vol28_7_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-341-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-341-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="faee137f" class="cell" data-execution_count="341">
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_7[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a>vol28_7_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_7[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a>vol28_7_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-7"><a href="#cb350-7" aria-hidden="true" tabindex="-1"></a>metrics_vol28_7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, vol28_7[<span class="dv">1</span>], vol28_7_se_val)</span>
<span id="cb350-8"><a href="#cb350-8" aria-hidden="true" tabindex="-1"></a>metrics_vol28_7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, vol28_7[<span class="dv">2</span>], vol28_7_se_test)</span>
<span id="cb350-9"><a href="#cb350-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-10"><a href="#cb350-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol28_7, metrics_vol28_7_val, metrics_vol28_7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="341">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>NaN</td>
<td>0.003055</td>
<td>0.016293</td>
<td>0.000265</td>
<td>0.928302</td>
<td>2.080088e-42</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>24.090786</td>
<td>0.005197</td>
<td>0.005680</td>
<td>0.000032</td>
<td>-10.081326</td>
<td>4.853045e-01</td>
<td>0.363816</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>6.550145</td>
<td>0.001370</td>
<td>0.001931</td>
<td>0.000004</td>
<td>-0.280476</td>
<td>9.865148e-01</td>
<td>0.180878</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="98387e23" class="cell" data-execution_count="342">
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol28_7[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol28_7[<span class="dv">1</span>], vol28_7[<span class="dv">2</span>], vol28_7_se, vol28_7_se_val, vol28_7_se_test)</span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol28_7.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-17" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-17"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="4c5609f6" class="cell" data-execution_count="344">
<div class="sourceCode cell-code" id="cb352"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_14[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a>vol28_14_se <span class="op">=</span> model.smooth()</span>
<span id="cb352-3"><a href="#cb352-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-4"><a href="#cb352-4" aria-hidden="true" tabindex="-1"></a>metrics_vol28_14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, vol28_14[<span class="dv">0</span>], vol28_14_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-345-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-345-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="9782d48d" class="cell" data-execution_count="345">
<div class="sourceCode cell-code" id="cb354"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_14[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a>vol28_14_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_14[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb354-5"><a href="#cb354-5" aria-hidden="true" tabindex="-1"></a>vol28_14_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb354-6"><a href="#cb354-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-7"><a href="#cb354-7" aria-hidden="true" tabindex="-1"></a>metrics_vol28_14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, vol28_14[<span class="dv">1</span>], vol28_14_se_val)</span>
<span id="cb354-8"><a href="#cb354-8" aria-hidden="true" tabindex="-1"></a>metrics_vol28_14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, vol28_14[<span class="dv">2</span>], vol28_14_se_test)</span>
<span id="cb354-9"><a href="#cb354-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-10"><a href="#cb354-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol28_14, metrics_vol28_14_val, metrics_vol28_14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="345">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>NaN</td>
<td>0.003055</td>
<td>0.016293</td>
<td>0.000265</td>
<td>0.928302</td>
<td>2.080088e-42</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>40.176470</td>
<td>0.007236</td>
<td>0.007645</td>
<td>0.000058</td>
<td>-15.313175</td>
<td>3.171246e-01</td>
<td>0.055724</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>5.134818</td>
<td>0.000891</td>
<td>0.001376</td>
<td>0.000002</td>
<td>0.471169</td>
<td>1.825919e-01</td>
<td>0.006916</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="49a140cb" class="cell" data-execution_count="346">
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol28_14[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol28_14[<span class="dv">1</span>], vol28_14[<span class="dv">2</span>], vol28_14_se, vol28_14_se_val, vol28_14_se_test)</span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol28_14.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-17" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-17"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="88c34368" class="cell" data-execution_count="348">
<div class="sourceCode cell-code" id="cb356"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_21[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb356-2"><a href="#cb356-2" aria-hidden="true" tabindex="-1"></a>vol28_21_se <span class="op">=</span> model.smooth()</span>
<span id="cb356-3"><a href="#cb356-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-4"><a href="#cb356-4" aria-hidden="true" tabindex="-1"></a>metrics_vol28_21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, vol28_21[<span class="dv">0</span>], vol28_21_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-349-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-349-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="470ee3ac" class="cell" data-execution_count="349">
<div class="sourceCode cell-code" id="cb358"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_21[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true" tabindex="-1"></a>vol28_21_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb358-3"><a href="#cb358-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-4"><a href="#cb358-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_21[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb358-5"><a href="#cb358-5" aria-hidden="true" tabindex="-1"></a>vol28_21_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb358-6"><a href="#cb358-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-7"><a href="#cb358-7" aria-hidden="true" tabindex="-1"></a>metrics_vol28_21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, vol28_21[<span class="dv">1</span>], vol28_21_se_val)</span>
<span id="cb358-8"><a href="#cb358-8" aria-hidden="true" tabindex="-1"></a>metrics_vol28_21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, vol28_21[<span class="dv">2</span>], vol28_21_se_test)</span>
<span id="cb358-9"><a href="#cb358-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-10"><a href="#cb358-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol28_21, metrics_vol28_21_val, metrics_vol28_21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="349">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>NaN</td>
<td>0.003055</td>
<td>0.016293</td>
<td>0.000265</td>
<td>0.928302</td>
<td>2.080088e-42</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>37.953130</td>
<td>0.008205</td>
<td>0.009337</td>
<td>0.000087</td>
<td>-1.189503</td>
<td>1.525188e-01</td>
<td>0.000680</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>7.330286</td>
<td>0.001812</td>
<td>0.002927</td>
<td>0.000009</td>
<td>0.784885</td>
<td>1.883750e-01</td>
<td>0.000639</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="a2840684" class="cell" data-execution_count="350">
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol28_21[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol28_21[<span class="dv">1</span>], vol28_21[<span class="dv">2</span>], vol28_21_se, vol28_21_se_val, vol28_21_se_test)</span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol28_21.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-17" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-17"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="0a398f44" class="cell" data-execution_count="352">
<div class="sourceCode cell-code" id="cb360"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_28[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb360-2"><a href="#cb360-2" aria-hidden="true" tabindex="-1"></a>vol28_28_se <span class="op">=</span> model.smooth()</span>
<span id="cb360-3"><a href="#cb360-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-4"><a href="#cb360-4" aria-hidden="true" tabindex="-1"></a>metrics_vol28_28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, vol28_28[<span class="dv">0</span>], vol28_28_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-353-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-353-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="507b41a7" class="cell" data-execution_count="353">
<div class="sourceCode cell-code" id="cb362"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_28[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true" tabindex="-1"></a>vol28_28_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb362-3"><a href="#cb362-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-4"><a href="#cb362-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_28[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb362-5"><a href="#cb362-5" aria-hidden="true" tabindex="-1"></a>vol28_28_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb362-6"><a href="#cb362-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-7"><a href="#cb362-7" aria-hidden="true" tabindex="-1"></a>metrics_vol28_28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, vol28_28[<span class="dv">1</span>], vol28_28_se_val)</span>
<span id="cb362-8"><a href="#cb362-8" aria-hidden="true" tabindex="-1"></a>metrics_vol28_28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, vol28_28[<span class="dv">2</span>], vol28_28_se_test)</span>
<span id="cb362-9"><a href="#cb362-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-10"><a href="#cb362-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol28_28, metrics_vol28_28_val, metrics_vol28_28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="353">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>NaN</td>
<td>0.003055</td>
<td>0.016293</td>
<td>0.000265</td>
<td>0.928302</td>
<td>2.080088e-42</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>33.769083</td>
<td>0.012103</td>
<td>0.014920</td>
<td>0.000223</td>
<td>-3.125747</td>
<td>9.645792e-03</td>
<td>0.000266</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>6.719563</td>
<td>0.002137</td>
<td>0.003148</td>
<td>0.000010</td>
<td>0.816352</td>
<td>2.064221e-01</td>
<td>0.003490</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="10b1ef15" class="cell" data-execution_count="354">
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol28_28[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol28_28[<span class="dv">1</span>], vol28_28[<span class="dv">2</span>], vol28_28_se, vol28_28_se_val, vol28_28_se_test)</span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol28_28.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="7e55b06f" class="cell" data-execution_count="356">
<div class="sourceCode cell-code" id="cb364"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a>metrics_vol28 <span class="op">=</span> pd.concat([</span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a>    metrics_vol28_7, metrics_vol28_7_val, metrics_vol28_7_test,</span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a>    metrics_vol28_14, metrics_vol28_14_val, metrics_vol28_14_test,</span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a>    metrics_vol28_21, metrics_vol28_21_val, metrics_vol28_21_test,</span>
<span id="cb364-5"><a href="#cb364-5" aria-hidden="true" tabindex="-1"></a>    metrics_vol28_28, metrics_vol28_28_val, metrics_vol28_28_test</span>
<span id="cb364-6"><a href="#cb364-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="caso-doble-usando-statsmodels" class="level3">
<h3 class="anchored" data-anchor-id="caso-doble-usando-statsmodels">Caso doble usando <code>statsmodels</code></h3>
<section id="price-3" class="level4">
<h4 class="anchored" data-anchor-id="price-3">Price</h4>
<section id="tau-7-18" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-18"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="ae5a2cc0" class="cell" data-execution_count="357">
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(price7_se, smoothing_level <span class="op">=</span> param)</span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb365-5"><a href="#cb365-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb365-6"><a href="#cb365-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb365-7"><a href="#cb365-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb365-8"><a href="#cb365-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-9"><a href="#cb365-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb365-10"><a href="#cb365-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="357">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.798789</td>
<td>732.721036</td>
<td>1671.422857</td>
<td>2.793654e+06</td>
<td>0.987841</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>6.511403</td>
<td>536.440785</td>
<td>1263.717826</td>
<td>1.596983e+06</td>
<td>0.993049</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5.595620</td>
<td>465.204441</td>
<td>1102.082798</td>
<td>1.214586e+06</td>
<td>0.994714</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>5.101244</td>
<td>427.164987</td>
<td>1013.637794</td>
<td>1.027462e+06</td>
<td>0.995528</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4.792659</td>
<td>402.342712</td>
<td>958.699794</td>
<td>9.191053e+05</td>
<td>0.996000</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>4.592166</td>
<td>385.640855</td>
<td>922.378692</td>
<td>8.507825e+05</td>
<td>0.996297</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>4.464190</td>
<td>374.330200</td>
<td>897.770556</td>
<td>8.059920e+05</td>
<td>0.996492</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>4.376713</td>
<td>365.854545</td>
<td>881.258653</td>
<td>7.766168e+05</td>
<td>0.996620</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>4.319775</td>
<td>360.341886</td>
<td>870.817024</td>
<td>7.583223e+05</td>
<td>0.996700</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="fc83943e" class="cell" data-execution_count="358">
<div class="sourceCode cell-code" id="cb366"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb366-5"><a href="#cb366-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb366-6"><a href="#cb366-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb366-7"><a href="#cb366-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb366-8"><a href="#cb366-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb366-9"><a href="#cb366-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-359-output-1.png" width="593" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="80b1de95" class="cell" data-execution_count="359">
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price7_se, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a>price7_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a>metrics_price7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, price7_se, price7_se2, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-360-output-1.png" width="734" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-360-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="4f63d5b0" class="cell" data-execution_count="360">
<div class="sourceCode cell-code" id="cb369"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price7_se_val, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a>price7_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-4"><a href="#cb369-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price7_se_test, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb369-5"><a href="#cb369-5" aria-hidden="true" tabindex="-1"></a>price7_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb369-6"><a href="#cb369-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-7"><a href="#cb369-7" aria-hidden="true" tabindex="-1"></a>metrics_price7_val_ <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, price7_se_val, price7_se_val2)</span>
<span id="cb369-8"><a href="#cb369-8" aria-hidden="true" tabindex="-1"></a>metrics_price7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, price7_se_test, price7_se_test2)</span>
<span id="cb369-9"><a href="#cb369-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-10"><a href="#cb369-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_price7, metrics_price7_val, metrics_price7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="360">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>4.319775</td>
<td>360.341886</td>
<td>870.817024</td>
<td>7.583223e+05</td>
<td>0.996700</td>
<td>3.353203e-36</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>5.410749</td>
<td>2551.131517</td>
<td>3274.988349</td>
<td>1.072555e+07</td>
<td>-1.459638</td>
<td>3.353613e-01</td>
<td>0.723077</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>2.931272</td>
<td>1351.776008</td>
<td>1768.748748</td>
<td>3.128472e+06</td>
<td>0.117423</td>
<td>7.041111e-02</td>
<td>0.808292</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="f7ca9e7f" class="cell" data-execution_count="361">
<div class="sourceCode cell-code" id="cb370"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(price7_se[<span class="op">-</span><span class="dv">500</span>:], price7_se_val, price7_se_test, price7_se2, price7_se_val2, price7_se_test2)</span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_price7_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-18" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-18"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="d6725042" class="cell" data-execution_count="363">
<div class="sourceCode cell-code" id="cb371"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price14_se, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a>price14_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-4"><a href="#cb371-4" aria-hidden="true" tabindex="-1"></a>metrics_price14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, price14_se, price14_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-364-output-1.png" width="734" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-364-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="33534b72" class="cell" data-execution_count="364">
<div class="sourceCode cell-code" id="cb373"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price14_se_val, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a>price14_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-4"><a href="#cb373-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price14_se_test, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb373-5"><a href="#cb373-5" aria-hidden="true" tabindex="-1"></a>price14_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb373-6"><a href="#cb373-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-7"><a href="#cb373-7" aria-hidden="true" tabindex="-1"></a>metrics_price14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, price14_se_val, price14_se_val2)</span>
<span id="cb373-8"><a href="#cb373-8" aria-hidden="true" tabindex="-1"></a>metrics_price14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, price14_se_test, price14_se_test2)</span>
<span id="cb373-9"><a href="#cb373-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-10"><a href="#cb373-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_price14, metrics_price14_val, metrics_price14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="364">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>4.319775</td>
<td>360.341886</td>
<td>870.817024</td>
<td>7.583223e+05</td>
<td>0.996700</td>
<td>3.353203e-36</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>14.752890</td>
<td>7599.196025</td>
<td>7960.909495</td>
<td>6.337608e+07</td>
<td>-90.619982</td>
<td>9.083214e-03</td>
<td>0.415567</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>0.983599</td>
<td>506.931940</td>
<td>829.680695</td>
<td>6.883701e+05</td>
<td>0.004854</td>
<td>2.575142e-01</td>
<td>0.041523</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="dae9c734" class="cell" data-execution_count="365">
<div class="sourceCode cell-code" id="cb374"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(price14_se[<span class="op">-</span><span class="dv">500</span>:], price14_se_val, price14_se_test, price14_se2, price14_se_val2, price14_se_test2)</span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_price14_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-18" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-18"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="35c41d83" class="cell" data-execution_count="367">
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price21_se, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a>price21_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true" tabindex="-1"></a>metrics_price21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, price21_se, price21_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-368-output-1.png" width="734" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-368-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="a7cfe00e" class="cell" data-execution_count="368">
<div class="sourceCode cell-code" id="cb377"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price21_se_val, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true" tabindex="-1"></a>price21_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb377-3"><a href="#cb377-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-4"><a href="#cb377-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price21_se_test, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb377-5"><a href="#cb377-5" aria-hidden="true" tabindex="-1"></a>price21_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb377-6"><a href="#cb377-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-7"><a href="#cb377-7" aria-hidden="true" tabindex="-1"></a>metrics_price21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, price21_se_val, price21_se_val2)</span>
<span id="cb377-8"><a href="#cb377-8" aria-hidden="true" tabindex="-1"></a>metrics_price21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, price21_se_test, price21_se_test2)</span>
<span id="cb377-9"><a href="#cb377-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-10"><a href="#cb377-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_price21, metrics_price21_val, metrics_price21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="368">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>4.319775</td>
<td>360.341886</td>
<td>870.817024</td>
<td>7.583223e+05</td>
<td>0.996700</td>
<td>3.353203e-36</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>21.798390</td>
<td>13164.417955</td>
<td>14118.107310</td>
<td>1.993210e+08</td>
<td>-3.695558</td>
<td>4.399717e-03</td>
<td>0.345503</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>3.186922</td>
<td>1952.737279</td>
<td>2873.376280</td>
<td>8.256291e+06</td>
<td>0.805500</td>
<td>8.879869e-01</td>
<td>0.199937</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="e4e34944" class="cell" data-execution_count="369">
<div class="sourceCode cell-code" id="cb378"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(price21_se[<span class="op">-</span><span class="dv">500</span>:], price21_se_val, price21_se_test, price21_se2, price21_se_val2, price21_se_test2)</span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_price21_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-18" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-18"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="83d2906a" class="cell" data-execution_count="371">
<div class="sourceCode cell-code" id="cb379"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price28_se, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a>price28_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb379-3"><a href="#cb379-3" aria-hidden="true" tabindex="-1"></a>metrics_price28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, price28_se, price28_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-372-output-1.png" width="734" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-372-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="7700fc33" class="cell" data-execution_count="372">
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price28_se_val, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a>price28_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-4"><a href="#cb381-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(price28_se_test, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb381-5"><a href="#cb381-5" aria-hidden="true" tabindex="-1"></a>price28_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb381-6"><a href="#cb381-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-7"><a href="#cb381-7" aria-hidden="true" tabindex="-1"></a>metrics_price28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, price28_se_val, price28_se_val2)</span>
<span id="cb381-8"><a href="#cb381-8" aria-hidden="true" tabindex="-1"></a>metrics_price28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, price28_se_test, price28_se_test2)</span>
<span id="cb381-9"><a href="#cb381-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-10"><a href="#cb381-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_price28, metrics_price28_val, metrics_price28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="372">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>4.319775</td>
<td>360.341886</td>
<td>870.817024</td>
<td>7.583223e+05</td>
<td>0.996700</td>
<td>3.353203e-36</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>27.232540</td>
<td>17991.502514</td>
<td>18840.257822</td>
<td>3.549553e+08</td>
<td>-15.141019</td>
<td>7.124967e-05</td>
<td>0.213674</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>3.562825</td>
<td>2327.965894</td>
<td>2988.180680</td>
<td>8.929224e+06</td>
<td>0.593958</td>
<td>8.436555e-01</td>
<td>0.961865</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="bfab8696" class="cell" data-execution_count="373">
<div class="sourceCode cell-code" id="cb382"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(price28_se[<span class="op">-</span><span class="dv">500</span>:], price28_se_val, price28_se_test, price28_se2, price28_se_val2, price28_se_test2)</span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_price28_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="65d071bf" class="cell" data-execution_count="375">
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a>metrics_price_d <span class="op">=</span> pd.concat([</span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a>    metrics_price7, metrics_price7_val, metrics_price7_test,</span>
<span id="cb383-3"><a href="#cb383-3" aria-hidden="true" tabindex="-1"></a>    metrics_price14, metrics_price14_val, metrics_price14_test,</span>
<span id="cb383-4"><a href="#cb383-4" aria-hidden="true" tabindex="-1"></a>    metrics_price21, metrics_price21_val, metrics_price21_test,</span>
<span id="cb383-5"><a href="#cb383-5" aria-hidden="true" tabindex="-1"></a>    metrics_price28, metrics_price28_val, metrics_price28_test</span>
<span id="cb383-6"><a href="#cb383-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="retorno-acumulado-3" class="level4">
<h4 class="anchored" data-anchor-id="retorno-acumulado-3">Retorno acumulado</h4>
<section id="tau-7-19" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-19"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="d31988ba" class="cell" data-execution_count="376">
<div class="sourceCode cell-code" id="cb384"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(A_t7[<span class="dv">0</span>], smoothing_level <span class="op">=</span> param)</span>
<span id="cb384-4"><a href="#cb384-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb384-5"><a href="#cb384-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb384-6"><a href="#cb384-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb384-7"><a href="#cb384-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb384-8"><a href="#cb384-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-9"><a href="#cb384-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb384-10"><a href="#cb384-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="376">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>0.102749</td>
<td>0.200028</td>
<td>0.040011</td>
<td>0.998930</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>0.072009</td>
<td>0.148842</td>
<td>0.022154</td>
<td>0.999407</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>0.060886</td>
<td>0.129237</td>
<td>0.016702</td>
<td>0.999553</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>0.055120</td>
<td>0.119108</td>
<td>0.014187</td>
<td>0.999620</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>0.051761</td>
<td>0.113368</td>
<td>0.012852</td>
<td>0.999656</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>0.049592</td>
<td>0.110095</td>
<td>0.012121</td>
<td>0.999676</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>0.048146</td>
<td>0.108364</td>
<td>0.011743</td>
<td>0.999686</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>0.047216</td>
<td>0.107657</td>
<td>0.011590</td>
<td>0.999690</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>0.046706</td>
<td>0.107660</td>
<td>0.011591</td>
<td>0.999690</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="574bc981" class="cell" data-execution_count="377">
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-3"><a href="#cb385-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb385-4"><a href="#cb385-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb385-5"><a href="#cb385-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb385-6"><a href="#cb385-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb385-7"><a href="#cb385-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb385-8"><a href="#cb385-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb385-9"><a href="#cb385-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-378-output-1.png" width="597" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="ed8bd0fd" class="cell" data-execution_count="378">
<div class="sourceCode cell-code" id="cb386"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t7_se, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true" tabindex="-1"></a>A_t7_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb386-3"><a href="#cb386-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-4"><a href="#cb386-4" aria-hidden="true" tabindex="-1"></a>metrics_A_t7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, A_t7_se, A_t7_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-379-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-379-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="2a46be82" class="cell" data-execution_count="379">
<div class="sourceCode cell-code" id="cb388"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t7_se_val, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a>A_t7_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-4"><a href="#cb388-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t7_se_test, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb388-5"><a href="#cb388-5" aria-hidden="true" tabindex="-1"></a>A_t7_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb388-6"><a href="#cb388-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-7"><a href="#cb388-7" aria-hidden="true" tabindex="-1"></a>metrics_A_t7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, A_t7_se_val, A_t7_se_val2)</span>
<span id="cb388-8"><a href="#cb388-8" aria-hidden="true" tabindex="-1"></a>metrics_A_t7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, A_t7_se_test, A_t7_se_test2)</span>
<span id="cb388-9"><a href="#cb388-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-10"><a href="#cb388-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_A_t7, metrics_A_t7_val, metrics_A_t7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="379">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>NaN</td>
<td>0.044732</td>
<td>0.101900</td>
<td>0.010384</td>
<td>0.999723</td>
<td>1.630821e-71</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>0.178307</td>
<td>0.041566</td>
<td>0.058015</td>
<td>0.003366</td>
<td>-0.872815</td>
<td>5.349222e-01</td>
<td>0.846494</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>0.130835</td>
<td>0.030491</td>
<td>0.039711</td>
<td>0.001577</td>
<td>0.122497</td>
<td>8.065773e-02</td>
<td>0.797976</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="3ffba448" class="cell" data-execution_count="380">
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(A_t7_se[<span class="op">-</span><span class="dv">500</span>:], A_t7_se_val, A_t7_se_test, A_t7_se2, A_t7_se_val2, A_t7_se_test2)</span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_A_t7_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-19" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-19"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="1a0b9a84" class="cell" data-execution_count="382">
<div class="sourceCode cell-code" id="cb390"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t14_se, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true" tabindex="-1"></a>A_t14_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb390-3"><a href="#cb390-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-4"><a href="#cb390-4" aria-hidden="true" tabindex="-1"></a>metrics_A_t14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, A_t14_se, A_t14_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-383-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-383-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="f0f07098" class="cell" data-execution_count="383">
<div class="sourceCode cell-code" id="cb392"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t14_se_val, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb392-2"><a href="#cb392-2" aria-hidden="true" tabindex="-1"></a>A_t14_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb392-3"><a href="#cb392-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-4"><a href="#cb392-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t14_se_test, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb392-5"><a href="#cb392-5" aria-hidden="true" tabindex="-1"></a>A_t14_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb392-6"><a href="#cb392-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-7"><a href="#cb392-7" aria-hidden="true" tabindex="-1"></a>metrics_A_t14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, A_t14_se_val, A_t14_se_val2)</span>
<span id="cb392-8"><a href="#cb392-8" aria-hidden="true" tabindex="-1"></a>metrics_A_t14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, A_t14_se_test, A_t14_se_test2)</span>
<span id="cb392-9"><a href="#cb392-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-10"><a href="#cb392-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_A_t14, metrics_A_t14_val, metrics_A_t14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="383">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>NaN</td>
<td>0.044732</td>
<td>0.101900</td>
<td>0.010384</td>
<td>0.999723</td>
<td>1.630821e-71</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>0.699318</td>
<td>0.163763</td>
<td>0.171513</td>
<td>0.029417</td>
<td>-104.855285</td>
<td>9.824910e-03</td>
<td>0.443789</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>0.042901</td>
<td>0.010047</td>
<td>0.016528</td>
<td>0.000273</td>
<td>0.016989</td>
<td>2.757463e-01</td>
<td>0.027104</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="5865f5e9" class="cell" data-execution_count="384">
<div class="sourceCode cell-code" id="cb393"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(A_t14_se[<span class="op">-</span><span class="dv">500</span>:], A_t14_se_val, A_t14_se_test, A_t14_se2, A_t14_se_val2, A_t14_se_test2)</span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_A_t14_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-19" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-19"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="cf7005f1" class="cell" data-execution_count="386">
<div class="sourceCode cell-code" id="cb394"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t21_se, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a>A_t21_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb394-3"><a href="#cb394-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-4"><a href="#cb394-4" aria-hidden="true" tabindex="-1"></a>metrics_A_t21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, A_t21_se, A_t21_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-387-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-387-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="d64d4fd9" class="cell" data-execution_count="387">
<div class="sourceCode cell-code" id="cb396"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t21_se_val, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a>A_t21_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb396-3"><a href="#cb396-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t21_se_test, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb396-4"><a href="#cb396-4" aria-hidden="true" tabindex="-1"></a>A_t21_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb396-5"><a href="#cb396-5" aria-hidden="true" tabindex="-1"></a>metrics_A_t21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, A_t21_se_val, A_t21_se_val2)</span>
<span id="cb396-6"><a href="#cb396-6" aria-hidden="true" tabindex="-1"></a>metrics_A_t21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, A_t21_se_test, A_t21_se_test2)</span>
<span id="cb396-7"><a href="#cb396-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-8"><a href="#cb396-8" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_A_t21, metrics_A_t21_val, metrics_A_t21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="387">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>NaN</td>
<td>0.044732</td>
<td>0.101900</td>
<td>0.010384</td>
<td>0.999723</td>
<td>1.630821e-71</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>1.092877</td>
<td>0.257716</td>
<td>0.272995</td>
<td>0.074526</td>
<td>-4.518534</td>
<td>2.818119e-03</td>
<td>0.371752</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>0.144241</td>
<td>0.034033</td>
<td>0.050542</td>
<td>0.002555</td>
<td>0.810844</td>
<td>8.591690e-01</td>
<td>0.133577</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="444bffe5" class="cell" data-execution_count="388">
<div class="sourceCode cell-code" id="cb397"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(A_t21_se[<span class="op">-</span><span class="dv">500</span>:], A_t21_se_val, A_t21_se_test, A_t21_se2, A_t21_se_val2, A_t21_se_test2)</span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_A_t21_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-19" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-19"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="a9a8f090" class="cell" data-execution_count="390">
<div class="sourceCode cell-code" id="cb398"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t28_se, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true" tabindex="-1"></a>A_t28_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb398-3"><a href="#cb398-3" aria-hidden="true" tabindex="-1"></a>metrics_A_t28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, A_t28_se, A_t28_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-391-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-391-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="a35fa0d9" class="cell" data-execution_count="391">
<div class="sourceCode cell-code" id="cb400"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t28_se_val, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a>A_t28_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb400-3"><a href="#cb400-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(A_t28_se_test, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb400-4"><a href="#cb400-4" aria-hidden="true" tabindex="-1"></a>A_t28_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb400-5"><a href="#cb400-5" aria-hidden="true" tabindex="-1"></a>metrics_A_t28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, A_t28_se_val, A_t28_se_val2)</span>
<span id="cb400-6"><a href="#cb400-6" aria-hidden="true" tabindex="-1"></a>metrics_A_t28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Retorno Acumulado: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, A_t28_se_test, A_t28_se_test2)</span>
<span id="cb400-7"><a href="#cb400-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-8"><a href="#cb400-8" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_A_t28, metrics_A_t28_val, metrics_A_t28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="391">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>NaN</td>
<td>0.044732</td>
<td>0.101900</td>
<td>0.010384</td>
<td>0.999723</td>
<td>1.630821e-71</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>1.43171</td>
<td>0.339018</td>
<td>0.353954</td>
<td>0.125284</td>
<td>-19.569021</td>
<td>3.910206e-05</td>
<td>0.201270</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>0.15428</td>
<td>0.036514</td>
<td>0.047764</td>
<td>0.002281</td>
<td>0.625449</td>
<td>8.902413e-01</td>
<td>0.867971</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="6c4da427" class="cell" data-execution_count="392">
<div class="sourceCode cell-code" id="cb401"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(A_t28_se[<span class="op">-</span><span class="dv">500</span>:], A_t28_se_val, A_t28_se_test, A_t28_se2, A_t28_se_val2, A_t28_se_test2)</span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_A_t28_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="3d852bbb" class="cell" data-execution_count="394">
<div class="sourceCode cell-code" id="cb402"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a>metrics_A_t_d <span class="op">=</span> pd.concat([</span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true" tabindex="-1"></a>    metrics_A_t7, metrics_A_t7_val, metrics_A_t7_test,</span>
<span id="cb402-3"><a href="#cb402-3" aria-hidden="true" tabindex="-1"></a>    metrics_A_t14, metrics_A_t14_val, metrics_A_t14_test,</span>
<span id="cb402-4"><a href="#cb402-4" aria-hidden="true" tabindex="-1"></a>    metrics_A_t21, metrics_A_t21_val, metrics_A_t21_test,</span>
<span id="cb402-5"><a href="#cb402-5" aria-hidden="true" tabindex="-1"></a>    metrics_A_t28, metrics_A_t28_val, metrics_A_t28_test</span>
<span id="cb402-6"><a href="#cb402-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="volatilidad-omega-7-3" class="level4">
<h4 class="anchored" data-anchor-id="volatilidad-omega-7-3">Volatilidad <span class="math inline">\(\omega = 7\)</span></h4>
<section id="tau-7-20" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-20"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="d868b925" class="cell" data-execution_count="395">
<div class="sourceCode cell-code" id="cb403"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb403-3"><a href="#cb403-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(vol7_7_se, smoothing_level <span class="op">=</span> param)</span>
<span id="cb403-4"><a href="#cb403-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb403-5"><a href="#cb403-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb403-6"><a href="#cb403-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb403-7"><a href="#cb403-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb403-8"><a href="#cb403-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-9"><a href="#cb403-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb403-10"><a href="#cb403-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="395">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>0.018776</td>
<td>0.053273</td>
<td>0.002838</td>
<td>0.318988</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>0.016555</td>
<td>0.048270</td>
<td>0.002330</td>
<td>0.440904</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>0.014857</td>
<td>0.044502</td>
<td>0.001980</td>
<td>0.524765</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>0.013521</td>
<td>0.041640</td>
<td>0.001734</td>
<td>0.583930</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>0.012507</td>
<td>0.039478</td>
<td>0.001559</td>
<td>0.626010</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>0.011734</td>
<td>0.037863</td>
<td>0.001434</td>
<td>0.655991</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>0.011121</td>
<td>0.036672</td>
<td>0.001345</td>
<td>0.677285</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>0.010637</td>
<td>0.035810</td>
<td>0.001282</td>
<td>0.692278</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>0.010263</td>
<td>0.035204</td>
<td>0.001239</td>
<td>0.702614</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="36ca1530" class="cell" data-execution_count="396">
<div class="sourceCode cell-code" id="cb404"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-3"><a href="#cb404-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb404-4"><a href="#cb404-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb404-5"><a href="#cb404-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb404-6"><a href="#cb404-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb404-7"><a href="#cb404-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb404-8"><a href="#cb404-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb404-9"><a href="#cb404-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-397-output-1.png" width="606" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="42eda586" class="cell" data-execution_count="397">
<div class="sourceCode cell-code" id="cb405"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_7_se, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a>vol7_7_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb405-3"><a href="#cb405-3" aria-hidden="true" tabindex="-1"></a>metrics_vol7_7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, vol7_7_se, vol7_7_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-398-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-398-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="e9a9378c" class="cell" data-execution_count="398">
<div class="sourceCode cell-code" id="cb407"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_7_se_val, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true" tabindex="-1"></a>vol7_7_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb407-3"><a href="#cb407-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_7_se_test, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb407-4"><a href="#cb407-4" aria-hidden="true" tabindex="-1"></a>vol7_7_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb407-5"><a href="#cb407-5" aria-hidden="true" tabindex="-1"></a>metrics_vol7_7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, vol7_7_se_val, vol7_7_se_val2)</span>
<span id="cb407-6"><a href="#cb407-6" aria-hidden="true" tabindex="-1"></a>metrics_vol7_7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, vol7_7_se_test, vol7_7_se_test2)</span>
<span id="cb407-7"><a href="#cb407-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-8"><a href="#cb407-8" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol7_7, metrics_vol7_7_val, metrics_vol7_7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="398">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>NaN</td>
<td>0.010263</td>
<td>0.035204</td>
<td>0.001239</td>
<td>0.702614</td>
<td>1.302632e-268</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>56.610089</td>
<td>0.005835</td>
<td>0.006816</td>
<td>0.000046</td>
<td>-2.014865</td>
<td>8.838192e-01</td>
<td>0.191010</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>18.981655</td>
<td>0.002789</td>
<td>0.003703</td>
<td>0.000014</td>
<td>0.109953</td>
<td>4.645415e-01</td>
<td>0.632671</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="a5a9bc70" class="cell" data-execution_count="399">
<div class="sourceCode cell-code" id="cb408"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol7_7_se[<span class="op">-</span><span class="dv">500</span>:], vol7_7_se_val, vol7_7_se_test, vol7_7_se2, vol7_7_se_val2, vol7_7_se_test2)</span>
<span id="cb408-2"><a href="#cb408-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol7_7_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-20" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-20"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="56be362d" class="cell" data-execution_count="401">
<div class="sourceCode cell-code" id="cb409"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_14_se, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true" tabindex="-1"></a>vol7_14_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb409-3"><a href="#cb409-3" aria-hidden="true" tabindex="-1"></a>metrics_vol7_14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, vol7_14_se, vol7_14_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-402-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-402-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="d1e19464" class="cell" data-execution_count="402">
<div class="sourceCode cell-code" id="cb411"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_14_se_val, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb411-2"><a href="#cb411-2" aria-hidden="true" tabindex="-1"></a>vol7_14_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb411-3"><a href="#cb411-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_14_se_test, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb411-4"><a href="#cb411-4" aria-hidden="true" tabindex="-1"></a>vol7_14_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb411-5"><a href="#cb411-5" aria-hidden="true" tabindex="-1"></a>metrics_vol7_14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, vol7_14_se_val, vol7_14_se_val2)</span>
<span id="cb411-6"><a href="#cb411-6" aria-hidden="true" tabindex="-1"></a>metrics_vol7_14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, vol7_14_se_test, vol7_14_se_test2)</span>
<span id="cb411-7"><a href="#cb411-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb411-8"><a href="#cb411-8" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol7_14, metrics_vol7_14_val, metrics_vol7_14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="402">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>NaN</td>
<td>0.010263</td>
<td>0.035204</td>
<td>0.001239</td>
<td>0.702614</td>
<td>1.302632e-268</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>17.239164</td>
<td>0.002484</td>
<td>0.003033</td>
<td>0.000009</td>
<td>0.372364</td>
<td>7.279072e-01</td>
<td>0.437233</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>23.176398</td>
<td>0.002729</td>
<td>0.003812</td>
<td>0.000015</td>
<td>0.008352</td>
<td>6.429813e-01</td>
<td>0.001017</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="8b7ddf4c" class="cell" data-execution_count="403">
<div class="sourceCode cell-code" id="cb412"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol7_14_se[<span class="op">-</span><span class="dv">500</span>:], vol7_14_se_val, vol7_14_se_test, vol7_14_se2, vol7_14_se_val2, vol7_14_se_test2)</span>
<span id="cb412-2"><a href="#cb412-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol7_14_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-20" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-20"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="27ff83ce" class="cell" data-execution_count="405">
<div class="sourceCode cell-code" id="cb413"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_21_se, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true" tabindex="-1"></a>vol7_21_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb413-3"><a href="#cb413-3" aria-hidden="true" tabindex="-1"></a>metrics_vol7_21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, vol7_21_se, vol7_21_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-406-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-406-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="06204252" class="cell" data-execution_count="406">
<div class="sourceCode cell-code" id="cb415"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_21_se_val, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a>vol7_21_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb415-3"><a href="#cb415-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_21_se_test, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb415-4"><a href="#cb415-4" aria-hidden="true" tabindex="-1"></a>vol7_21_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb415-5"><a href="#cb415-5" aria-hidden="true" tabindex="-1"></a>metrics_vol7_21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, vol7_21_se_val, vol7_21_se_val2)</span>
<span id="cb415-6"><a href="#cb415-6" aria-hidden="true" tabindex="-1"></a>metrics_vol7_21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, vol7_21_se_test, vol7_21_se_test2)</span>
<span id="cb415-7"><a href="#cb415-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb415-8"><a href="#cb415-8" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol7_21, metrics_vol7_21_val, metrics_vol7_21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="406">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>NaN</td>
<td>0.010263</td>
<td>0.035204</td>
<td>0.001239</td>
<td>0.702614</td>
<td>1.302632e-268</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>63.840747</td>
<td>0.018600</td>
<td>0.022139</td>
<td>0.000490</td>
<td>-1.157191</td>
<td>8.973707e-01</td>
<td>0.256545</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>23.988768</td>
<td>0.005690</td>
<td>0.008179</td>
<td>0.000067</td>
<td>0.705569</td>
<td>7.157732e-01</td>
<td>0.461761</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="38311ccc" class="cell" data-execution_count="407">
<div class="sourceCode cell-code" id="cb416"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol7_21_se[<span class="op">-</span><span class="dv">500</span>:], vol7_21_se_val, vol7_21_se_test, vol7_21_se2, vol7_21_se_val2, vol7_21_se_test2)</span>
<span id="cb416-2"><a href="#cb416-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol7_21_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-20" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-20"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="dcabe41b" class="cell" data-execution_count="409">
<div class="sourceCode cell-code" id="cb417"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_28_se, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true" tabindex="-1"></a>vol7_28_se2 <span class="op">=</span> model.smooth()</span>
<span id="cb417-3"><a href="#cb417-3" aria-hidden="true" tabindex="-1"></a>metrics_vol7_28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, vol7_28_se, vol7_28_se2, show_info<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-410-output-1.png" width="730" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-410-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="80bf2416" class="cell" data-execution_count="410">
<div class="sourceCode cell-code" id="cb419"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_28_se_val, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb419-2"><a href="#cb419-2" aria-hidden="true" tabindex="-1"></a>vol7_28_se_val2 <span class="op">=</span> model.smooth()</span>
<span id="cb419-3"><a href="#cb419-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol7_28_se_test, smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb419-4"><a href="#cb419-4" aria-hidden="true" tabindex="-1"></a>vol7_28_se_test2 <span class="op">=</span> model.smooth()</span>
<span id="cb419-5"><a href="#cb419-5" aria-hidden="true" tabindex="-1"></a>metrics_vol7_28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, vol7_28_se_val, vol7_28_se_val2)</span>
<span id="cb419-6"><a href="#cb419-6" aria-hidden="true" tabindex="-1"></a>metrics_vol7_28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Volatilidad: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, vol7_28_se_test, vol7_28_se_test2)</span>
<span id="cb419-7"><a href="#cb419-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-8"><a href="#cb419-8" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol7_28, metrics_vol7_28_val, metrics_vol7_28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="410">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>NaN</td>
<td>0.010263</td>
<td>0.035204</td>
<td>0.001239</td>
<td>0.702614</td>
<td>1.302632e-268</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>53.702341</td>
<td>0.023434</td>
<td>0.027306</td>
<td>0.000746</td>
<td>-4.002681</td>
<td>6.629902e-01</td>
<td>0.055569</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>22.227595</td>
<td>0.007637</td>
<td>0.010632</td>
<td>0.000113</td>
<td>0.241564</td>
<td>1.135172e-02</td>
<td>0.632942</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="b84421ad" class="cell" data-execution_count="411">
<div class="sourceCode cell-code" id="cb420"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol7_28_se[<span class="op">-</span><span class="dv">500</span>:], vol7_28_se_val, vol7_28_se_test, vol7_28_se2, vol7_28_se_val2, vol7_28_se_test2)</span>
<span id="cb420-2"><a href="#cb420-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol7_28_2.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="1a77bfc1" class="cell" data-execution_count="413">
<div class="sourceCode cell-code" id="cb421"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a>metrics_vol7_d <span class="op">=</span> pd.concat([</span>
<span id="cb421-2"><a href="#cb421-2" aria-hidden="true" tabindex="-1"></a>    metrics_vol7_7, metrics_vol7_7_val, metrics_vol7_7_test,</span>
<span id="cb421-3"><a href="#cb421-3" aria-hidden="true" tabindex="-1"></a>    metrics_vol7_14, metrics_vol7_14_val, metrics_vol7_14_test,</span>
<span id="cb421-4"><a href="#cb421-4" aria-hidden="true" tabindex="-1"></a>    metrics_vol7_21, metrics_vol7_21_val, metrics_vol7_21_test,</span>
<span id="cb421-5"><a href="#cb421-5" aria-hidden="true" tabindex="-1"></a>    metrics_vol7_28, metrics_vol7_28_val, metrics_vol7_28_test</span>
<span id="cb421-6"><a href="#cb421-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="volatilidad-omega-14-3" class="level4">
<h4 class="anchored" data-anchor-id="volatilidad-omega-14-3">Volatilidad <span class="math inline">\(\omega = 14\)</span></h4>
<section id="tau-7-21" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-21"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="533b4a0a" class="cell" data-execution_count="414">
<div class="sourceCode cell-code" id="cb422"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb422-2"><a href="#cb422-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb422-3"><a href="#cb422-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(vol14_7[<span class="dv">0</span>], smoothing_level <span class="op">=</span> param)</span>
<span id="cb422-4"><a href="#cb422-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb422-5"><a href="#cb422-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb422-6"><a href="#cb422-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb422-7"><a href="#cb422-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb422-8"><a href="#cb422-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-9"><a href="#cb422-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb422-10"><a href="#cb422-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="414">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>0.014361</td>
<td>0.043906</td>
<td>0.001928</td>
<td>0.511511</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>0.010759</td>
<td>0.036137</td>
<td>0.001306</td>
<td>0.669093</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>0.008880</td>
<td>0.031524</td>
<td>0.000994</td>
<td>0.748183</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>0.007712</td>
<td>0.028696</td>
<td>0.000823</td>
<td>0.791334</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>0.006944</td>
<td>0.026903</td>
<td>0.000724</td>
<td>0.816595</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>0.006409</td>
<td>0.025734</td>
<td>0.000662</td>
<td>0.832185</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>0.006021</td>
<td>0.024964</td>
<td>0.000623</td>
<td>0.842086</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>0.005731</td>
<td>0.024463</td>
<td>0.000598</td>
<td>0.848356</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>0.005515</td>
<td>0.024158</td>
<td>0.000584</td>
<td>0.852115</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="0d8e6464" class="cell" data-execution_count="415">
<div class="sourceCode cell-code" id="cb423"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-3"><a href="#cb423-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb423-4"><a href="#cb423-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb423-5"><a href="#cb423-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb423-6"><a href="#cb423-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb423-7"><a href="#cb423-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb423-8"><a href="#cb423-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb423-9"><a href="#cb423-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-416-output-1.png" width="606" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="cbbce8cb" class="cell" data-execution_count="416">
<div class="sourceCode cell-code" id="cb424"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_7[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb424-2"><a href="#cb424-2" aria-hidden="true" tabindex="-1"></a>vol14_7_se <span class="op">=</span> model.smooth()</span>
<span id="cb424-3"><a href="#cb424-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb424-4"><a href="#cb424-4" aria-hidden="true" tabindex="-1"></a>metrics_vol14_7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, vol14_7[<span class="dv">0</span>], vol14_7_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-417-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-417-output-2.png" width="711" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="d62e3e5f" class="cell" data-execution_count="417">
<div class="sourceCode cell-code" id="cb426"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_7[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb426-2"><a href="#cb426-2" aria-hidden="true" tabindex="-1"></a>vol14_7_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb426-3"><a href="#cb426-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-4"><a href="#cb426-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_7[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb426-5"><a href="#cb426-5" aria-hidden="true" tabindex="-1"></a>vol14_7_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb426-6"><a href="#cb426-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-7"><a href="#cb426-7" aria-hidden="true" tabindex="-1"></a>metrics_vol14_7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, vol14_7[<span class="dv">1</span>], vol14_7_se_val)</span>
<span id="cb426-8"><a href="#cb426-8" aria-hidden="true" tabindex="-1"></a>metrics_vol14_7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, vol14_7[<span class="dv">2</span>], vol14_7_se_test)</span>
<span id="cb426-9"><a href="#cb426-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-10"><a href="#cb426-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol14_7, metrics_vol14_7_val, metrics_vol14_7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="417">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>NaN</td>
<td>0.005515</td>
<td>0.024158</td>
<td>5.836072e-04</td>
<td>0.852115</td>
<td>3.661844e-46</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>33.823503</td>
<td>0.005510</td>
<td>0.006004</td>
<td>3.605256e-05</td>
<td>-127.652529</td>
<td>7.904339e-01</td>
<td>0.082897</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>4.052057</td>
<td>0.000671</td>
<td>0.000833</td>
<td>6.947101e-07</td>
<td>-1.479053</td>
<td>9.197661e-01</td>
<td>0.916042</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="e2037386" class="cell" data-execution_count="418">
<div class="sourceCode cell-code" id="cb427"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol14_7[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol14_7[<span class="dv">1</span>], vol14_7[<span class="dv">2</span>], vol14_7_se, vol14_7_se_val, vol14_7_se_test)</span>
<span id="cb427-2"><a href="#cb427-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol14_7.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-21" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-21"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="11862e2b" class="cell" data-execution_count="420">
<div class="sourceCode cell-code" id="cb428"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_14[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb428-2"><a href="#cb428-2" aria-hidden="true" tabindex="-1"></a>vol14_14_se <span class="op">=</span> model.smooth()</span>
<span id="cb428-3"><a href="#cb428-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-4"><a href="#cb428-4" aria-hidden="true" tabindex="-1"></a>metrics_vol14_14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, vol14_14[<span class="dv">0</span>], vol14_14_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-421-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-421-output-2.png" width="711" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="efda4fbd" class="cell" data-execution_count="421">
<div class="sourceCode cell-code" id="cb430"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_14[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb430-2"><a href="#cb430-2" aria-hidden="true" tabindex="-1"></a>vol14_14_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb430-3"><a href="#cb430-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-4"><a href="#cb430-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_14[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb430-5"><a href="#cb430-5" aria-hidden="true" tabindex="-1"></a>vol14_14_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb430-6"><a href="#cb430-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-7"><a href="#cb430-7" aria-hidden="true" tabindex="-1"></a>metrics_vol14_14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, vol14_14[<span class="dv">1</span>], vol14_14_se_val)</span>
<span id="cb430-8"><a href="#cb430-8" aria-hidden="true" tabindex="-1"></a>metrics_vol14_14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, vol14_14[<span class="dv">2</span>], vol14_14_se_test)</span>
<span id="cb430-9"><a href="#cb430-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-10"><a href="#cb430-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol14_14, metrics_vol14_14_val, metrics_vol14_14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="421">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>NaN</td>
<td>0.005515</td>
<td>0.024158</td>
<td>5.836072e-04</td>
<td>0.852115</td>
<td>3.661844e-46</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>20.689774</td>
<td>0.003483</td>
<td>0.004332</td>
<td>1.877001e-05</td>
<td>-57.072766</td>
<td>6.315728e-01</td>
<td>0.000001</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>3.756666</td>
<td>0.000633</td>
<td>0.000757</td>
<td>5.729753e-07</td>
<td>-0.772735</td>
<td>1.073652e-01</td>
<td>0.220719</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="38d4e61b" class="cell" data-execution_count="422">
<div class="sourceCode cell-code" id="cb431"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol14_14[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol14_14[<span class="dv">1</span>], vol14_14[<span class="dv">2</span>], vol14_14_se, vol14_14_se_val, vol14_14_se_test)</span>
<span id="cb431-2"><a href="#cb431-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol14_14.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-21" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-21"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="0bbf17e2" class="cell" data-execution_count="424">
<div class="sourceCode cell-code" id="cb432"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_21[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true" tabindex="-1"></a>vol14_21_se <span class="op">=</span> model.smooth()</span>
<span id="cb432-3"><a href="#cb432-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-4"><a href="#cb432-4" aria-hidden="true" tabindex="-1"></a>metrics_vol14_21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, vol14_21[<span class="dv">0</span>], vol14_21_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-425-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-425-output-2.png" width="711" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="351f018c" class="cell" data-execution_count="425">
<div class="sourceCode cell-code" id="cb434"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_21[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb434-2"><a href="#cb434-2" aria-hidden="true" tabindex="-1"></a>vol14_21_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb434-3"><a href="#cb434-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-4"><a href="#cb434-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_21[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb434-5"><a href="#cb434-5" aria-hidden="true" tabindex="-1"></a>vol14_21_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb434-6"><a href="#cb434-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-7"><a href="#cb434-7" aria-hidden="true" tabindex="-1"></a>metrics_vol14_21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, vol14_21[<span class="dv">1</span>], vol14_21_se_val)</span>
<span id="cb434-8"><a href="#cb434-8" aria-hidden="true" tabindex="-1"></a>metrics_vol14_21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, vol14_21[<span class="dv">2</span>], vol14_21_se_test)</span>
<span id="cb434-9"><a href="#cb434-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-10"><a href="#cb434-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol14_21, metrics_vol14_21_val, metrics_vol14_21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="425">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>NaN</td>
<td>0.005515</td>
<td>0.024158</td>
<td>0.000584</td>
<td>0.852115</td>
<td>3.661844e-46</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>41.685487</td>
<td>0.013470</td>
<td>0.016199</td>
<td>0.000262</td>
<td>-1.520083</td>
<td>7.230675e-01</td>
<td>3.959695e-18</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>9.584982</td>
<td>0.002913</td>
<td>0.004743</td>
<td>0.000022</td>
<td>0.783916</td>
<td>9.533840e-02</td>
<td>6.906289e-04</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="1e7bfffb" class="cell" data-execution_count="426">
<div class="sourceCode cell-code" id="cb435"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol14_21[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol14_21[<span class="dv">1</span>], vol14_21[<span class="dv">2</span>], vol14_21_se, vol14_21_se_val, vol14_21_se_test)</span>
<span id="cb435-2"><a href="#cb435-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol14_21.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-21" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-21"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="366317dc" class="cell" data-execution_count="428">
<div class="sourceCode cell-code" id="cb436"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_28[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb436-2"><a href="#cb436-2" aria-hidden="true" tabindex="-1"></a>vol14_28_se <span class="op">=</span> model.smooth()</span>
<span id="cb436-3"><a href="#cb436-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-4"><a href="#cb436-4" aria-hidden="true" tabindex="-1"></a>metrics_vol14_28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, vol14_28[<span class="dv">0</span>], vol14_28_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-429-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-429-output-2.png" width="711" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="e152e3ff" class="cell" data-execution_count="429">
<div class="sourceCode cell-code" id="cb438"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_28[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb438-2"><a href="#cb438-2" aria-hidden="true" tabindex="-1"></a>vol14_28_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb438-3"><a href="#cb438-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb438-4"><a href="#cb438-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol14_28[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb438-5"><a href="#cb438-5" aria-hidden="true" tabindex="-1"></a>vol14_28_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb438-6"><a href="#cb438-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb438-7"><a href="#cb438-7" aria-hidden="true" tabindex="-1"></a>metrics_vol14_28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, vol14_28[<span class="dv">1</span>], vol14_28_se_val)</span>
<span id="cb438-8"><a href="#cb438-8" aria-hidden="true" tabindex="-1"></a>metrics_vol14_28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, vol14_28[<span class="dv">2</span>], vol14_28_se_test)</span>
<span id="cb438-9"><a href="#cb438-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb438-10"><a href="#cb438-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol14_28, metrics_vol14_28_val, metrics_vol14_28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="429">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>NaN</td>
<td>0.005515</td>
<td>0.024158</td>
<td>0.000584</td>
<td>0.852115</td>
<td>3.661844e-46</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>48.322368</td>
<td>0.019203</td>
<td>0.020935</td>
<td>0.000438</td>
<td>-8.715676</td>
<td>7.769449e-01</td>
<td>6.949045e-33</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>10.221859</td>
<td>0.003779</td>
<td>0.005210</td>
<td>0.000027</td>
<td>0.398179</td>
<td>8.146092e-02</td>
<td>4.263438e-01</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="4303df27" class="cell" data-execution_count="430">
<div class="sourceCode cell-code" id="cb439"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol14_28[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol14_28[<span class="dv">1</span>], vol14_28[<span class="dv">2</span>], vol14_28_se, vol14_28_se_val, vol14_28_se_test)</span>
<span id="cb439-2"><a href="#cb439-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol14_28.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="6cb02c18" class="cell" data-execution_count="432">
<div class="sourceCode cell-code" id="cb440"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true" tabindex="-1"></a>metrics_vol14_d <span class="op">=</span> pd.concat([</span>
<span id="cb440-2"><a href="#cb440-2" aria-hidden="true" tabindex="-1"></a>    metrics_vol14_7, metrics_vol14_7_val, metrics_vol14_7_test,</span>
<span id="cb440-3"><a href="#cb440-3" aria-hidden="true" tabindex="-1"></a>    metrics_vol14_14, metrics_vol14_14_val, metrics_vol14_14_test,</span>
<span id="cb440-4"><a href="#cb440-4" aria-hidden="true" tabindex="-1"></a>    metrics_vol14_21, metrics_vol14_21_val, metrics_vol14_21_test,</span>
<span id="cb440-5"><a href="#cb440-5" aria-hidden="true" tabindex="-1"></a>    metrics_vol14_28, metrics_vol14_28_val, metrics_vol14_28_test</span>
<span id="cb440-6"><a href="#cb440-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="volatilidad-omega-21-3" class="level4">
<h4 class="anchored" data-anchor-id="volatilidad-omega-21-3">Volatilidad <span class="math inline">\(\omega = 21\)</span></h4>
<section id="tau-7-22" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-22"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="abd23a7b" class="cell" data-execution_count="433">
<div class="sourceCode cell-code" id="cb441"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb441-2"><a href="#cb441-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb441-3"><a href="#cb441-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(vol21_7[<span class="dv">0</span>], smoothing_level <span class="op">=</span> param)</span>
<span id="cb441-4"><a href="#cb441-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb441-5"><a href="#cb441-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb441-6"><a href="#cb441-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb441-7"><a href="#cb441-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb441-8"><a href="#cb441-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-9"><a href="#cb441-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb441-10"><a href="#cb441-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="433">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>0.011977</td>
<td>0.037543</td>
<td>0.001409</td>
<td>0.629595</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>0.008228</td>
<td>0.029254</td>
<td>0.000856</td>
<td>0.775093</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>0.006499</td>
<td>0.025110</td>
<td>0.000630</td>
<td>0.834308</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>0.005543</td>
<td>0.022778</td>
<td>0.000519</td>
<td>0.863656</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>0.004951</td>
<td>0.021346</td>
<td>0.000456</td>
<td>0.880255</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>0.004547</td>
<td>0.020424</td>
<td>0.000417</td>
<td>0.890372</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>0.004251</td>
<td>0.019822</td>
<td>0.000393</td>
<td>0.896747</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>0.004034</td>
<td>0.019434</td>
<td>0.000378</td>
<td>0.900745</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>0.003870</td>
<td>0.019202</td>
<td>0.000369</td>
<td>0.903106</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="3a5499a4" class="cell" data-execution_count="434">
<div class="sourceCode cell-code" id="cb442"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb442-2"><a href="#cb442-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-3"><a href="#cb442-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb442-4"><a href="#cb442-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb442-5"><a href="#cb442-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb442-6"><a href="#cb442-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb442-7"><a href="#cb442-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb442-8"><a href="#cb442-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb442-9"><a href="#cb442-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-435-output-1.png" width="606" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="75997f18" class="cell" data-execution_count="435">
<div class="sourceCode cell-code" id="cb443"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_7[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb443-2"><a href="#cb443-2" aria-hidden="true" tabindex="-1"></a>vol21_7_se <span class="op">=</span> model.smooth()</span>
<span id="cb443-3"><a href="#cb443-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb443-4"><a href="#cb443-4" aria-hidden="true" tabindex="-1"></a>metrics_vol21_7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, vol21_7[<span class="dv">0</span>], vol21_7_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-436-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-436-output-2.png" width="728" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="4741930a" class="cell" data-execution_count="436">
<div class="sourceCode cell-code" id="cb445"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_7[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb445-2"><a href="#cb445-2" aria-hidden="true" tabindex="-1"></a>vol21_7_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb445-3"><a href="#cb445-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb445-4"><a href="#cb445-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_7[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb445-5"><a href="#cb445-5" aria-hidden="true" tabindex="-1"></a>vol21_7_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb445-6"><a href="#cb445-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb445-7"><a href="#cb445-7" aria-hidden="true" tabindex="-1"></a>metrics_vol21_7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, vol21_7[<span class="dv">1</span>], vol21_7_se_val)</span>
<span id="cb445-8"><a href="#cb445-8" aria-hidden="true" tabindex="-1"></a>metrics_vol21_7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, vol21_7[<span class="dv">2</span>], vol21_7_se_test)</span>
<span id="cb445-9"><a href="#cb445-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb445-10"><a href="#cb445-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol21_7, metrics_vol21_7_val, metrics_vol21_7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="436">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>NaN</td>
<td>0.003870</td>
<td>0.019202</td>
<td>3.687029e-04</td>
<td>0.903106</td>
<td>3.427794e-46</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>24.639399</td>
<td>0.004875</td>
<td>0.005659</td>
<td>3.202053e-05</td>
<td>-93.863726</td>
<td>9.767082e-01</td>
<td>0.063760</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>2.275079</td>
<td>0.000456</td>
<td>0.000654</td>
<td>4.281579e-07</td>
<td>-0.268456</td>
<td>4.601006e-01</td>
<td>0.973017</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="08e13bca" class="cell" data-execution_count="437">
<div class="sourceCode cell-code" id="cb446"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol21_7[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol21_7[<span class="dv">1</span>], vol21_7[<span class="dv">2</span>], vol21_7_se, vol21_7_se_val, vol21_7_se_test)</span>
<span id="cb446-2"><a href="#cb446-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol21_7.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-22" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-22"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="b8ed565a" class="cell" data-execution_count="439">
<div class="sourceCode cell-code" id="cb447"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_14[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb447-2"><a href="#cb447-2" aria-hidden="true" tabindex="-1"></a>vol21_14_se <span class="op">=</span> model.smooth()</span>
<span id="cb447-3"><a href="#cb447-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-4"><a href="#cb447-4" aria-hidden="true" tabindex="-1"></a>metrics_vol21_14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, vol21_14[<span class="dv">0</span>], vol21_14_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-440-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-440-output-2.png" width="728" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="e10d3435" class="cell" data-execution_count="440">
<div class="sourceCode cell-code" id="cb449"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_14[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb449-2"><a href="#cb449-2" aria-hidden="true" tabindex="-1"></a>vol21_14_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb449-3"><a href="#cb449-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb449-4"><a href="#cb449-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_14[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb449-5"><a href="#cb449-5" aria-hidden="true" tabindex="-1"></a>vol21_14_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb449-6"><a href="#cb449-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb449-7"><a href="#cb449-7" aria-hidden="true" tabindex="-1"></a>metrics_vol21_14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, vol21_14[<span class="dv">1</span>], vol21_14_se_val)</span>
<span id="cb449-8"><a href="#cb449-8" aria-hidden="true" tabindex="-1"></a>metrics_vol21_14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, vol21_14[<span class="dv">2</span>], vol21_14_se_test)</span>
<span id="cb449-9"><a href="#cb449-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb449-10"><a href="#cb449-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol21_14, metrics_vol21_14_val, metrics_vol21_14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="440">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>NaN</td>
<td>0.003870</td>
<td>0.019202</td>
<td>3.687029e-04</td>
<td>0.903106</td>
<td>3.427794e-46</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>32.155220</td>
<td>0.005409</td>
<td>0.006234</td>
<td>3.885917e-05</td>
<td>-87.343266</td>
<td>9.018262e-01</td>
<td>6.074575e-08</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>4.408937</td>
<td>0.000741</td>
<td>0.000901</td>
<td>8.110631e-07</td>
<td>-0.843888</td>
<td>3.785980e-01</td>
<td>3.502899e-01</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="be5a76f9" class="cell" data-execution_count="441">
<div class="sourceCode cell-code" id="cb450"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol21_14[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol21_14[<span class="dv">1</span>], vol21_14[<span class="dv">2</span>], vol21_14_se, vol21_14_se_val, vol21_14_se_test)</span>
<span id="cb450-2"><a href="#cb450-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol21_14.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-22" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-22"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="94c63869" class="cell" data-execution_count="443">
<div class="sourceCode cell-code" id="cb451"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_21[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb451-2"><a href="#cb451-2" aria-hidden="true" tabindex="-1"></a>vol21_21_se <span class="op">=</span> model.smooth()</span>
<span id="cb451-3"><a href="#cb451-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-4"><a href="#cb451-4" aria-hidden="true" tabindex="-1"></a>metrics_vol21_21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, vol21_21[<span class="dv">0</span>], vol21_21_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-444-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-444-output-2.png" width="728" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="69a87aa6" class="cell" data-execution_count="444">
<div class="sourceCode cell-code" id="cb453"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb453-1"><a href="#cb453-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_21[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb453-2"><a href="#cb453-2" aria-hidden="true" tabindex="-1"></a>vol21_21_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb453-3"><a href="#cb453-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-4"><a href="#cb453-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_21[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb453-5"><a href="#cb453-5" aria-hidden="true" tabindex="-1"></a>vol21_21_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb453-6"><a href="#cb453-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-7"><a href="#cb453-7" aria-hidden="true" tabindex="-1"></a>metrics_vol21_21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, vol21_21[<span class="dv">1</span>], vol21_21_se_val)</span>
<span id="cb453-8"><a href="#cb453-8" aria-hidden="true" tabindex="-1"></a>metrics_vol21_21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, vol21_21[<span class="dv">2</span>], vol21_21_se_test)</span>
<span id="cb453-9"><a href="#cb453-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-10"><a href="#cb453-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol21_21, metrics_vol21_21_val, metrics_vol21_21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="444">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>NaN</td>
<td>0.003870</td>
<td>0.019202</td>
<td>0.000369</td>
<td>0.903106</td>
<td>3.427794e-46</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>39.490052</td>
<td>0.010181</td>
<td>0.011634</td>
<td>0.000135</td>
<td>-1.179671</td>
<td>4.597669e-01</td>
<td>5.724525e-07</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>7.883541</td>
<td>0.002106</td>
<td>0.003458</td>
<td>0.000012</td>
<td>0.807484</td>
<td>1.146190e-01</td>
<td>5.402006e-04</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="fa12be8e" class="cell" data-execution_count="445">
<div class="sourceCode cell-code" id="cb454"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol21_21[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol21_21[<span class="dv">1</span>], vol21_21[<span class="dv">2</span>], vol21_21_se, vol21_21_se_val, vol21_21_se_test)</span>
<span id="cb454-2"><a href="#cb454-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol21_21.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-22" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-22"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="cc3ec27c" class="cell" data-execution_count="447">
<div class="sourceCode cell-code" id="cb455"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_28[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb455-2"><a href="#cb455-2" aria-hidden="true" tabindex="-1"></a>vol21_28_se <span class="op">=</span> model.smooth()</span>
<span id="cb455-3"><a href="#cb455-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-4"><a href="#cb455-4" aria-hidden="true" tabindex="-1"></a>metrics_vol21_28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, vol21_28[<span class="dv">0</span>], vol21_28_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-448-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-448-output-2.png" width="728" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="1b3cb437" class="cell" data-execution_count="448">
<div class="sourceCode cell-code" id="cb457"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_28[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb457-2"><a href="#cb457-2" aria-hidden="true" tabindex="-1"></a>vol21_28_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb457-3"><a href="#cb457-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb457-4"><a href="#cb457-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol21_28[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb457-5"><a href="#cb457-5" aria-hidden="true" tabindex="-1"></a>vol21_28_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb457-6"><a href="#cb457-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb457-7"><a href="#cb457-7" aria-hidden="true" tabindex="-1"></a>metrics_vol21_28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, vol21_28[<span class="dv">1</span>], vol21_28_se_val)</span>
<span id="cb457-8"><a href="#cb457-8" aria-hidden="true" tabindex="-1"></a>metrics_vol21_28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, vol21_28[<span class="dv">2</span>], vol21_28_se_test)</span>
<span id="cb457-9"><a href="#cb457-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb457-10"><a href="#cb457-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol21_28, metrics_vol21_28_val, metrics_vol21_28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="448">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>NaN</td>
<td>0.003870</td>
<td>0.019202</td>
<td>0.000369</td>
<td>0.903106</td>
<td>3.427794e-46</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>41.624074</td>
<td>0.016049</td>
<td>0.018614</td>
<td>0.000346</td>
<td>-5.760398</td>
<td>5.223368e-01</td>
<td>5.210346e-17</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>6.174221</td>
<td>0.002060</td>
<td>0.003240</td>
<td>0.000010</td>
<td>0.795153</td>
<td>4.854350e-01</td>
<td>7.161414e-05</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="e6b16cf2" class="cell" data-execution_count="449">
<div class="sourceCode cell-code" id="cb458"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol21_28[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol21_28[<span class="dv">1</span>], vol21_28[<span class="dv">2</span>], vol21_28_se, vol21_28_se_val, vol21_28_se_test)</span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol21_28.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="abe84834" class="cell" data-execution_count="451">
<div class="sourceCode cell-code" id="cb459"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb459-1"><a href="#cb459-1" aria-hidden="true" tabindex="-1"></a>metrics_vol21_d <span class="op">=</span> pd.concat([</span>
<span id="cb459-2"><a href="#cb459-2" aria-hidden="true" tabindex="-1"></a>    metrics_vol21_7, metrics_vol21_7_val, metrics_vol21_7_test,</span>
<span id="cb459-3"><a href="#cb459-3" aria-hidden="true" tabindex="-1"></a>    metrics_vol21_14, metrics_vol21_14_val, metrics_vol21_14_test,</span>
<span id="cb459-4"><a href="#cb459-4" aria-hidden="true" tabindex="-1"></a>    metrics_vol21_21, metrics_vol21_21_val, metrics_vol21_21_test,</span>
<span id="cb459-5"><a href="#cb459-5" aria-hidden="true" tabindex="-1"></a>    metrics_vol21_28, metrics_vol21_28_val, metrics_vol21_28_test</span>
<span id="cb459-6"><a href="#cb459-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="volatilidad-omega-28-3" class="level4">
<h4 class="anchored" data-anchor-id="volatilidad-omega-28-3">Volatilidad <span class="math inline">\(\omega = 28\)</span></h4>
<section id="tau-7-23" class="level5">
<h5 class="anchored" data-anchor-id="tau-7-23"><span class="math inline">\(\tau = 7\)</span></h5>
<div id="ea80298f" class="cell" data-execution_count="452">
<div class="sourceCode cell-code" id="cb460"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb460-2"><a href="#cb460-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb460-3"><a href="#cb460-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(vol28_7[<span class="dv">0</span>], smoothing_level <span class="op">=</span> param)</span>
<span id="cb460-4"><a href="#cb460-4" aria-hidden="true" tabindex="-1"></a>    yt <span class="op">=</span> model.smooth()</span>
<span id="cb460-5"><a href="#cb460-5" aria-hidden="true" tabindex="-1"></a>    eval_ <span class="op">=</span> model.evaluate(yt)</span>
<span id="cb460-6"><a href="#cb460-6" aria-hidden="true" tabindex="-1"></a>    eval_[<span class="st">'λ'</span>] <span class="op">=</span> param</span>
<span id="cb460-7"><a href="#cb460-7" aria-hidden="true" tabindex="-1"></a>    results.append(eval_)</span>
<span id="cb460-8"><a href="#cb460-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-9"><a href="#cb460-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.concat(results, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb460-10"><a href="#cb460-10" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="452">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">λ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>0.010221</td>
<td>0.032930</td>
<td>0.001084</td>
<td>0.707122</td>
<td>0.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>0.006674</td>
<td>0.024917</td>
<td>0.000621</td>
<td>0.832307</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>0.005232</td>
<td>0.021289</td>
<td>0.000453</td>
<td>0.877593</td>
<td>0.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>0.004451</td>
<td>0.019303</td>
<td>0.000373</td>
<td>0.899359</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>0.003956</td>
<td>0.018093</td>
<td>0.000327</td>
<td>0.911582</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>0.003620</td>
<td>0.017316</td>
<td>0.000300</td>
<td>0.919013</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>0.003376</td>
<td>0.016809</td>
<td>0.000283</td>
<td>0.923684</td>
<td>0.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>0.003193</td>
<td>0.016485</td>
<td>0.000272</td>
<td>0.926600</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>0.003055</td>
<td>0.016293</td>
<td>0.000265</td>
<td>0.928302</td>
<td>0.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="6f502de7" class="cell" data-execution_count="453">
<div class="sourceCode cell-code" id="cb461"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb461-1"><a href="#cb461-1" aria-hidden="true" tabindex="-1"></a>best_param <span class="op">=</span> params[results[<span class="st">'MAE'</span>].idxmin()]</span>
<span id="cb461-2"><a href="#cb461-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-3"><a href="#cb461-3" aria-hidden="true" tabindex="-1"></a>plt.plot(params, results[<span class="st">'MAE'</span>], marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb461-4"><a href="#cb461-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'$MAE$ v.s. $\lambda$'</span>)</span>
<span id="cb461-5"><a href="#cb461-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb461-6"><a href="#cb461-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$MAE$'</span>)</span>
<span id="cb461-7"><a href="#cb461-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_param, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="ss">f'Best λ = </span><span class="sc">{</span>best_param<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb461-8"><a href="#cb461-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb461-9"><a href="#cb461-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-454-output-1.png" width="606" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="805bd1ff" class="cell" data-execution_count="454">
<div class="sourceCode cell-code" id="cb462"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_7[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb462-2"><a href="#cb462-2" aria-hidden="true" tabindex="-1"></a>vol28_7_se <span class="op">=</span> model.smooth()</span>
<span id="cb462-3"><a href="#cb462-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb462-4"><a href="#cb462-4" aria-hidden="true" tabindex="-1"></a>metrics_vol28_7 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 7'</span>, vol28_7[<span class="dv">0</span>], vol28_7_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-455-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-455-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="94fd12f0" class="cell" data-execution_count="455">
<div class="sourceCode cell-code" id="cb464"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_7[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb464-2"><a href="#cb464-2" aria-hidden="true" tabindex="-1"></a>vol28_7_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb464-3"><a href="#cb464-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-4"><a href="#cb464-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_7[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb464-5"><a href="#cb464-5" aria-hidden="true" tabindex="-1"></a>vol28_7_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb464-6"><a href="#cb464-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-7"><a href="#cb464-7" aria-hidden="true" tabindex="-1"></a>metrics_vol28_7_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 7'</span>, vol28_7[<span class="dv">1</span>], vol28_7_se_val)</span>
<span id="cb464-8"><a href="#cb464-8" aria-hidden="true" tabindex="-1"></a>metrics_vol28_7_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 7'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 7'</span>, vol28_7[<span class="dv">2</span>], vol28_7_se_test)</span>
<span id="cb464-9"><a href="#cb464-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-10"><a href="#cb464-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol28_7, metrics_vol28_7_val, metrics_vol28_7_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="455">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 7</td>
<td>NaN</td>
<td>0.003055</td>
<td>0.016293</td>
<td>0.000265</td>
<td>0.928302</td>
<td>2.080088e-42</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 7</td>
<td>24.090786</td>
<td>0.005197</td>
<td>0.005680</td>
<td>0.000032</td>
<td>-10.081326</td>
<td>4.853045e-01</td>
<td>0.363816</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 7</td>
<td>6.550145</td>
<td>0.001370</td>
<td>0.001931</td>
<td>0.000004</td>
<td>-0.280476</td>
<td>9.865148e-01</td>
<td>0.180878</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="32944536" class="cell" data-execution_count="456">
<div class="sourceCode cell-code" id="cb465"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb465-1"><a href="#cb465-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol28_7[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol28_7[<span class="dv">1</span>], vol28_7[<span class="dv">2</span>], vol28_7_se, vol28_7_se_val, vol28_7_se_test)</span>
<span id="cb465-2"><a href="#cb465-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol28_7.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 7">
</iframe>
</section>
<section id="tau-14-23" class="level5">
<h5 class="anchored" data-anchor-id="tau-14-23"><span class="math inline">\(\tau = 14\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="8a8f6052" class="cell" data-execution_count="458">
<div class="sourceCode cell-code" id="cb466"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_14[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb466-2"><a href="#cb466-2" aria-hidden="true" tabindex="-1"></a>vol28_14_se <span class="op">=</span> model.smooth()</span>
<span id="cb466-3"><a href="#cb466-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb466-4"><a href="#cb466-4" aria-hidden="true" tabindex="-1"></a>metrics_vol28_14 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 14'</span>, vol28_14[<span class="dv">0</span>], vol28_14_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-459-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-459-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="f9745ecf" class="cell" data-execution_count="459">
<div class="sourceCode cell-code" id="cb468"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_14[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb468-2"><a href="#cb468-2" aria-hidden="true" tabindex="-1"></a>vol28_14_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb468-3"><a href="#cb468-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb468-4"><a href="#cb468-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_14[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb468-5"><a href="#cb468-5" aria-hidden="true" tabindex="-1"></a>vol28_14_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb468-6"><a href="#cb468-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb468-7"><a href="#cb468-7" aria-hidden="true" tabindex="-1"></a>metrics_vol28_14_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 14'</span>, vol28_14[<span class="dv">1</span>], vol28_14_se_val)</span>
<span id="cb468-8"><a href="#cb468-8" aria-hidden="true" tabindex="-1"></a>metrics_vol28_14_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 14'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 14'</span>, vol28_14[<span class="dv">2</span>], vol28_14_se_test)</span>
<span id="cb468-9"><a href="#cb468-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb468-10"><a href="#cb468-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol28_14, metrics_vol28_14_val, metrics_vol28_14_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="459">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 14</td>
<td>NaN</td>
<td>0.003055</td>
<td>0.016293</td>
<td>0.000265</td>
<td>0.928302</td>
<td>2.080088e-42</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 14</td>
<td>40.176470</td>
<td>0.007236</td>
<td>0.007645</td>
<td>0.000058</td>
<td>-15.313175</td>
<td>3.171246e-01</td>
<td>0.055724</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 14</td>
<td>5.134818</td>
<td>0.000891</td>
<td>0.001376</td>
<td>0.000002</td>
<td>0.471169</td>
<td>1.825919e-01</td>
<td>0.006916</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="54a79991" class="cell" data-execution_count="460">
<div class="sourceCode cell-code" id="cb469"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb469-1"><a href="#cb469-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol28_14[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol28_14[<span class="dv">1</span>], vol28_14[<span class="dv">2</span>], vol28_14_se, vol28_14_se_val, vol28_14_se_test)</span>
<span id="cb469-2"><a href="#cb469-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol28_14.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 14">
</iframe>
</section>
<section id="tau-21-23" class="level5">
<h5 class="anchored" data-anchor-id="tau-21-23"><span class="math inline">\(\tau = 21\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="c6470cce" class="cell" data-execution_count="462">
<div class="sourceCode cell-code" id="cb470"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_21[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb470-2"><a href="#cb470-2" aria-hidden="true" tabindex="-1"></a>vol28_21_se <span class="op">=</span> model.smooth()</span>
<span id="cb470-3"><a href="#cb470-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-4"><a href="#cb470-4" aria-hidden="true" tabindex="-1"></a>metrics_vol28_21 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 21'</span>, vol28_21[<span class="dv">0</span>], vol28_21_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-463-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-463-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="5c9a0d94" class="cell" data-execution_count="463">
<div class="sourceCode cell-code" id="cb472"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb472-1"><a href="#cb472-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_21[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb472-2"><a href="#cb472-2" aria-hidden="true" tabindex="-1"></a>vol28_21_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb472-3"><a href="#cb472-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-4"><a href="#cb472-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_21[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb472-5"><a href="#cb472-5" aria-hidden="true" tabindex="-1"></a>vol28_21_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb472-6"><a href="#cb472-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-7"><a href="#cb472-7" aria-hidden="true" tabindex="-1"></a>metrics_vol28_21_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 21'</span>, vol28_21[<span class="dv">1</span>], vol28_21_se_val)</span>
<span id="cb472-8"><a href="#cb472-8" aria-hidden="true" tabindex="-1"></a>metrics_vol28_21_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 21'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 21'</span>, vol28_21[<span class="dv">2</span>], vol28_21_se_test)</span>
<span id="cb472-9"><a href="#cb472-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-10"><a href="#cb472-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol28_21, metrics_vol28_21_val, metrics_vol28_21_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="463">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 21</td>
<td>NaN</td>
<td>0.003055</td>
<td>0.016293</td>
<td>0.000265</td>
<td>0.928302</td>
<td>2.080088e-42</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 21</td>
<td>37.953130</td>
<td>0.008205</td>
<td>0.009337</td>
<td>0.000087</td>
<td>-1.189503</td>
<td>1.525188e-01</td>
<td>0.000680</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 21</td>
<td>7.330286</td>
<td>0.001812</td>
<td>0.002927</td>
<td>0.000009</td>
<td>0.784885</td>
<td>1.883750e-01</td>
<td>0.000639</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="b5e2d616" class="cell" data-execution_count="464">
<div class="sourceCode cell-code" id="cb473"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb473-1"><a href="#cb473-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol28_21[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol28_21[<span class="dv">1</span>], vol28_21[<span class="dv">2</span>], vol28_21_se, vol28_21_se_val, vol28_21_se_test)</span>
<span id="cb473-2"><a href="#cb473-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol28_21.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 21">
</iframe>
</section>
<section id="tau-28-23" class="level5">
<h5 class="anchored" data-anchor-id="tau-28-23"><span class="math inline">\(\tau = 28\)</span></h5>
<p>A continuación, evaluaremos los residuales del pronóstico.</p>
<div id="99d35b52" class="cell" data-execution_count="466">
<div class="sourceCode cell-code" id="cb474"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb474-1"><a href="#cb474-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_28[<span class="dv">0</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb474-2"><a href="#cb474-2" aria-hidden="true" tabindex="-1"></a>vol28_28_se <span class="op">=</span> model.smooth()</span>
<span id="cb474-3"><a href="#cb474-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb474-4"><a href="#cb474-4" aria-hidden="true" tabindex="-1"></a>metrics_vol28_28 <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'train τ = 28'</span>, vol28_28[<span class="dv">0</span>], vol28_28_se, show_info <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-467-output-1.png" width="722" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="models_files/figure-html/cell-467-output-2.png" width="720" height="552" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Se rechaza H0: hay autocorrelación en los residuales.
Jarque-Bera p-value: 0.0
Se rechaza H0: los residuales no siguen una distribución normal.</code></pre>
</div>
</div>
<p>Ahora, veamos el gráfico de nuestras predicciones para la validación y el test</p>
<div id="fa439372" class="cell" data-execution_count="467">
<div class="sourceCode cell-code" id="cb476"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb476-1"><a href="#cb476-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_28[<span class="dv">1</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb476-2"><a href="#cb476-2" aria-hidden="true" tabindex="-1"></a>vol28_28_se_val <span class="op">=</span> model.smooth()</span>
<span id="cb476-3"><a href="#cb476-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb476-4"><a href="#cb476-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExponentialSmoothing(vol28_28[<span class="dv">2</span>], smoothing_level <span class="op">=</span> best_param)</span>
<span id="cb476-5"><a href="#cb476-5" aria-hidden="true" tabindex="-1"></a>vol28_28_se_test <span class="op">=</span> model.smooth()</span>
<span id="cb476-6"><a href="#cb476-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb476-7"><a href="#cb476-7" aria-hidden="true" tabindex="-1"></a>metrics_vol28_28_val <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'val τ = 28'</span>, vol28_28[<span class="dv">1</span>], vol28_28_se_val)</span>
<span id="cb476-8"><a href="#cb476-8" aria-hidden="true" tabindex="-1"></a>metrics_vol28_28_test <span class="op">=</span> model.residuals(<span class="st">'Simple Exponential Smoothing - Price: τ = 28'</span>, <span class="st">'MAE'</span>, <span class="st">'test τ = 28'</span>, vol28_28[<span class="dv">2</span>], vol28_28_se_test)</span>
<span id="cb476-9"><a href="#cb476-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb476-10"><a href="#cb476-10" aria-hidden="true" tabindex="-1"></a>pd.concat([metrics_vol28_28, metrics_vol28_28_val, metrics_vol28_28_test])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="467">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Ljung-Box p-value</th>
<th data-quarto-table-cell-role="th">Jarque-Bera p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE train τ = 28</td>
<td>NaN</td>
<td>0.003055</td>
<td>0.016293</td>
<td>0.000265</td>
<td>0.928302</td>
<td>2.080088e-42</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAE val τ = 28</td>
<td>33.769083</td>
<td>0.012103</td>
<td>0.014920</td>
<td>0.000223</td>
<td>-3.125747</td>
<td>9.645792e-03</td>
<td>0.000266</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MAE test τ = 28</td>
<td>6.719563</td>
<td>0.002137</td>
<td>0.003148</td>
<td>0.000010</td>
<td>0.816352</td>
<td>2.064221e-01</td>
<td>0.003490</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="6dcbffab" class="cell" data-execution_count="468">
<div class="sourceCode cell-code" id="cb477"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> model.plot_preds(vol28_28[<span class="dv">0</span>][<span class="op">-</span><span class="dv">500</span>:], vol28_28[<span class="dv">1</span>], vol28_28[<span class="dv">2</span>], vol28_28_se, vol28_28_se_val, vol28_28_se_test)</span>
<span id="cb477-2"><a href="#cb477-2" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/plot_preds_vol28_28.html" width="730" height="400" title="Visualización de las predicciones del precio con tau 28">
</iframe>
<div id="d106d248" class="cell" data-execution_count="470">
<div class="sourceCode cell-code" id="cb478"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb478-1"><a href="#cb478-1" aria-hidden="true" tabindex="-1"></a>metrics_vol28_d <span class="op">=</span> pd.concat([</span>
<span id="cb478-2"><a href="#cb478-2" aria-hidden="true" tabindex="-1"></a>    metrics_vol28_7, metrics_vol28_7_val, metrics_vol28_7_test,</span>
<span id="cb478-3"><a href="#cb478-3" aria-hidden="true" tabindex="-1"></a>    metrics_vol28_14, metrics_vol28_14_val, metrics_vol28_14_test,</span>
<span id="cb478-4"><a href="#cb478-4" aria-hidden="true" tabindex="-1"></a>    metrics_vol28_21, metrics_vol28_21_val, metrics_vol28_21_test,</span>
<span id="cb478-5"><a href="#cb478-5" aria-hidden="true" tabindex="-1"></a>    metrics_vol28_28, metrics_vol28_28_val, metrics_vol28_28_test</span>
<span id="cb478-6"><a href="#cb478-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./eda.html" class="pagination-link" aria-label="Análisis exploratorio de datos">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Análisis exploratorio de datos</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./deep.html" class="pagination-link" aria-label="Modelos de deep learning">
        <span class="nav-page-text">Modelos de deep learning</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>