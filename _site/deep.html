<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jorge Borja">
<meta name="author" content="Gabriela Díaz Porto">

<title>Modelos de deep learning – Parcial Práctico Series de Tiempo</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./eda.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.35.2.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>

<link rel="apple-touch-icon" sizes="180x180" href="icon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="32x32" href="icon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="icon/favicon-16x16.png">
<link rel="mask-icon" href="icon/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./deep.html">Modelos de deep learning</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Parcial Práctico Series de Tiempo</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introducción</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Análisis exploratorio de datos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./deep.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Modelos de deep learning</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">En esta página</h2>
   
  <ul>
  <li><a href="#importar-librerías" id="toc-importar-librerías" class="nav-link active" data-scroll-target="#importar-librerías">Importar librerías</a></li>
  <li><a href="#importar-datos" id="toc-importar-datos" class="nav-link" data-scroll-target="#importar-datos">Importar datos</a></li>
  <li><a href="#objetivo" id="toc-objetivo" class="nav-link" data-scroll-target="#objetivo">Objetivo</a></li>
  <li><a href="#obtención-de-las-series-de-tiempo-y-conjuntos-de-prueba-validación-y-entrenamiento" id="toc-obtención-de-las-series-de-tiempo-y-conjuntos-de-prueba-validación-y-entrenamiento" class="nav-link" data-scroll-target="#obtención-de-las-series-de-tiempo-y-conjuntos-de-prueba-validación-y-entrenamiento">Obtención de las series de tiempo y conjuntos de prueba, validación y entrenamiento</a>
  <ul>
  <li><a href="#series-de-tiempo-del-precio" id="toc-series-de-tiempo-del-precio" class="nav-link" data-scroll-target="#series-de-tiempo-del-precio">Series de tiempo del precio</a></li>
  <li><a href="#series-de-tiempo-del-retorno-acumulado" id="toc-series-de-tiempo-del-retorno-acumulado" class="nav-link" data-scroll-target="#series-de-tiempo-del-retorno-acumulado">Series de tiempo del retorno acumulado</a></li>
  <li><a href="#series-de-tiempo-de-la-volatilidad" id="toc-series-de-tiempo-de-la-volatilidad" class="nav-link" data-scroll-target="#series-de-tiempo-de-la-volatilidad">Series de tiempo de la volatilidad</a>
  <ul>
  <li><a href="#serie-de-tiempo-de-la-volatidad-para-σ-7" id="toc-serie-de-tiempo-de-la-volatidad-para-σ-7" class="nav-link" data-scroll-target="#serie-de-tiempo-de-la-volatidad-para-σ-7">Serie de tiempo de la volatidad para σ = 7</a></li>
  <li><a href="#serie-de-tiempo-de-la-volatidad-para-σ-14" id="toc-serie-de-tiempo-de-la-volatidad-para-σ-14" class="nav-link" data-scroll-target="#serie-de-tiempo-de-la-volatidad-para-σ-14">Serie de tiempo de la volatidad para σ = 14</a></li>
  <li><a href="#serie-de-tiempo-de-la-volatidad-para-σ-21" id="toc-serie-de-tiempo-de-la-volatidad-para-σ-21" class="nav-link" data-scroll-target="#serie-de-tiempo-de-la-volatidad-para-σ-21">Serie de tiempo de la volatidad para σ = 21</a></li>
  <li><a href="#serie-de-tiempo-de-la-volatidad-para-σ-28" id="toc-serie-de-tiempo-de-la-volatidad-para-σ-28" class="nav-link" data-scroll-target="#serie-de-tiempo-de-la-volatidad-para-σ-28">Serie de tiempo de la volatidad para σ = 28</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#visualización-de-los-pliegues-extraídos" id="toc-visualización-de-los-pliegues-extraídos" class="nav-link" data-scroll-target="#visualización-de-los-pliegues-extraídos">Visualización de los pliegues extraídos</a>
  <ul>
  <li><a href="#pliegues-del-precio" id="toc-pliegues-del-precio" class="nav-link" data-scroll-target="#pliegues-del-precio">Pliegues del precio</a></li>
  <li><a href="#pliegues-del-retorno-acumulado" id="toc-pliegues-del-retorno-acumulado" class="nav-link" data-scroll-target="#pliegues-del-retorno-acumulado">Pliegues del retorno acumulado</a></li>
  <li><a href="#pliegues-de-la-volatilidad" id="toc-pliegues-de-la-volatilidad" class="nav-link" data-scroll-target="#pliegues-de-la-volatilidad">Pliegues de la volatilidad</a>
  <ul>
  <li><a href="#σ-7" id="toc-σ-7" class="nav-link" data-scroll-target="#σ-7">σ = 7</a></li>
  <li><a href="#σ-14" id="toc-σ-14" class="nav-link" data-scroll-target="#σ-14">σ = 14</a></li>
  <li><a href="#σ-21" id="toc-σ-21" class="nav-link" data-scroll-target="#σ-21">σ = 21</a></li>
  <li><a href="#σ-28" id="toc-σ-28" class="nav-link" data-scroll-target="#σ-28">σ = 28</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#modelos-de-deep-learning" id="toc-modelos-de-deep-learning" class="nav-link" data-scroll-target="#modelos-de-deep-learning">Modelos de Deep Learning</a>
  <ul>
  <li><a href="#multilayer-perceptron-models-mlp" id="toc-multilayer-perceptron-models-mlp" class="nav-link" data-scroll-target="#multilayer-perceptron-models-mlp">Multilayer Perceptron Models (MLP)</a>
  <ul>
  <li><a href="#predicciones-para-el-precio" id="toc-predicciones-para-el-precio" class="nav-link" data-scroll-target="#predicciones-para-el-precio">Predicciones para el precio</a>
  <ul class="collapse">
  <li><a href="#τ-7" id="toc-τ-7" class="nav-link" data-scroll-target="#τ-7">τ = 7</a></li>
  <li><a href="#τ-14" id="toc-τ-14" class="nav-link" data-scroll-target="#τ-14">τ = 14</a></li>
  <li><a href="#τ-21" id="toc-τ-21" class="nav-link" data-scroll-target="#τ-21">τ = 21</a></li>
  <li><a href="#τ-28" id="toc-τ-28" class="nav-link" data-scroll-target="#τ-28">τ = 28</a></li>
  </ul></li>
  <li><a href="#predicciones-para-el-retorno-acumulado" id="toc-predicciones-para-el-retorno-acumulado" class="nav-link" data-scroll-target="#predicciones-para-el-retorno-acumulado">Predicciones para el retorno acumulado</a>
  <ul class="collapse">
  <li><a href="#τ-7-1" id="toc-τ-7-1" class="nav-link" data-scroll-target="#τ-7-1">τ = 7</a></li>
  <li><a href="#τ-14-1" id="toc-τ-14-1" class="nav-link" data-scroll-target="#τ-14-1">τ = 14</a></li>
  <li><a href="#τ-21-1" id="toc-τ-21-1" class="nav-link" data-scroll-target="#τ-21-1">τ = 21</a></li>
  <li><a href="#τ-28-1" id="toc-τ-28-1" class="nav-link" data-scroll-target="#τ-28-1">τ = 28</a></li>
  </ul></li>
  <li><a href="#predicciones-para-la-volatilidad" id="toc-predicciones-para-la-volatilidad" class="nav-link" data-scroll-target="#predicciones-para-la-volatilidad">Predicciones para la volatilidad</a>
  <ul class="collapse">
  <li><a href="#volatilidad-con-ventana-σ-7" id="toc-volatilidad-con-ventana-σ-7" class="nav-link" data-scroll-target="#volatilidad-con-ventana-σ-7">Volatilidad con ventana σ = 7</a>
  <ul class="collapse">
  <li><a href="#τ-7-2" id="toc-τ-7-2" class="nav-link" data-scroll-target="#τ-7-2">τ = 7</a></li>
  <li><a href="#τ-14-2" id="toc-τ-14-2" class="nav-link" data-scroll-target="#τ-14-2">τ = 14</a></li>
  <li><a href="#τ-21-2" id="toc-τ-21-2" class="nav-link" data-scroll-target="#τ-21-2">τ = 21</a></li>
  <li><a href="#τ-28-2" id="toc-τ-28-2" class="nav-link" data-scroll-target="#τ-28-2">τ = 28</a></li>
  </ul></li>
  <li><a href="#volatilidad-con-ventana-σ-14" id="toc-volatilidad-con-ventana-σ-14" class="nav-link" data-scroll-target="#volatilidad-con-ventana-σ-14">Volatilidad con ventana σ = 14</a>
  <ul class="collapse">
  <li><a href="#τ-7-3" id="toc-τ-7-3" class="nav-link" data-scroll-target="#τ-7-3">τ = 7</a></li>
  <li><a href="#τ-14-3" id="toc-τ-14-3" class="nav-link" data-scroll-target="#τ-14-3">τ = 14</a></li>
  <li><a href="#τ-21-3" id="toc-τ-21-3" class="nav-link" data-scroll-target="#τ-21-3">τ = 21</a></li>
  <li><a href="#τ-28-3" id="toc-τ-28-3" class="nav-link" data-scroll-target="#τ-28-3">τ = 28</a></li>
  </ul></li>
  <li><a href="#volatilidad-con-ventana-σ-21" id="toc-volatilidad-con-ventana-σ-21" class="nav-link" data-scroll-target="#volatilidad-con-ventana-σ-21">Volatilidad con ventana σ = 21</a>
  <ul class="collapse">
  <li><a href="#τ-7-4" id="toc-τ-7-4" class="nav-link" data-scroll-target="#τ-7-4">τ = 7</a></li>
  <li><a href="#τ-14-4" id="toc-τ-14-4" class="nav-link" data-scroll-target="#τ-14-4">τ = 14</a></li>
  <li><a href="#τ-21-4" id="toc-τ-21-4" class="nav-link" data-scroll-target="#τ-21-4">τ = 21</a></li>
  <li><a href="#τ-28-4" id="toc-τ-28-4" class="nav-link" data-scroll-target="#τ-28-4">τ = 28</a></li>
  </ul></li>
  <li><a href="#volatilidad-con-ventana-σ-28" id="toc-volatilidad-con-ventana-σ-28" class="nav-link" data-scroll-target="#volatilidad-con-ventana-σ-28">Volatilidad con ventana σ = 28</a>
  <ul class="collapse">
  <li><a href="#τ-7-5" id="toc-τ-7-5" class="nav-link" data-scroll-target="#τ-7-5">τ = 7</a></li>
  <li><a href="#τ-14-5" id="toc-τ-14-5" class="nav-link" data-scroll-target="#τ-14-5">τ = 14</a></li>
  <li><a href="#τ-21-5" id="toc-τ-21-5" class="nav-link" data-scroll-target="#τ-21-5">τ = 21</a></li>
  <li><a href="#τ-28-5" id="toc-τ-28-5" class="nav-link" data-scroll-target="#τ-28-5">τ = 28</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#selección-del-mejor-modelo-mlp" id="toc-selección-del-mejor-modelo-mlp" class="nav-link" data-scroll-target="#selección-del-mejor-modelo-mlp">Selección del mejor modelo MLP</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Modelos de deep learning</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Autores/as</div>
  <div class="quarto-title-meta-heading">Afiliación</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://www.linkedin.com/in/jorgeborjas25/">Jorge Borja, Mag</a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://uninorte.edu.co/">
            Universidad del Norte
            </a>
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://www.linkedin.com/in/gabriela-diaz-porto-6a0729201">Gabriela Díaz Porto, Mag</a> </p>
  </div>
  <div class="quarto-title-meta-contents">
      </div>
  </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  


</header>


<p>Para modelar la serie de tiempo con técnicas de Deep Learning, se requiere realizar una preparación cuidadosa de los datos y la configuración de modelos neuronales. En este caso, se utiliza la librería TensorFlow para implementar diferentes tipos de modelos, como Redes Neuronales Multicapa (MLP) y Redes Neuronales Recurrentes (LSTM, RNN), dado que estas arquitecturas son efectivas para capturar patrones no lineales y dependencias temporales en los datos.</p>
<section id="importar-librerías" class="level1">
<h1>Importar librerías</h1>
<p>Se importan las librerías necesarias para el modelado, como TensorFlow para la construcción de modelos neuronales, Scikeras para la integración de los modelos con sklearn y Plotly para la visualización de resultados. Además, se emplean herramientas estadísticas y métricas de evaluación para medir el rendimiento de los modelos y realizar diagnósticos de los residuos.</p>
<div id="9217fb72" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotly.subplots <span class="im">import</span> make_subplots</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential, Model, load_model</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Dense, Input, Dropout</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.optimizers <span class="im">import</span> Adam</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras <span class="im">import</span> layers, losses</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scikeras.wrappers <span class="im">import</span> KerasRegressor</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_absolute_percentage_error, mean_absolute_error, mean_squared_error, r2_score</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> jarque_bera</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.diagnostic <span class="im">import</span> acorr_ljungbox</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">'TF_CPP_MIN_LOG_LEVEL'</span>] <span class="op">=</span> <span class="st">'2'</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>, category<span class="op">=</span><span class="pp">UserWarning</span>, module<span class="op">=</span><span class="st">"scikeras.wrappers"</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>, category<span class="op">=</span><span class="pp">UserWarning</span>, module<span class="op">=</span><span class="st">"keras.layers.core.dense"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importar-datos" class="level1">
<h1>Importar datos</h1>
<p>En este caso, se carga un archivo con los datos preparados (btc_models.csv), que contiene las características necesarias para entrenar los modelos neuronales y evaluar su rendimiento. El dataset incluye variables transformadas y seleccionadas para capturar tanto la estructura temporal como la información relevante de la serie de precios de Bitcoin.</p>
<div id="f4ef4c0e" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>btc <span class="op">=</span> pd.read_csv(<span class="st">'data/btc_models.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>btc</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Price</th>
<th data-quarto-table-cell-role="th">Open</th>
<th data-quarto-table-cell-role="th">High</th>
<th data-quarto-table-cell-role="th">Low</th>
<th data-quarto-table-cell-role="th">Vol.</th>
<th data-quarto-table-cell-role="th">Change %</th>
<th data-quarto-table-cell-role="th">R_j</th>
<th data-quarto-table-cell-role="th">A_t</th>
<th data-quarto-table-cell-role="th">σ_7</th>
<th data-quarto-table-cell-role="th">σ_14</th>
<th data-quarto-table-cell-role="th">σ_21</th>
<th data-quarto-table-cell-role="th">σ_28</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2024-03-24</td>
<td>67211.9</td>
<td>64036.5</td>
<td>67587.8</td>
<td>63812.9</td>
<td>65590.0</td>
<td>4.96</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2024-03-23</td>
<td>64037.8</td>
<td>63785.6</td>
<td>65972.4</td>
<td>63074.9</td>
<td>35110.0</td>
<td>0.40</td>
<td>-0.047225</td>
<td>-0.047225</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2024-03-22</td>
<td>63785.5</td>
<td>65501.5</td>
<td>66633.3</td>
<td>62328.3</td>
<td>72430.0</td>
<td>-2.62</td>
<td>-0.003940</td>
<td>-0.051165</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2024-03-21</td>
<td>65503.8</td>
<td>67860.0</td>
<td>68161.7</td>
<td>64616.1</td>
<td>75260.0</td>
<td>-3.46</td>
<td>0.026939</td>
<td>-0.024226</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2024-03-20</td>
<td>67854.0</td>
<td>62046.8</td>
<td>68029.5</td>
<td>60850.9</td>
<td>133530.0</td>
<td>9.35</td>
<td>0.035879</td>
<td>0.011652</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4994</td>
<td>2010-07-22</td>
<td>0.1</td>
<td>0.1</td>
<td>0.1</td>
<td>0.1</td>
<td>2160.0</td>
<td>0.00</td>
<td>0.000000</td>
<td>-4.322978</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4995</td>
<td>2010-07-21</td>
<td>0.1</td>
<td>0.1</td>
<td>0.1</td>
<td>0.1</td>
<td>580.0</td>
<td>0.00</td>
<td>0.000000</td>
<td>-4.322978</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4996</td>
<td>2010-07-20</td>
<td>0.1</td>
<td>0.1</td>
<td>0.1</td>
<td>0.1</td>
<td>260.0</td>
<td>0.00</td>
<td>0.000000</td>
<td>-4.322978</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4997</td>
<td>2010-07-19</td>
<td>0.1</td>
<td>0.1</td>
<td>0.1</td>
<td>0.1</td>
<td>570.0</td>
<td>0.00</td>
<td>0.000000</td>
<td>-4.322978</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4998</td>
<td>2010-07-18</td>
<td>0.1</td>
<td>0.0</td>
<td>0.1</td>
<td>0.1</td>
<td>80.0</td>
<td>0.00</td>
<td>0.000000</td>
<td>-4.322978</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

<p>4999 rows × 13 columns</p>
</div>
</div>
</div>
<div id="2bdc7dac" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>btc.info()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 4999 entries, 0 to 4998
Data columns (total 13 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   Date      4999 non-null   object 
 1   Price     4999 non-null   float64
 2   Open      4999 non-null   float64
 3   High      4999 non-null   float64
 4   Low       4999 non-null   float64
 5   Vol.      4999 non-null   float64
 6   Change %  4999 non-null   float64
 7   R_j       4998 non-null   float64
 8   A_t       4998 non-null   float64
 9   σ_7       4992 non-null   float64
 10  σ_14      4985 non-null   float64
 11  σ_21      4978 non-null   float64
 12  σ_28      4971 non-null   float64
dtypes: float64(12), object(1)
memory usage: 507.8+ KB</code></pre>
</div>
</div>
<div id="8b7a174e" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>btc <span class="op">=</span> btc.fillna(<span class="dv">0</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>btc[<span class="st">'Date'</span>] <span class="op">=</span> pd.to_datetime(btc[<span class="st">'Date'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st">'</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>btc.info()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 4999 entries, 0 to 4998
Data columns (total 13 columns):
 #   Column    Non-Null Count  Dtype         
---  ------    --------------  -----         
 0   Date      4999 non-null   datetime64[ns]
 1   Price     4999 non-null   float64       
 2   Open      4999 non-null   float64       
 3   High      4999 non-null   float64       
 4   Low       4999 non-null   float64       
 5   Vol.      4999 non-null   float64       
 6   Change %  4999 non-null   float64       
 7   R_j       4999 non-null   float64       
 8   A_t       4999 non-null   float64       
 9   σ_7       4999 non-null   float64       
 10  σ_14      4999 non-null   float64       
 11  σ_21      4999 non-null   float64       
 12  σ_28      4999 non-null   float64       
dtypes: datetime64[ns](1), float64(12)
memory usage: 507.8 KB</code></pre>
</div>
</div>
</section>
<section id="objetivo" class="level1">
<h1>Objetivo</h1>
<p>El objetivo principal de los modelos de Deep Learning es capturar patrones no lineales y dependencias temporales en los datos del Bitcoin, mejorando la capacidad predictiva sobre otros enfoques tradicionales. Para ello, se configurarán y entrenarán distintas arquitecturas neuronales, optimizando sus hiperparámetros y evaluando su desempeño mediante métricas como el error absoluto medio (MAE), el error cuadrático medio (MSE) y la proporción explicada (R²). Además, se aplicarán diagnósticos de los residuos para verificar la calidad de las predicciones y detectar posibles sesgos o errores sistemáticos en los modelos.</p>
</section>
<section id="obtención-de-las-series-de-tiempo-y-conjuntos-de-prueba-validación-y-entrenamiento" class="level1">
<h1>Obtención de las series de tiempo y conjuntos de prueba, validación y entrenamiento</h1>
<p>En esta sección se dividen los datos de las series de tiempo de Bitcoin en conjuntos de entrenamiento, validación y prueba para diferentes horizontes de tiempo (lags o τ). Este proceso es crucial para el entrenamiento de modelos de Deep Learning que se basan en dependencias temporales, como las redes recurrentes o los LSTM.</p>
<p>Dividir los datos en conjuntos de entrenamiento, validación y prueba es fundamental para garantizar que los modelos se entrenen correctamente, evitando el sobreajuste y evaluando su rendimiento en datos no vistos. Además, trabajar con múltiples valores de τ permite explorar la influencia del horizonte temporal en la capacidad predictiva del modelo, lo cual es esencial en series de tiempo con fluctuaciones a corto y largo plazo.</p>
<div id="c9faabf8" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> split_dataset(df: pd.DataFrame, tau: <span class="bu">int</span>, column: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">list</span>:</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    df[column] <span class="op">=</span> df[column].fillna(<span class="dv">0</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    serie <span class="op">=</span> df[column]</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(serie)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    train_w <span class="op">=</span> n <span class="op">-</span> (tau <span class="op">*</span> <span class="dv">3</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    X_train <span class="op">=</span> np.array([serie.iloc[i <span class="op">-</span> tau:i].values.flatten() <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(tau, train_w)])</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    y_train <span class="op">=</span> np.array(serie.iloc[tau:train_w].values.flatten()).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    X_val <span class="op">=</span> np.array([serie.iloc[i <span class="op">-</span> tau:i].values.flatten() <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(train_w, train_w <span class="op">+</span> tau)])</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    y_val <span class="op">=</span> np.array(serie.iloc[train_w:train_w <span class="op">+</span> tau].values.flatten().tolist())</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    X_test <span class="op">=</span> np.array([serie.iloc[i <span class="op">-</span> tau:i].values.flatten() <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(train_w <span class="op">+</span> tau, train_w <span class="op">+</span> (<span class="dv">2</span> <span class="op">*</span> tau))])</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    y_test <span class="op">=</span> np.array(serie.iloc[train_w <span class="op">+</span> tau:train_w <span class="op">+</span> (<span class="dv">2</span> <span class="op">*</span> tau)].values.flatten().tolist())</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [X_train, y_train, X_val, y_val, X_test, y_test]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="series-de-tiempo-del-precio" class="level2">
<h2 class="anchored" data-anchor-id="series-de-tiempo-del-precio">Series de tiempo del precio</h2>
<div id="9ba1f620" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>price_7 <span class="op">=</span> split_dataset(btc, <span class="dv">7</span>, <span class="st">'Price'</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>price_14 <span class="op">=</span> split_dataset(btc, <span class="dv">14</span>, <span class="st">'Price'</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>price_21 <span class="op">=</span> split_dataset(btc, <span class="dv">21</span>, <span class="st">'Price'</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>price_28 <span class="op">=</span> split_dataset(btc, <span class="dv">28</span>, <span class="st">'Price'</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>price <span class="op">=</span> [price_7, price_14, price_21, price_28]</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'τ = 7'</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 7 en X: </span><span class="sc">{</span>price_7[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 7 en y: </span><span class="sc">{</span>price_7[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 7 en X: </span><span class="sc">{</span>price_7[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 7 en y: </span><span class="sc">{</span>price_7[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 7 en X: </span><span class="sc">{</span>price_7[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 7 en y: </span><span class="sc">{</span>price_7[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">τ = 14'</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 14 en X: </span><span class="sc">{</span>price_14[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 14 en y: </span><span class="sc">{</span>price_14[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 14 en X: </span><span class="sc">{</span>price_14[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 14 en y: </span><span class="sc">{</span>price_14[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 14 en X: </span><span class="sc">{</span>price_14[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 14 en y: </span><span class="sc">{</span>price_14[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">τ = 21'</span>)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 21 en X: </span><span class="sc">{</span>price_21[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 21 en y: </span><span class="sc">{</span>price_21[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 21 en X: </span><span class="sc">{</span>price_21[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 21 en y: </span><span class="sc">{</span>price_21[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 21 en X: </span><span class="sc">{</span>price_21[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 21 en y: </span><span class="sc">{</span>price_21[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">τ = 28'</span>)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 28 en X: </span><span class="sc">{</span>price_28[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 28 en y: </span><span class="sc">{</span>price_28[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 28 en X: </span><span class="sc">{</span>price_28[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 28 en y: </span><span class="sc">{</span>price_28[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 28 en X: </span><span class="sc">{</span>price_28[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 28 en y: </span><span class="sc">{</span>price_28[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>τ = 7
Tamaño del conjunto de entrenamiento τ = 7 en X: (4971, 7)
Tamaño del conjunto de entrenamiento τ = 7 en y: (4971, 1)
Tamaño del conjunto de validación τ = 7 en X: (7, 7)
Tamaño del conjunto de validación τ = 7 en y: (7,)
Tamaño del conjunto de prueba τ = 7 en X: (7, 7)
Tamaño del conjunto de prueba τ = 7 en y: (7,)

τ = 14
Tamaño del conjunto de entrenamiento τ = 14 en X: (4943, 14)
Tamaño del conjunto de entrenamiento τ = 14 en y: (4943, 1)
Tamaño del conjunto de validación τ = 14 en X: (14, 14)
Tamaño del conjunto de validación τ = 14 en y: (14,)
Tamaño del conjunto de prueba τ = 14 en X: (14, 14)
Tamaño del conjunto de prueba τ = 14 en y: (14,)

τ = 21
Tamaño del conjunto de entrenamiento τ = 21 en X: (4915, 21)
Tamaño del conjunto de entrenamiento τ = 21 en y: (4915, 1)
Tamaño del conjunto de validación τ = 21 en X: (21, 21)
Tamaño del conjunto de validación τ = 21 en y: (21,)
Tamaño del conjunto de prueba τ = 21 en X: (21, 21)
Tamaño del conjunto de prueba τ = 21 en y: (21,)

τ = 28
Tamaño del conjunto de entrenamiento τ = 28 en X: (4887, 28)
Tamaño del conjunto de entrenamiento τ = 28 en y: (4887, 1)
Tamaño del conjunto de validación τ = 28 en X: (28, 28)
Tamaño del conjunto de validación τ = 28 en y: (28,)
Tamaño del conjunto de prueba τ = 28 en X: (28, 28)
Tamaño del conjunto de prueba τ = 28 en y: (28,)</code></pre>
</div>
</div>
</section>
<section id="series-de-tiempo-del-retorno-acumulado" class="level2">
<h2 class="anchored" data-anchor-id="series-de-tiempo-del-retorno-acumulado">Series de tiempo del retorno acumulado</h2>
<div id="a82593c7" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>at_7 <span class="op">=</span> split_dataset(btc, <span class="dv">7</span>, <span class="st">'A_t'</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>at_14 <span class="op">=</span> split_dataset(btc, <span class="dv">14</span>, <span class="st">'A_t'</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>at_21 <span class="op">=</span> split_dataset(btc, <span class="dv">21</span>, <span class="st">'A_t'</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>at_28 <span class="op">=</span> split_dataset(btc, <span class="dv">28</span>, <span class="st">'A_t'</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>at <span class="op">=</span> [at_7, at_14, at_21, at_28]</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'τ = 7'</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 7 en X: </span><span class="sc">{</span>at_7[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 7 en y: </span><span class="sc">{</span>at_7[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 7 en X: </span><span class="sc">{</span>at_7[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 7 en y: </span><span class="sc">{</span>at_7[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 7 en X: </span><span class="sc">{</span>at_7[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 7 en y: </span><span class="sc">{</span>at_7[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">τ = 14'</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 14 en X: </span><span class="sc">{</span>at_14[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 14 en y: </span><span class="sc">{</span>at_14[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 14 en X: </span><span class="sc">{</span>at_14[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 14 en y: </span><span class="sc">{</span>at_14[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 14 en X: </span><span class="sc">{</span>at_14[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 14 en y: </span><span class="sc">{</span>at_14[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">τ = 21'</span>)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 21 en X: </span><span class="sc">{</span>at_21[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 21 en y: </span><span class="sc">{</span>at_21[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 21 en X: </span><span class="sc">{</span>at_21[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 21 en y: </span><span class="sc">{</span>at_21[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 21 en X: </span><span class="sc">{</span>at_21[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 21 en y: </span><span class="sc">{</span>at_21[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">τ = 28'</span>)</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 28 en X: </span><span class="sc">{</span>at_28[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 28 en y: </span><span class="sc">{</span>at_28[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 28 en X: </span><span class="sc">{</span>at_28[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 28 en y: </span><span class="sc">{</span>at_28[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 28 en X: </span><span class="sc">{</span>at_28[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 28 en y: </span><span class="sc">{</span>at_28[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>τ = 7
Tamaño del conjunto de entrenamiento τ = 7 en X: (4971, 7)
Tamaño del conjunto de entrenamiento τ = 7 en y: (4971, 1)
Tamaño del conjunto de validación τ = 7 en X: (7, 7)
Tamaño del conjunto de validación τ = 7 en y: (7,)
Tamaño del conjunto de prueba τ = 7 en X: (7, 7)
Tamaño del conjunto de prueba τ = 7 en y: (7,)

τ = 14
Tamaño del conjunto de entrenamiento τ = 14 en X: (4943, 14)
Tamaño del conjunto de entrenamiento τ = 14 en y: (4943, 1)
Tamaño del conjunto de validación τ = 14 en X: (14, 14)
Tamaño del conjunto de validación τ = 14 en y: (14,)
Tamaño del conjunto de prueba τ = 14 en X: (14, 14)
Tamaño del conjunto de prueba τ = 14 en y: (14,)

τ = 21
Tamaño del conjunto de entrenamiento τ = 21 en X: (4915, 21)
Tamaño del conjunto de entrenamiento τ = 21 en y: (4915, 1)
Tamaño del conjunto de validación τ = 21 en X: (21, 21)
Tamaño del conjunto de validación τ = 21 en y: (21,)
Tamaño del conjunto de prueba τ = 21 en X: (21, 21)
Tamaño del conjunto de prueba τ = 21 en y: (21,)

τ = 28
Tamaño del conjunto de entrenamiento τ = 28 en X: (4887, 28)
Tamaño del conjunto de entrenamiento τ = 28 en y: (4887, 1)
Tamaño del conjunto de validación τ = 28 en X: (28, 28)
Tamaño del conjunto de validación τ = 28 en y: (28,)
Tamaño del conjunto de prueba τ = 28 en X: (28, 28)
Tamaño del conjunto de prueba τ = 28 en y: (28,)</code></pre>
</div>
</div>
</section>
<section id="series-de-tiempo-de-la-volatilidad" class="level2">
<h2 class="anchored" data-anchor-id="series-de-tiempo-de-la-volatilidad">Series de tiempo de la volatilidad</h2>
<section id="serie-de-tiempo-de-la-volatidad-para-σ-7" class="level3">
<h3 class="anchored" data-anchor-id="serie-de-tiempo-de-la-volatidad-para-σ-7">Serie de tiempo de la volatidad para σ = 7</h3>
<div id="4e6f539c" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>vol_7 <span class="op">=</span> split_dataset(btc, <span class="dv">7</span>, <span class="st">'σ_7'</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>vol_14 <span class="op">=</span> split_dataset(btc, <span class="dv">14</span>, <span class="st">'σ_7'</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>vol_21 <span class="op">=</span> split_dataset(btc, <span class="dv">21</span>, <span class="st">'σ_7'</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>vol_28 <span class="op">=</span> split_dataset(btc, <span class="dv">28</span>, <span class="st">'σ_7'</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>vo_7 <span class="op">=</span> [vol_7, vol_14, vol_21, vol_28]</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'τ = 7'</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 7 en X: </span><span class="sc">{</span>vol_7[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 7 en y: </span><span class="sc">{</span>vol_7[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 7 en X: </span><span class="sc">{</span>vol_7[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 7 en y: </span><span class="sc">{</span>vol_7[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 7 en X: </span><span class="sc">{</span>vol_7[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 7 en y: </span><span class="sc">{</span>vol_7[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">τ = 14'</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 14 en X: </span><span class="sc">{</span>vol_14[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 14 en y: </span><span class="sc">{</span>vol_14[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 14 en X: </span><span class="sc">{</span>vol_14[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 14 en y: </span><span class="sc">{</span>vol_14[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 14 en X: </span><span class="sc">{</span>vol_14[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 14 en y: </span><span class="sc">{</span>vol_14[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">τ = 21'</span>)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 21 en X: </span><span class="sc">{</span>vol_21[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 21 en y: </span><span class="sc">{</span>vol_21[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 21 en X: </span><span class="sc">{</span>vol_21[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 21 en y: </span><span class="sc">{</span>vol_21[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 21 en X: </span><span class="sc">{</span>vol_21[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 21 en y: </span><span class="sc">{</span>vol_21[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">τ = 28'</span>)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 28 en X: </span><span class="sc">{</span>vol_28[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 28 en y: </span><span class="sc">{</span>vol_28[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 28 en X: </span><span class="sc">{</span>vol_28[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 28 en y: </span><span class="sc">{</span>vol_28[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 28 en X: </span><span class="sc">{</span>vol_28[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 28 en y: </span><span class="sc">{</span>vol_28[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>τ = 7
Tamaño del conjunto de entrenamiento τ = 7 en X: (4971, 7)
Tamaño del conjunto de entrenamiento τ = 7 en y: (4971, 1)
Tamaño del conjunto de validación τ = 7 en X: (7, 7)
Tamaño del conjunto de validación τ = 7 en y: (7,)
Tamaño del conjunto de prueba τ = 7 en X: (7, 7)
Tamaño del conjunto de prueba τ = 7 en y: (7,)

τ = 14
Tamaño del conjunto de entrenamiento τ = 14 en X: (4943, 14)
Tamaño del conjunto de entrenamiento τ = 14 en y: (4943, 1)
Tamaño del conjunto de validación τ = 14 en X: (14, 14)
Tamaño del conjunto de validación τ = 14 en y: (14,)
Tamaño del conjunto de prueba τ = 14 en X: (14, 14)
Tamaño del conjunto de prueba τ = 14 en y: (14,)

τ = 21
Tamaño del conjunto de entrenamiento τ = 21 en X: (4915, 21)
Tamaño del conjunto de entrenamiento τ = 21 en y: (4915, 1)
Tamaño del conjunto de validación τ = 21 en X: (21, 21)
Tamaño del conjunto de validación τ = 21 en y: (21,)
Tamaño del conjunto de prueba τ = 21 en X: (21, 21)
Tamaño del conjunto de prueba τ = 21 en y: (21,)

τ = 28
Tamaño del conjunto de entrenamiento τ = 28 en X: (4887, 28)
Tamaño del conjunto de entrenamiento τ = 28 en y: (4887, 1)
Tamaño del conjunto de validación τ = 28 en X: (28, 28)
Tamaño del conjunto de validación τ = 28 en y: (28,)
Tamaño del conjunto de prueba τ = 28 en X: (28, 28)
Tamaño del conjunto de prueba τ = 28 en y: (28,)</code></pre>
</div>
</div>
</section>
<section id="serie-de-tiempo-de-la-volatidad-para-σ-14" class="level3">
<h3 class="anchored" data-anchor-id="serie-de-tiempo-de-la-volatidad-para-σ-14">Serie de tiempo de la volatidad para σ = 14</h3>
<div id="8e5465e0" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>vol_7 <span class="op">=</span> split_dataset(btc, <span class="dv">7</span>, <span class="st">'σ_14'</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>vol_14 <span class="op">=</span> split_dataset(btc, <span class="dv">14</span>, <span class="st">'σ_14'</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>vol_21 <span class="op">=</span> split_dataset(btc, <span class="dv">21</span>, <span class="st">'σ_14'</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>vol_28 <span class="op">=</span> split_dataset(btc, <span class="dv">28</span>, <span class="st">'σ_14'</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>vo_14 <span class="op">=</span> [vol_7, vol_14, vol_21, vol_28]</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'τ = 7'</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 7 en X: </span><span class="sc">{</span>vol_7[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 7 en y: </span><span class="sc">{</span>vol_7[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 7 en X: </span><span class="sc">{</span>vol_7[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 7 en y: </span><span class="sc">{</span>vol_7[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 7 en X: </span><span class="sc">{</span>vol_7[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 7 en y: </span><span class="sc">{</span>vol_7[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">τ = 14'</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 14 en X: </span><span class="sc">{</span>vol_14[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 14 en y: </span><span class="sc">{</span>vol_14[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 14 en X: </span><span class="sc">{</span>vol_14[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 14 en y: </span><span class="sc">{</span>vol_14[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 14 en X: </span><span class="sc">{</span>vol_14[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 14 en y: </span><span class="sc">{</span>vol_14[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">τ = 21'</span>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 21 en X: </span><span class="sc">{</span>vol_21[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 21 en y: </span><span class="sc">{</span>vol_21[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 21 en X: </span><span class="sc">{</span>vol_21[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 21 en y: </span><span class="sc">{</span>vol_21[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 21 en X: </span><span class="sc">{</span>vol_21[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 21 en y: </span><span class="sc">{</span>vol_21[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">τ = 28'</span>)</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 28 en X: </span><span class="sc">{</span>vol_28[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 28 en y: </span><span class="sc">{</span>vol_28[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 28 en X: </span><span class="sc">{</span>vol_28[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 28 en y: </span><span class="sc">{</span>vol_28[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 28 en X: </span><span class="sc">{</span>vol_28[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 28 en y: </span><span class="sc">{</span>vol_28[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>τ = 7
Tamaño del conjunto de entrenamiento τ = 7 en X: (4971, 7)
Tamaño del conjunto de entrenamiento τ = 7 en y: (4971, 1)
Tamaño del conjunto de validación τ = 7 en X: (7, 7)
Tamaño del conjunto de validación τ = 7 en y: (7,)
Tamaño del conjunto de prueba τ = 7 en X: (7, 7)
Tamaño del conjunto de prueba τ = 7 en y: (7,)

τ = 14
Tamaño del conjunto de entrenamiento τ = 14 en X: (4943, 14)
Tamaño del conjunto de entrenamiento τ = 14 en y: (4943, 1)
Tamaño del conjunto de validación τ = 14 en X: (14, 14)
Tamaño del conjunto de validación τ = 14 en y: (14,)
Tamaño del conjunto de prueba τ = 14 en X: (14, 14)
Tamaño del conjunto de prueba τ = 14 en y: (14,)

τ = 21
Tamaño del conjunto de entrenamiento τ = 21 en X: (4915, 21)
Tamaño del conjunto de entrenamiento τ = 21 en y: (4915, 1)
Tamaño del conjunto de validación τ = 21 en X: (21, 21)
Tamaño del conjunto de validación τ = 21 en y: (21,)
Tamaño del conjunto de prueba τ = 21 en X: (21, 21)
Tamaño del conjunto de prueba τ = 21 en y: (21,)

τ = 28
Tamaño del conjunto de entrenamiento τ = 28 en X: (4887, 28)
Tamaño del conjunto de entrenamiento τ = 28 en y: (4887, 1)
Tamaño del conjunto de validación τ = 28 en X: (28, 28)
Tamaño del conjunto de validación τ = 28 en y: (28,)
Tamaño del conjunto de prueba τ = 28 en X: (28, 28)
Tamaño del conjunto de prueba τ = 28 en y: (28,)</code></pre>
</div>
</div>
</section>
<section id="serie-de-tiempo-de-la-volatidad-para-σ-21" class="level3">
<h3 class="anchored" data-anchor-id="serie-de-tiempo-de-la-volatidad-para-σ-21">Serie de tiempo de la volatidad para σ = 21</h3>
<div id="1e5ab205" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>vol_7 <span class="op">=</span> split_dataset(btc, <span class="dv">7</span>, <span class="st">'σ_21'</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>vol_14 <span class="op">=</span> split_dataset(btc, <span class="dv">14</span>, <span class="st">'σ_21'</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>vol_21 <span class="op">=</span> split_dataset(btc, <span class="dv">21</span>, <span class="st">'σ_21'</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>vol_28 <span class="op">=</span> split_dataset(btc, <span class="dv">28</span>, <span class="st">'σ_21'</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>vo_21 <span class="op">=</span> [vol_7, vol_14, vol_21, vol_28]</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'τ = 7'</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 7 en X: </span><span class="sc">{</span>vol_7[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 7 en y: </span><span class="sc">{</span>vol_7[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 7 en X: </span><span class="sc">{</span>vol_7[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 7 en y: </span><span class="sc">{</span>vol_7[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 7 en X: </span><span class="sc">{</span>vol_7[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 7 en y: </span><span class="sc">{</span>vol_7[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">τ = 14'</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 14 en X: </span><span class="sc">{</span>vol_14[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 14 en y: </span><span class="sc">{</span>vol_14[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 14 en X: </span><span class="sc">{</span>vol_14[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 14 en y: </span><span class="sc">{</span>vol_14[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 14 en X: </span><span class="sc">{</span>vol_14[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 14 en y: </span><span class="sc">{</span>vol_14[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">τ = 21'</span>)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 21 en X: </span><span class="sc">{</span>vol_21[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 21 en y: </span><span class="sc">{</span>vol_21[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 21 en X: </span><span class="sc">{</span>vol_21[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 21 en y: </span><span class="sc">{</span>vol_21[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 21 en X: </span><span class="sc">{</span>vol_21[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 21 en y: </span><span class="sc">{</span>vol_21[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">τ = 28'</span>)</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 28 en X: </span><span class="sc">{</span>vol_28[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 28 en y: </span><span class="sc">{</span>vol_28[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 28 en X: </span><span class="sc">{</span>vol_28[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 28 en y: </span><span class="sc">{</span>vol_28[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 28 en X: </span><span class="sc">{</span>vol_28[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 28 en y: </span><span class="sc">{</span>vol_28[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>τ = 7
Tamaño del conjunto de entrenamiento τ = 7 en X: (4971, 7)
Tamaño del conjunto de entrenamiento τ = 7 en y: (4971, 1)
Tamaño del conjunto de validación τ = 7 en X: (7, 7)
Tamaño del conjunto de validación τ = 7 en y: (7,)
Tamaño del conjunto de prueba τ = 7 en X: (7, 7)
Tamaño del conjunto de prueba τ = 7 en y: (7,)

τ = 14
Tamaño del conjunto de entrenamiento τ = 14 en X: (4943, 14)
Tamaño del conjunto de entrenamiento τ = 14 en y: (4943, 1)
Tamaño del conjunto de validación τ = 14 en X: (14, 14)
Tamaño del conjunto de validación τ = 14 en y: (14,)
Tamaño del conjunto de prueba τ = 14 en X: (14, 14)
Tamaño del conjunto de prueba τ = 14 en y: (14,)

τ = 21
Tamaño del conjunto de entrenamiento τ = 21 en X: (4915, 21)
Tamaño del conjunto de entrenamiento τ = 21 en y: (4915, 1)
Tamaño del conjunto de validación τ = 21 en X: (21, 21)
Tamaño del conjunto de validación τ = 21 en y: (21,)
Tamaño del conjunto de prueba τ = 21 en X: (21, 21)
Tamaño del conjunto de prueba τ = 21 en y: (21,)

τ = 28
Tamaño del conjunto de entrenamiento τ = 28 en X: (4887, 28)
Tamaño del conjunto de entrenamiento τ = 28 en y: (4887, 1)
Tamaño del conjunto de validación τ = 28 en X: (28, 28)
Tamaño del conjunto de validación τ = 28 en y: (28,)
Tamaño del conjunto de prueba τ = 28 en X: (28, 28)
Tamaño del conjunto de prueba τ = 28 en y: (28,)</code></pre>
</div>
</div>
</section>
<section id="serie-de-tiempo-de-la-volatidad-para-σ-28" class="level3">
<h3 class="anchored" data-anchor-id="serie-de-tiempo-de-la-volatidad-para-σ-28">Serie de tiempo de la volatidad para σ = 28</h3>
<div id="94bb7117" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>vol_7 <span class="op">=</span> split_dataset(btc, <span class="dv">7</span>, <span class="st">'σ_7'</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>vol_14 <span class="op">=</span> split_dataset(btc, <span class="dv">14</span>, <span class="st">'σ_7'</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>vol_21 <span class="op">=</span> split_dataset(btc, <span class="dv">21</span>, <span class="st">'σ_7'</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>vol_28 <span class="op">=</span> split_dataset(btc, <span class="dv">28</span>, <span class="st">'σ_7'</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>vo_28 <span class="op">=</span> [vol_7, vol_14, vol_21, vol_28]</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'τ = 7'</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 7 en X: </span><span class="sc">{</span>vol_7[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 7 en y: </span><span class="sc">{</span>vol_7[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 7 en X: </span><span class="sc">{</span>vol_7[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 7 en y: </span><span class="sc">{</span>vol_7[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 7 en X: </span><span class="sc">{</span>vol_7[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 7 en y: </span><span class="sc">{</span>vol_7[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">τ = 14'</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 14 en X: </span><span class="sc">{</span>vol_14[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 14 en y: </span><span class="sc">{</span>vol_14[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 14 en X: </span><span class="sc">{</span>vol_14[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 14 en y: </span><span class="sc">{</span>vol_14[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 14 en X: </span><span class="sc">{</span>vol_14[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 14 en y: </span><span class="sc">{</span>vol_14[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">τ = 21'</span>)</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 21 en X: </span><span class="sc">{</span>vol_21[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 21 en y: </span><span class="sc">{</span>vol_21[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 21 en X: </span><span class="sc">{</span>vol_21[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 21 en y: </span><span class="sc">{</span>vol_21[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 21 en X: </span><span class="sc">{</span>vol_21[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 21 en y: </span><span class="sc">{</span>vol_21[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">τ = 28'</span>)</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 28 en X: </span><span class="sc">{</span>vol_28[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de entrenamiento τ = 28 en y: </span><span class="sc">{</span>vol_28[<span class="dv">1</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 28 en X: </span><span class="sc">{</span>vol_28[<span class="dv">2</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de validación τ = 28 en y: </span><span class="sc">{</span>vol_28[<span class="dv">3</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 28 en X: </span><span class="sc">{</span>vol_28[<span class="dv">4</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Tamaño del conjunto de prueba τ = 28 en y: </span><span class="sc">{</span>vol_28[<span class="dv">5</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>τ = 7
Tamaño del conjunto de entrenamiento τ = 7 en X: (4971, 7)
Tamaño del conjunto de entrenamiento τ = 7 en y: (4971, 1)
Tamaño del conjunto de validación τ = 7 en X: (7, 7)
Tamaño del conjunto de validación τ = 7 en y: (7,)
Tamaño del conjunto de prueba τ = 7 en X: (7, 7)
Tamaño del conjunto de prueba τ = 7 en y: (7,)

τ = 14
Tamaño del conjunto de entrenamiento τ = 14 en X: (4943, 14)
Tamaño del conjunto de entrenamiento τ = 14 en y: (4943, 1)
Tamaño del conjunto de validación τ = 14 en X: (14, 14)
Tamaño del conjunto de validación τ = 14 en y: (14,)
Tamaño del conjunto de prueba τ = 14 en X: (14, 14)
Tamaño del conjunto de prueba τ = 14 en y: (14,)

τ = 21
Tamaño del conjunto de entrenamiento τ = 21 en X: (4915, 21)
Tamaño del conjunto de entrenamiento τ = 21 en y: (4915, 1)
Tamaño del conjunto de validación τ = 21 en X: (21, 21)
Tamaño del conjunto de validación τ = 21 en y: (21,)
Tamaño del conjunto de prueba τ = 21 en X: (21, 21)
Tamaño del conjunto de prueba τ = 21 en y: (21,)

τ = 28
Tamaño del conjunto de entrenamiento τ = 28 en X: (4887, 28)
Tamaño del conjunto de entrenamiento τ = 28 en y: (4887, 1)
Tamaño del conjunto de validación τ = 28 en X: (28, 28)
Tamaño del conjunto de validación τ = 28 en y: (28,)
Tamaño del conjunto de prueba τ = 28 en X: (28, 28)
Tamaño del conjunto de prueba τ = 28 en y: (28,)</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="visualización-de-los-pliegues-extraídos" class="level1">
<h1>Visualización de los pliegues extraídos</h1>
<div id="8d106cf8" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_folds(data: np.array, tau_v: <span class="bu">list</span>, name: <span class="bu">str</span>):</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> go.Figure()</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    colors <span class="op">=</span> {</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'train'</span>: <span class="st">'#9B7EBD'</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'validation'</span>: <span class="st">'#7AB2D3'</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'test'</span>: <span class="st">'#CBD2A4'</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, tau <span class="kw">in</span> <span class="bu">enumerate</span>(tau_v):</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>        X_train_s, y_train_s <span class="op">=</span> data[i][<span class="dv">0</span>].shape, data[i][<span class="dv">1</span>].shape</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>        X_val_s, y_val_s <span class="op">=</span> data[i][<span class="dv">2</span>].shape, data[i][<span class="dv">3</span>].shape</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        X_test_s, y_test_s <span class="op">=</span> data[i][<span class="dv">4</span>].shape, data[i][<span class="dv">5</span>].shape</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>        fig.add_trace(go.Scatter(</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>, X_train_s[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>)),</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span>[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">*</span> X_train_s[<span class="dv">0</span>],</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>            mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>            line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span>colors[<span class="st">'train'</span>], width<span class="op">=</span><span class="dv">6</span>),</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>            name<span class="op">=</span><span class="st">'Train'</span> <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">""</span>,</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>            showlegend<span class="op">=</span>(i <span class="op">==</span> <span class="dv">0</span>)</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>        fig.add_trace(go.Scatter(</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(X_train_s[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, X_train_s[<span class="dv">0</span>] <span class="op">+</span> X_val_s[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>)),</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span>[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">*</span> X_val_s[<span class="dv">0</span>],</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>            mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>            line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span>colors[<span class="st">'validation'</span>], width<span class="op">=</span><span class="dv">6</span>),</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>            name<span class="op">=</span><span class="st">'Validation'</span> <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">""</span>,</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>            showlegend<span class="op">=</span>(i <span class="op">==</span> <span class="dv">0</span>)</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>        fig.add_trace(go.Scatter(</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(X_train_s[<span class="dv">0</span>] <span class="op">+</span> X_val_s[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, X_train_s[<span class="dv">0</span>] <span class="op">+</span> X_val_s[<span class="dv">0</span>] <span class="op">+</span> X_test_s[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>)),</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span>[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">*</span> X_test_s[<span class="dv">0</span>],</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>            mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>            line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span>colors[<span class="st">'test'</span>], width<span class="op">=</span><span class="dv">6</span>),</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>            name<span class="op">=</span><span class="st">'Test'</span> <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">""</span>,</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>            showlegend<span class="op">=</span>(i <span class="op">==</span> <span class="dv">0</span>)</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>    fig.update_layout(</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="ss">f"Visualización de pliegues para </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>        xaxis_title<span class="op">=</span><span class="st">"Índice de tiempo"</span>,</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>        yaxis_title<span class="op">=</span><span class="st">"Número de pliegue"</span>,</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">=</span><span class="bu">dict</span>(orientation<span class="op">=</span><span class="st">"h"</span>, yanchor<span class="op">=</span><span class="st">"bottom"</span>, y<span class="op">=</span><span class="fl">1.02</span>, xanchor<span class="op">=</span><span class="st">"right"</span>, x<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>        margin<span class="op">=</span>{<span class="st">'b'</span>: <span class="dv">0</span>, <span class="st">'r'</span>: <span class="dv">30</span>, <span class="st">'l'</span>: <span class="dv">30</span>, <span class="st">'t'</span>: <span class="dv">80</span>},</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>        plot_bgcolor<span class="op">=</span><span class="st">'rgba(0, 0, 0, 0.0)'</span>,</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>        paper_bgcolor<span class="op">=</span><span class="st">'rgba(0, 0, 0, 0.0)'</span>,</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>        font_color<span class="op">=</span><span class="st">"white"</span>,</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>        hoverlabel<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>            bgcolor<span class="op">=</span><span class="st">"#222"</span></span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>        xaxis<span class="op">=</span><span class="bu">dict</span>(gridcolor<span class="op">=</span><span class="st">'#222'</span>, tickfont<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'white'</span>), <span class="bu">range</span> <span class="op">=</span> [<span class="dv">4800</span>, <span class="dv">5000</span>]),</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>        yaxis<span class="op">=</span><span class="bu">dict</span>(gridcolor<span class="op">=</span><span class="st">'#222'</span>, tickfont<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'white'</span>), tickvals<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fig</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="pliegues-del-precio" class="level2">
<h2 class="anchored" data-anchor-id="pliegues-del-precio">Pliegues del precio</h2>
<div id="25dc3c5e" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>tau_v <span class="op">=</span> [<span class="dv">7</span>, <span class="dv">14</span>, <span class="dv">21</span>, <span class="dv">28</span>]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>fig_p <span class="op">=</span> plot_folds(price, tau_v, <span class="st">'Price'</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>fig_p.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/price_folds.html" width="730" height="400" title="Visualización de los folds para la variable del precio">
</iframe>
<p>En esta visualización, se dividen los datos de precios en cuatro pliegues distintos, con cada pliegue utilizando una combinación específica de períodos de entrenamiento, validación y prueba. En cada pliegue, la sección morada representa los datos de entrenamiento, la sección azul claro corresponde a los datos de validación y la sección amarilla indica los datos de prueba. La estructura de estos pliegues asegura que todas las particiones del tiempo sean cubiertas, lo cual es esencial para evitar el sesgo temporal y evaluar correctamente la capacidad de generalización del modelo.</p>
</section>
<section id="pliegues-del-retorno-acumulado" class="level2">
<h2 class="anchored" data-anchor-id="pliegues-del-retorno-acumulado">Pliegues del retorno acumulado</h2>
<div id="9ae6df40" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>fig_p <span class="op">=</span> plot_folds(price, tau_v, <span class="st">'A_j'</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>fig_p.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/returncumsum_folds.html" width="730" height="400" title="Visualización de los folds para la variable del retorno acumulado">
</iframe>
<p>Los pliegues del retorno acumulado muestran una estructura similar a la de los precios, pero se enfocan en la serie temporal de retornos. Aquí, cada pliegue también cubre los períodos de entrenamiento, validación y prueba, lo cual es clave para evaluar cómo los modelos capturan la variabilidad y las tendencias de los retornos acumulados.</p>
</section>
<section id="pliegues-de-la-volatilidad" class="level2">
<h2 class="anchored" data-anchor-id="pliegues-de-la-volatilidad">Pliegues de la volatilidad</h2>
<section id="σ-7" class="level3">
<h3 class="anchored" data-anchor-id="σ-7">σ = 7</h3>
<div id="69f0e348" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>fig_p <span class="op">=</span> plot_folds(price, tau_v, <span class="st">'σ_7'</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>fig_p.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/vol7_folds.html" width="730" height="400" title="Visualización de los folds para la variable de volatidilidad cuando σ = 7">
</iframe>
</section>
<section id="σ-14" class="level3">
<h3 class="anchored" data-anchor-id="σ-14">σ = 14</h3>
<div id="9f2825bd" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>fig_p <span class="op">=</span> plot_folds(price, tau_v, <span class="st">'σ_14'</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>fig_p.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/vol14_folds.html" width="730" height="400" title="Visualización de los folds para la variable de volatidilidad cuando σ = 14">
</iframe>
</section>
<section id="σ-21" class="level3">
<h3 class="anchored" data-anchor-id="σ-21">σ = 21</h3>
<div id="3673ba5b" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>fig_p <span class="op">=</span> plot_folds(price, tau_v, <span class="st">'σ_21'</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>fig_p.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/vol21_folds.html" width="730" height="400" title="Visualización de los folds para la variable de volatidilidad cuando σ = 21">
</iframe>
</section>
<section id="σ-28" class="level3">
<h3 class="anchored" data-anchor-id="σ-28">σ = 28</h3>
<div id="99cec9cf" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>fig_p <span class="op">=</span> plot_folds(price, tau_v, <span class="st">'σ_28'</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>fig_p.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe src="graphs/vol28_folds.html" width="730" height="400" title="Visualización de los folds para la variable de volatidilidad cuando σ = 28">
</iframe>
<p>En las visualizaciones de pliegues para σ_7, σ_14, σ_21 y σ_28, se presentan las divisiones para distintas medidas de volatilidad con diferentes valores de τ. Cada pliegue sigue la misma estructura de entrenamiento, validación y prueba, lo cual permite examinar cómo los modelos responden a los cambios en la volatilidad a lo largo de distintos horizontes temporales.</p>
</section>
</section>
</section>
<section id="modelos-de-deep-learning" class="level1">
<h1>Modelos de Deep Learning</h1>
<section id="multilayer-perceptron-models-mlp" class="level2">
<h2 class="anchored" data-anchor-id="multilayer-perceptron-models-mlp">Multilayer Perceptron Models (MLP)</h2>
<section id="predicciones-para-el-precio" class="level3">
<h3 class="anchored" data-anchor-id="predicciones-para-el-precio">Predicciones para el precio</h3>
<section id="τ-7" class="level4">
<h4 class="anchored" data-anchor-id="τ-7">τ = 7</h4>
<div id="e9383734" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_mlp(dim, learning_rate<span class="op">=</span><span class="fl">0.001</span>, activation<span class="op">=</span><span class="st">'relu'</span>):</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> Sequential()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    model.add(Input(shape<span class="op">=</span>(dim,)))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    model.add(Dense(<span class="dv">64</span>, activation<span class="op">=</span>activation))</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    model.add(Dense(<span class="dv">32</span>, activation<span class="op">=</span>activation))</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    model.add(Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">compile</span>(optimizer<span class="op">=</span>Adam(learning_rate<span class="op">=</span>learning_rate), loss<span class="op">=</span>losses.MeanSquaredError())</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="91b04307" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_grid(data, dim, var, tau, w <span class="op">=</span> <span class="dv">1</span>):</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> var <span class="op">==</span> <span class="st">'volatilidad'</span>:</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>        folder_path <span class="op">=</span> <span class="ss">f'best_grids/</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>w<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tau<span class="sc">}</span><span class="ss">.pkl'</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>        folder_path <span class="op">=</span> <span class="ss">f'best_grids/</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tau<span class="sc">}</span><span class="ss">.pkl'</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> os.path.exists(folder_path):</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Cargando resultados guardados..."</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(folder_path, <span class="st">'rb'</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>            results <span class="op">=</span> pickle.load(<span class="bu">file</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> results</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> KerasRegressor(build_fn <span class="op">=</span> build_mlp, verbose <span class="op">=</span> <span class="dv">0</span>, dim <span class="op">=</span> dim)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    param <span class="op">=</span> {</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">'model__learning_rate'</span>: [<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>],</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">'model__activation'</span>: [<span class="st">'relu'</span>, <span class="st">'tanh'</span>, <span class="st">'sigmoid'</span>],</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">'epochs'</span>: [<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>]</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    grid <span class="op">=</span> GridSearchCV(</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>        estimator <span class="op">=</span> model,</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>        param_grid <span class="op">=</span> param,</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>        cv <span class="op">=</span> <span class="dv">3</span>,</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>        verbose <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> grid.fit(data[<span class="dv">0</span>], data[<span class="dv">1</span>])</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(folder_path, <span class="st">'wb'</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>        pickle.dump(results, <span class="bu">file</span>)</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d011ddd4" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> price[<span class="dv">0</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(price[<span class="dv">0</span>], dim, <span class="st">'price'</span>, <span class="dv">7</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: relu
Mejor número de epocas: 50
Mejor Longitud de paso μ (Learning Rate): 0.001
Mejor Puntuación: 0.9929642587499478</code></pre>
</div>
</div>
<div id="f11446d5" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> load_models(type_, folder, w, n <span class="op">=</span> <span class="dv">1</span>):</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> folder <span class="op">==</span> <span class="st">'volatilidad'</span>:</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>        folder_path <span class="op">=</span> <span class="ss">f'models/</span><span class="sc">{</span>type_<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>n<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>w<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>        folder_path <span class="op">=</span> <span class="ss">f'models/</span><span class="sc">{</span>type_<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>w<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    models <span class="op">=</span> []</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> filename <span class="kw">in</span> <span class="bu">sorted</span>(os.listdir(folder_path)):</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> filename.endswith(<span class="st">'.keras'</span>):</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>            models.append(load_model(os.path.join(folder_path, filename)))</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> models</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> save_models(models, type_, folder, w, n <span class="op">=</span> <span class="dv">1</span>):</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> folder <span class="op">==</span> <span class="st">'volatilidad'</span>:</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>        folder_path <span class="op">=</span> <span class="ss">f'models/</span><span class="sc">{</span>type_<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>n<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>w<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>        folder_path <span class="op">=</span> <span class="ss">f'models/</span><span class="sc">{</span>type_<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>w<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> os.path.exists(folder_path):</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>        os.makedirs(folder_path)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, model <span class="kw">in</span> <span class="bu">enumerate</span>(models):</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>        model.save(os.path.join(folder_path, <span class="ss">f'MLP_</span><span class="sc">{</span>w<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">.keras'</span>))</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_model(type_, var, dim, neurons, dropouts, activation, learning_rate, w, n <span class="op">=</span> <span class="dv">1</span>):</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    models <span class="op">=</span> load_models(type_, var, w, n)</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> models:</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Modelos cargados desde la carpeta '</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">'."</span>)</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> models</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"No se encontraron modelos en la carpeta '</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">', construyendo nuevos modelos..."</span>)</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>    models <span class="op">=</span> []</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> neuron <span class="kw">in</span> neurons:</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> dropout <span class="kw">in</span> dropouts:</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> Sequential()</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>            model.add(Input(shape <span class="op">=</span> (dim, )))</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>            model.add(Dense(neuron, activation<span class="op">=</span>activation))</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>            model.add(Dense(neuron <span class="op">//</span> <span class="dv">2</span>, activation<span class="op">=</span>activation))</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>            model.add(Dense(neuron <span class="op">//</span> <span class="dv">2</span>, activation<span class="op">=</span>activation))</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>            model.add(Dropout(dropout))</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>            model.add(Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>            model.<span class="bu">compile</span>(optimizer<span class="op">=</span>Adam(learning_rate<span class="op">=</span>learning_rate), loss<span class="op">=</span><span class="st">'mse'</span>)</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>            models.append(model)</span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f'Modelo con </span><span class="sc">{</span>(neuron, neuron <span class="op">//</span> <span class="dv">2</span>, neuron <span class="op">//</span> <span class="dv">2</span>, <span class="dv">1</span>)<span class="sc">}</span><span class="ss"> neuronas y dropout </span><span class="sc">{</span>dropout<span class="sc">}</span><span class="ss">:'</span>)</span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>            model.summary()</span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>    save_models(models, type_, var, w, n)</span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> models</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c842df79" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>neurons <span class="op">=</span> [<span class="dv">32</span>, <span class="dv">64</span>, <span class="dv">128</span>]</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>dropouts <span class="op">=</span> [<span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>]</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'price'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">7</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'price'.</code></pre>
</div>
</div>
<div id="42e3e609" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> best_model(var, models, X_val, y_val):</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, model <span class="kw">in</span> <span class="bu">enumerate</span>(models):</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>        pred <span class="op">=</span> model.predict(X_val)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>        pred <span class="op">=</span> pred.ravel()</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>        y_val <span class="op">=</span> y_val.ravel()</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>        mape <span class="op">=</span> mean_absolute_percentage_error(y_val, pred)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>        mae <span class="op">=</span> mean_absolute_error(y_val, pred)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>        mse <span class="op">=</span> mean_squared_error(y_val, pred)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>        rmse <span class="op">=</span> np.sqrt(mse)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>        r2 <span class="op">=</span> r2_score(y_val, pred)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">#ljungbox = acorr_ljungbox(pred - y_val, lags = [10], return_df = True)['lb_pvalue'].iloc[0]</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>        jb_stat, jb_p <span class="op">=</span> jarque_bera(pred <span class="op">-</span> y_val)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f'Modelo </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">: MSE = </span><span class="sc">{</span>mse<span class="sc">:.4f}</span><span class="ss">'</span>)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>        results.append({</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Model Name"</span>: <span class="ss">f'MLP_</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span>,</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">"MAPE"</span>: mape,</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">"MAE"</span>: mae,</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">"RMSE"</span>: rmse,</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">"MSE"</span>: mse,</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">"R2"</span>: r2,</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>            <span class="co">#"Ljung-Box P-Value": ljungbox,</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Jarque-Bera P-Value"</span>: jb_p</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> pd.DataFrame(results)</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b9c6d114" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>mlp_p7_metrics <span class="op">=</span> best_model(<span class="st">'price'</span>, models, price[<span class="dv">0</span>][<span class="dv">2</span>], price[<span class="dv">0</span>][<span class="dv">3</span>])</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>mlp_p7_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step
Modelo 0: MSE = 0.0087
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 1: MSE = 0.0053
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 2: MSE = 0.0102
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 3: MSE = 0.0171
WARNING:tensorflow:5 out of the last 5 calls to &lt;function TensorFlowTrainer.make_predict_function.&lt;locals&gt;.one_step_on_data_distributed at 0x16ab35790&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step
Modelo 4: MSE = 0.0130
WARNING:tensorflow:6 out of the last 6 calls to &lt;function TensorFlowTrainer.make_predict_function.&lt;locals&gt;.one_step_on_data_distributed at 0x16ab94430&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 22ms/step
Modelo 5: MSE = 0.0211
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 6: MSE = 0.0103
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 22ms/step
Modelo 7: MSE = 0.0135
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 8: MSE = 0.0118
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 9: MSE = 0.0015
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 10: MSE = 0.0074
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 11: MSE = 0.0246</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_price_0</td>
<td>0.933592</td>
<td>0.093359</td>
<td>0.093359</td>
<td>0.008716</td>
<td>-4.525579e+31</td>
<td>0.55747</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_price_1</td>
<td>0.725742</td>
<td>0.072574</td>
<td>0.072574</td>
<td>0.005267</td>
<td>-2.734788e+31</td>
<td>0.55747</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_price_2</td>
<td>1.008198</td>
<td>0.100820</td>
<td>0.100820</td>
<td>0.010165</td>
<td>-5.277783e+31</td>
<td>0.55747</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_price_3</td>
<td>1.306148</td>
<td>0.130615</td>
<td>0.130615</td>
<td>0.017060</td>
<td>-8.858173e+31</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_price_4</td>
<td>1.139195</td>
<td>0.113920</td>
<td>0.113920</td>
<td>0.012978</td>
<td>-6.738385e+31</td>
<td>0.55747</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_price_5</td>
<td>1.454286</td>
<td>0.145429</td>
<td>0.145429</td>
<td>0.021149</td>
<td>-1.098144e+32</td>
<td>0.55747</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_price_6</td>
<td>1.012448</td>
<td>0.101245</td>
<td>0.101245</td>
<td>0.010251</td>
<td>-5.322367e+31</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_price_7</td>
<td>1.163491</td>
<td>0.116349</td>
<td>0.116349</td>
<td>0.013537</td>
<td>-7.028867e+31</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_price_8</td>
<td>1.085518</td>
<td>0.108552</td>
<td>0.108552</td>
<td>0.011783</td>
<td>-6.118338e+31</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_price_9</td>
<td>0.390892</td>
<td>0.039089</td>
<td>0.039089</td>
<td>0.001528</td>
<td>-7.933669e+30</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_price_10</td>
<td>0.858189</td>
<td>0.085819</td>
<td>0.085819</td>
<td>0.007365</td>
<td>-3.824063e+31</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_price_11</td>
<td>1.569040</td>
<td>0.156904</td>
<td>0.156904</td>
<td>0.024619</td>
<td>-1.278285e+32</td>
<td>0.55747</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="τ-14" class="level4">
<h4 class="anchored" data-anchor-id="τ-14">τ = 14</h4>
<div id="6297647c" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> price[<span class="dv">1</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(price[<span class="dv">1</span>], dim, <span class="st">'price'</span>, <span class="dv">14</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: relu
Mejor número de epocas: 100
Mejor Longitud de paso μ (Learning Rate): 0.001
Mejor Puntuación: 0.9923356886891406</code></pre>
</div>
</div>
<div id="45eb1c69" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'price'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">14</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>mlp_p14_metrics <span class="op">=</span> best_model(<span class="st">'price'</span>, models, price[<span class="dv">1</span>][<span class="dv">2</span>], price[<span class="dv">1</span>][<span class="dv">3</span>])</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>mlp_p14_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'price'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 0: MSE = 0.0119
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 1: MSE = 0.0219
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 2: MSE = 0.0118
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 3: MSE = 0.0146
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 4: MSE = 0.0254
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 5: MSE = 0.0116
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 6: MSE = 0.0107
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 7: MSE = 0.0159
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 8: MSE = 0.0129
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 9: MSE = 0.0043
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 10: MSE = 0.0153</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 11: MSE = 0.0122</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_price_0</td>
<td>1.088821</td>
<td>0.108882</td>
<td>0.108882</td>
<td>0.011855</td>
<td>-6.155626e+31</td>
<td>0.245879</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_price_1</td>
<td>1.480355</td>
<td>0.148035</td>
<td>0.148035</td>
<td>0.021914</td>
<td>-1.137866e+32</td>
<td>0.245879</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_price_2</td>
<td>1.085182</td>
<td>0.108518</td>
<td>0.108518</td>
<td>0.011776</td>
<td>-6.114548e+31</td>
<td>0.245879</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_price_3</td>
<td>1.210023</td>
<td>0.121002</td>
<td>0.121002</td>
<td>0.014642</td>
<td>-7.602329e+31</td>
<td>0.245879</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_price_4</td>
<td>1.593198</td>
<td>0.159320</td>
<td>0.159320</td>
<td>0.025383</td>
<td>-1.317951e+32</td>
<td>0.245879</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_price_5</td>
<td>1.077287</td>
<td>0.107729</td>
<td>0.107729</td>
<td>0.011605</td>
<td>-6.025910e+31</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_price_6</td>
<td>1.032645</td>
<td>0.103265</td>
<td>0.103265</td>
<td>0.010664</td>
<td>-5.536839e+31</td>
<td>0.245879</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_price_7</td>
<td>1.262066</td>
<td>0.126207</td>
<td>0.126207</td>
<td>0.015928</td>
<td>-8.270341e+31</td>
<td>0.245879</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_price_8</td>
<td>1.136970</td>
<td>0.113697</td>
<td>0.113697</td>
<td>0.012927</td>
<td>-6.712084e+31</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_price_9</td>
<td>0.654840</td>
<td>0.065484</td>
<td>0.065484</td>
<td>0.004288</td>
<td>-2.226534e+31</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_price_10</td>
<td>1.237239</td>
<td>0.123724</td>
<td>0.123724</td>
<td>0.015308</td>
<td>-7.948164e+31</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_price_11</td>
<td>1.103586</td>
<td>0.110359</td>
<td>0.110359</td>
<td>0.012179</td>
<td>-6.323704e+31</td>
<td>0.245879</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="τ-21" class="level4">
<h4 class="anchored" data-anchor-id="τ-21">τ = 21</h4>
<div id="4a9f4f0c" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> price[<span class="dv">2</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(price[<span class="dv">2</span>], dim, <span class="st">'price'</span>, <span class="dv">21</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: relu
Mejor número de epocas: 100
Mejor Longitud de paso μ (Learning Rate): 0.001
Mejor Puntuación: 0.992061931285642</code></pre>
</div>
</div>
<div id="0fe17bb8" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'price'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">21</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>mlp_p21_metrics <span class="op">=</span> best_model(<span class="st">'price'</span>, models, price[<span class="dv">2</span>][<span class="dv">2</span>], price[<span class="dv">2</span>][<span class="dv">3</span>])</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>mlp_p21_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'price'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 0: MSE = 0.0011
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 1: MSE = 0.0104
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 2: MSE = 0.0074
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 3: MSE = 0.0099
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 4: MSE = 0.0118
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 5: MSE = 0.0441
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 6: MSE = 0.0076
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 7: MSE = 0.0067
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 8: MSE = 0.0081</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 9: MSE = 0.0089
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 10: MSE = 0.0041
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 11: MSE = 0.0267</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_price_0</td>
<td>0.324668</td>
<td>0.032467</td>
<td>0.032467</td>
<td>0.001054</td>
<td>-5.473179e+30</td>
<td>0.011652</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_price_1</td>
<td>1.021305</td>
<td>0.102130</td>
<td>0.102130</td>
<td>0.010431</td>
<td>-5.415893e+31</td>
<td>0.011652</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_price_2</td>
<td>0.858484</td>
<td>0.085848</td>
<td>0.085848</td>
<td>0.007370</td>
<td>-3.826697e+31</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_price_3</td>
<td>0.994687</td>
<td>0.099469</td>
<td>0.099469</td>
<td>0.009894</td>
<td>-5.137266e+31</td>
<td>0.011652</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_price_4</td>
<td>1.088038</td>
<td>0.108804</td>
<td>0.108804</td>
<td>0.011838</td>
<td>-6.146784e+31</td>
<td>0.011652</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_price_5</td>
<td>2.099725</td>
<td>0.209973</td>
<td>0.209973</td>
<td>0.044088</td>
<td>-2.289203e+32</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_price_6</td>
<td>0.871561</td>
<td>0.087156</td>
<td>0.087156</td>
<td>0.007596</td>
<td>-3.944169e+31</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_price_7</td>
<td>0.819830</td>
<td>0.081983</td>
<td>0.081983</td>
<td>0.006721</td>
<td>-3.489850e+31</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_price_8</td>
<td>0.902006</td>
<td>0.090201</td>
<td>0.090201</td>
<td>0.008136</td>
<td>-4.224529e+31</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_price_9</td>
<td>0.942669</td>
<td>0.094267</td>
<td>0.094267</td>
<td>0.008886</td>
<td>-4.614005e+31</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_price_10</td>
<td>0.641203</td>
<td>0.064120</td>
<td>0.064120</td>
<td>0.004111</td>
<td>-2.134768e+31</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_price_11</td>
<td>1.633952</td>
<td>0.163395</td>
<td>0.163395</td>
<td>0.026698</td>
<td>-1.386239e+32</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="τ-28" class="level4">
<h4 class="anchored" data-anchor-id="τ-28">τ = 28</h4>
<div id="3254bc43" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> price[<span class="dv">3</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(price[<span class="dv">3</span>], dim, <span class="st">'price'</span>, <span class="dv">28</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: relu
Mejor número de epocas: 50
Mejor Longitud de paso μ (Learning Rate): 0.01
Mejor Puntuación: 0.9915164107311906</code></pre>
</div>
</div>
<div id="fdf94d9a" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'price'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">28</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>mlp_p28_metrics <span class="op">=</span> best_model(<span class="st">'price'</span>, models, price[<span class="dv">3</span>][<span class="dv">2</span>], price[<span class="dv">3</span>][<span class="dv">3</span>])</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>mlp_p28_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'price'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 0: MSE = 0.0003
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 1: MSE = 0.0085
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 2: MSE = 0.0105
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 3: MSE = 0.0172
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 4: MSE = 0.0090
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 5: MSE = 0.0006
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 6: MSE = 0.0088
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 7: MSE = 0.0168
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 8: MSE = 0.0050
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 9: MSE = 0.0087
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 10: MSE = 0.0273
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 11: MSE = 0.0209</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_price_0</td>
<td>0.171046</td>
<td>0.017105</td>
<td>0.018523</td>
<td>0.000343</td>
<td>-1.781498e+30</td>
<td>4.947980e-03</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_price_1</td>
<td>0.919785</td>
<td>0.091978</td>
<td>0.092095</td>
<td>0.008481</td>
<td>-4.403843e+31</td>
<td>7.044676e-23</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_price_2</td>
<td>1.021332</td>
<td>0.102133</td>
<td>0.102334</td>
<td>0.010472</td>
<td>-5.437525e+31</td>
<td>1.268079e-02</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_price_3</td>
<td>1.305967</td>
<td>0.130597</td>
<td>0.131146</td>
<td>0.017199</td>
<td>-8.930358e+31</td>
<td>1.218378e-01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_price_4</td>
<td>0.950463</td>
<td>0.095046</td>
<td>0.095080</td>
<td>0.009040</td>
<td>-4.693975e+31</td>
<td>8.858452e-07</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_price_5</td>
<td>0.230914</td>
<td>0.023091</td>
<td>0.025364</td>
<td>0.000643</td>
<td>-3.340493e+30</td>
<td>8.672279e-02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_price_6</td>
<td>0.933272</td>
<td>0.093327</td>
<td>0.093712</td>
<td>0.008782</td>
<td>-4.559847e+31</td>
<td>6.673026e-02</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_price_7</td>
<td>1.292144</td>
<td>0.129214</td>
<td>0.129778</td>
<td>0.016842</td>
<td>-8.745025e+31</td>
<td>1.005144e-03</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_price_8</td>
<td>0.701524</td>
<td>0.070152</td>
<td>0.070636</td>
<td>0.004989</td>
<td>-2.590696e+31</td>
<td>2.241195e-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_price_9</td>
<td>0.932640</td>
<td>0.093264</td>
<td>0.093422</td>
<td>0.008728</td>
<td>-4.531647e+31</td>
<td>1.477324e-06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_price_10</td>
<td>1.650198</td>
<td>0.165020</td>
<td>0.165223</td>
<td>0.027298</td>
<td>-1.417418e+32</td>
<td>3.693883e-18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_price_11</td>
<td>1.443498</td>
<td>0.144350</td>
<td>0.144478</td>
<td>0.020874</td>
<td>-1.083842e+32</td>
<td>9.277897e-17</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="predicciones-para-el-retorno-acumulado" class="level3">
<h3 class="anchored" data-anchor-id="predicciones-para-el-retorno-acumulado">Predicciones para el retorno acumulado</h3>
<section id="τ-7-1" class="level4">
<h4 class="anchored" data-anchor-id="τ-7-1">τ = 7</h4>
<div id="18f0bfea" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> at[<span class="dv">0</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(at[<span class="dv">0</span>], dim, <span class="st">'retorno'</span>, <span class="dv">7</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: relu
Mejor número de epocas: 150
Mejor Longitud de paso μ (Learning Rate): 0.01
Mejor Puntuación: 0.9953678427084359</code></pre>
</div>
</div>
<div id="0e74db88" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'retorno'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">7</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>mlp_at7_metrics <span class="op">=</span> best_model(<span class="st">'at'</span>, models, at[<span class="dv">0</span>][<span class="dv">2</span>], at[<span class="dv">0</span>][<span class="dv">3</span>])</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>mlp_at7_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'retorno'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 0: MSE = 13.5456
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 1: MSE = 6.5067
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 2: MSE = 16.8533
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 3: MSE = 31.8977
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 4: MSE = 32.0769
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 5: MSE = 28.4867
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 6: MSE = 13.2960
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 7: MSE = 22.6537
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 8: MSE = 9.9795
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 9: MSE = 13.0616</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 10: MSE = 5.4229
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 11: MSE = 19.5227</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_at_0</td>
<td>0.851365</td>
<td>3.680431</td>
<td>3.680431</td>
<td>13.545571</td>
<td>0.0</td>
<td>0.55747</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_at_1</td>
<td>0.590060</td>
<td>2.550815</td>
<td>2.550815</td>
<td>6.506657</td>
<td>0.0</td>
<td>0.55747</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_at_2</td>
<td>0.949641</td>
<td>4.105279</td>
<td>4.105279</td>
<td>16.853318</td>
<td>0.0</td>
<td>0.55747</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_at_3</td>
<td>1.306462</td>
<td>5.647805</td>
<td>5.647805</td>
<td>31.897697</td>
<td>0.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_at_4</td>
<td>1.310126</td>
<td>5.663645</td>
<td>5.663645</td>
<td>32.076874</td>
<td>0.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_at_5</td>
<td>1.234634</td>
<td>5.337297</td>
<td>5.337297</td>
<td>28.486740</td>
<td>0.0</td>
<td>0.55747</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_at_6</td>
<td>0.843485</td>
<td>3.646367</td>
<td>3.646367</td>
<td>13.295995</td>
<td>0.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_at_7</td>
<td>1.100998</td>
<td>4.759590</td>
<td>4.759590</td>
<td>22.653696</td>
<td>0.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_at_8</td>
<td>0.730754</td>
<td>3.159033</td>
<td>3.159033</td>
<td>9.979490</td>
<td>0.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_at_9</td>
<td>0.836017</td>
<td>3.614082</td>
<td>3.614082</td>
<td>13.061586</td>
<td>0.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_at_10</td>
<td>0.538684</td>
<td>2.328720</td>
<td>2.328720</td>
<td>5.422937</td>
<td>0.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_at_11</td>
<td>1.022086</td>
<td>4.418454</td>
<td>4.418454</td>
<td>19.522739</td>
<td>0.0</td>
<td>0.55747</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="τ-14-1" class="level4">
<h4 class="anchored" data-anchor-id="τ-14-1">τ = 14</h4>
<div id="0eb62cab" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> at[<span class="dv">1</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(at[<span class="dv">1</span>], dim, <span class="st">'retorno'</span>, <span class="dv">14</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: relu
Mejor número de epocas: 100
Mejor Longitud de paso μ (Learning Rate): 0.001
Mejor Puntuación: 0.9947286045222513</code></pre>
</div>
</div>
<div id="1e4e00bd" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'retorno'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">14</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>mlp_at14_metrics <span class="op">=</span> best_model(<span class="st">'at'</span>, models, at[<span class="dv">1</span>][<span class="dv">2</span>], at[<span class="dv">1</span>][<span class="dv">3</span>])</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>mlp_at14_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'retorno'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step
Modelo 0: MSE = 18.0576
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step
Modelo 1: MSE = 21.3061
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 2: MSE = 18.5075
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 3: MSE = 21.6683
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 4: MSE = 18.0936
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 5: MSE = 21.4362
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step
Modelo 6: MSE = 4.8328
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 7: MSE = 19.3612
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 8: MSE = 24.7572</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 9: MSE = 13.9393
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 10: MSE = 25.1080
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 11: MSE = 23.0428</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_at_0</td>
<td>0.982985</td>
<td>4.249425</td>
<td>4.249425</td>
<td>18.057611</td>
<td>-2.289074e+31</td>
<td>0.245879</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_at_1</td>
<td>1.067749</td>
<td>4.615857</td>
<td>4.615857</td>
<td>21.306138</td>
<td>-2.700874e+31</td>
<td>0.245879</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_at_2</td>
<td>0.995156</td>
<td>4.302037</td>
<td>4.302037</td>
<td>18.507526</td>
<td>-2.346108e+31</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_at_3</td>
<td>1.076787</td>
<td>4.654926</td>
<td>4.654926</td>
<td>21.668332</td>
<td>-2.746787e+31</td>
<td>0.245879</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_at_4</td>
<td>0.983966</td>
<td>4.253663</td>
<td>4.253663</td>
<td>18.093648</td>
<td>-2.293642e+31</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_at_5</td>
<td>1.071004</td>
<td>4.629929</td>
<td>4.629929</td>
<td>21.436242</td>
<td>-2.717366e+31</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_at_6</td>
<td>0.508532</td>
<td>2.198373</td>
<td>2.198373</td>
<td>4.832846</td>
<td>-6.126360e+30</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_at_7</td>
<td>1.017849</td>
<td>4.400140</td>
<td>4.400140</td>
<td>19.361229</td>
<td>-2.454327e+31</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_at_8</td>
<td>1.150979</td>
<td>4.975658</td>
<td>4.975658</td>
<td>24.757176</td>
<td>-3.138345e+31</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_at_9</td>
<td>0.863649</td>
<td>3.733536</td>
<td>3.733536</td>
<td>13.939291</td>
<td>-1.767015e+31</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_at_10</td>
<td>1.159105</td>
<td>5.010787</td>
<td>5.010787</td>
<td>25.107990</td>
<td>-3.182816e+31</td>
<td>0.245879</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_at_11</td>
<td>1.110414</td>
<td>4.800294</td>
<td>4.800294</td>
<td>23.042820</td>
<td>-2.921025e+31</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="τ-21-1" class="level4">
<h4 class="anchored" data-anchor-id="τ-21-1">τ = 21</h4>
<div id="e1bb6851" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> at[<span class="dv">2</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(at[<span class="dv">2</span>], dim, <span class="st">'retorno'</span>, <span class="dv">21</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: sigmoid
Mejor número de epocas: 100
Mejor Longitud de paso μ (Learning Rate): 0.001
Mejor Puntuación: 0.9944296065331537</code></pre>
</div>
</div>
<div id="85ce12b1" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'retorno'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">21</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>mlp_at21_metrics <span class="op">=</span> best_model(<span class="st">'at'</span>, models, at[<span class="dv">2</span>][<span class="dv">2</span>], at[<span class="dv">2</span>][<span class="dv">3</span>])</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>mlp_at21_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'retorno'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 0: MSE = 15.9112
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 1: MSE = 18.6403
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 2: MSE = 16.3590
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 3: MSE = 14.0434
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 4: MSE = 18.7071
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 5: MSE = 19.2759
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 6: MSE = 8.8351</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 7: MSE = 15.1769
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 8: MSE = 12.4313
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 9: MSE = 16.4611
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 10: MSE = 18.3412
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 11: MSE = 17.6120</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2116: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.

/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/scipy/stats/_stats_py.py:2117: RuntimeWarning:

Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_at_0</td>
<td>0.922717</td>
<td>3.988885</td>
<td>3.988885</td>
<td>15.911201</td>
<td>-2.016984e+31</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_at_1</td>
<td>0.998718</td>
<td>4.317438</td>
<td>4.317438</td>
<td>18.640267</td>
<td>-2.362935e+31</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_at_2</td>
<td>0.935610</td>
<td>4.044621</td>
<td>4.044621</td>
<td>16.358958</td>
<td>-2.073744e+31</td>
<td>0.011652</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_at_3</td>
<td>0.866869</td>
<td>3.747456</td>
<td>3.747456</td>
<td>14.043430</td>
<td>-1.780216e+31</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_at_4</td>
<td>1.000508</td>
<td>4.325176</td>
<td>4.325176</td>
<td>18.707149</td>
<td>-2.371413e+31</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_at_5</td>
<td>1.015603</td>
<td>4.390428</td>
<td>4.390428</td>
<td>19.275856</td>
<td>-2.443505e+31</td>
<td>0.011652</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_at_6</td>
<td>0.687578</td>
<td>2.972386</td>
<td>2.972386</td>
<td>8.835076</td>
<td>-1.119979e+31</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_at_7</td>
<td>0.901173</td>
<td>3.895749</td>
<td>3.895749</td>
<td>15.176864</td>
<td>-1.923896e+31</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_at_8</td>
<td>0.815598</td>
<td>3.525812</td>
<td>3.525812</td>
<td>12.431349</td>
<td>-1.575861e+31</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_at_9</td>
<td>0.938525</td>
<td>4.057223</td>
<td>4.057223</td>
<td>16.461059</td>
<td>-2.086687e+31</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_at_10</td>
<td>0.990675</td>
<td>4.282668</td>
<td>4.282668</td>
<td>18.341241</td>
<td>-2.325029e+31</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_at_11</td>
<td>0.970782</td>
<td>4.196668</td>
<td>4.196668</td>
<td>17.612022</td>
<td>-2.232589e+31</td>
<td>0.011652</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="τ-28-1" class="level4">
<h4 class="anchored" data-anchor-id="τ-28-1">τ = 28</h4>
<div id="71a03263" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> at[<span class="dv">3</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(at[<span class="dv">3</span>], dim, <span class="st">'retorno'</span>, <span class="dv">28</span>)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: relu
Mejor número de epocas: 50
Mejor Longitud de paso μ (Learning Rate): 0.001
Mejor Puntuación: 0.9926096353221231</code></pre>
</div>
</div>
<div id="7c26e9a8" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'retorno'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">28</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>mlp_at28_metrics <span class="op">=</span> best_model(<span class="st">'at'</span>, models, at[<span class="dv">3</span>][<span class="dv">2</span>], at[<span class="dv">3</span>][<span class="dv">3</span>])</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>mlp_at28_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'retorno'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 0: MSE = 21.2353
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 1: MSE = 28.0062
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 2: MSE = 13.2884
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 3: MSE = 20.3033
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 4: MSE = 22.2990
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step
Modelo 5: MSE = 19.4056
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 6: MSE = 11.5393
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 7: MSE = 17.3125
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 8: MSE = 19.5027
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 9: MSE = 27.7216
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 10: MSE = 16.9307
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step
Modelo 11: MSE = 8.9896</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_at_0</td>
<td>1.065973</td>
<td>4.608177</td>
<td>4.608178</td>
<td>21.235300</td>
<td>-2.691894e+31</td>
<td>1.492363e-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_at_1</td>
<td>1.224176</td>
<td>5.292086</td>
<td>5.292086</td>
<td>28.006174</td>
<td>-3.550204e+31</td>
<td>1.041470e-01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_at_2</td>
<td>0.843245</td>
<td>3.645330</td>
<td>3.645330</td>
<td>13.288431</td>
<td>-1.684509e+31</td>
<td>2.453968e-11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_at_3</td>
<td>1.042319</td>
<td>4.505923</td>
<td>4.505923</td>
<td>20.303339</td>
<td>-2.573754e+31</td>
<td>6.852999e-02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_at_4</td>
<td>1.092344</td>
<td>4.722177</td>
<td>4.722178</td>
<td>22.298961</td>
<td>-2.826729e+31</td>
<td>8.630661e-02</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_at_5</td>
<td>1.019015</td>
<td>4.405180</td>
<td>4.405181</td>
<td>19.405622</td>
<td>-2.459955e+31</td>
<td>2.404680e-04</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_at_6</td>
<td>0.785789</td>
<td>3.396948</td>
<td>3.396948</td>
<td>11.539258</td>
<td>-1.462775e+31</td>
<td>7.977298e-02</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_at_7</td>
<td>0.962491</td>
<td>4.160828</td>
<td>4.160828</td>
<td>17.312489</td>
<td>-2.194619e+31</td>
<td>2.762365e-03</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_at_8</td>
<td>1.021561</td>
<td>4.416188</td>
<td>4.416188</td>
<td>19.502714</td>
<td>-2.472263e+31</td>
<td>2.311245e-02</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_at_9</td>
<td>1.217942</td>
<td>5.265135</td>
<td>5.265135</td>
<td>27.721643</td>
<td>-3.514136e+31</td>
<td>4.282240e-02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_at_10</td>
<td>0.951819</td>
<td>4.114693</td>
<td>4.114694</td>
<td>16.930703</td>
<td>-2.146222e+31</td>
<td>7.021213e-02</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_at_11</td>
<td>0.693565</td>
<td>2.998265</td>
<td>2.998265</td>
<td>8.989592</td>
<td>-1.139566e+31</td>
<td>1.668459e-10</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="predicciones-para-la-volatilidad" class="level3">
<h3 class="anchored" data-anchor-id="predicciones-para-la-volatilidad">Predicciones para la volatilidad</h3>
<section id="volatilidad-con-ventana-σ-7" class="level4">
<h4 class="anchored" data-anchor-id="volatilidad-con-ventana-σ-7">Volatilidad con ventana σ = 7</h4>
<section id="τ-7-2" class="level5">
<h5 class="anchored" data-anchor-id="τ-7-2">τ = 7</h5>
<div id="13694a62" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> vo_7[<span class="dv">0</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(vo_7[<span class="dv">0</span>], dim, <span class="st">'volatilidad'</span>, <span class="dv">7</span>, <span class="dv">7</span>)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: tanh
Mejor número de epocas: 100
Mejor Longitud de paso μ (Learning Rate): 0.001
Mejor Puntuación: 0.8458686359787372</code></pre>
</div>
</div>
<div id="7e92b2e5" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'volatilidad'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">7</span>, <span class="dv">7</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>mlp_vol7_7_metrics <span class="op">=</span> best_model(<span class="st">'vol7'</span>, models, vo_7[<span class="dv">0</span>][<span class="dv">2</span>], vo_7[<span class="dv">0</span>][<span class="dv">3</span>])</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>mlp_vol7_7_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'volatilidad'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 0: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 1: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 2: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 3: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 4: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 5: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 6: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 7: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 8: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 9: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 10: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 11: MSE = 0.0000</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="47">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_vol7_0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_vol7_1</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_vol7_2</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_vol7_3</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_vol7_4</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_vol7_5</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_vol7_6</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_vol7_7</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_vol7_8</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_vol7_9</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_vol7_10</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_vol7_11</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="τ-14-2" class="level5">
<h5 class="anchored" data-anchor-id="τ-14-2">τ = 14</h5>
<div id="fd6dfa24" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> vo_7[<span class="dv">1</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(vo_7[<span class="dv">1</span>], dim, <span class="st">'volatilidad'</span>, <span class="dv">14</span>, <span class="dv">7</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: relu
Mejor número de epocas: 150
Mejor Longitud de paso μ (Learning Rate): 0.01
Mejor Puntuación: 0.8851995559100326</code></pre>
</div>
</div>
<div id="87d9b672" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'volatilidad'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">14</span>, <span class="dv">7</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>mlp_vol7_14_metrics <span class="op">=</span> best_model(<span class="st">'vol7'</span>, models, vo_7[<span class="dv">1</span>][<span class="dv">2</span>], vo_7[<span class="dv">1</span>][<span class="dv">3</span>])</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>mlp_vol7_14_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'volatilidad'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 0: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 1: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 2: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 3: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 4: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 5: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 6: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 7: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 8: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 9: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 10: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 11: MSE = 0.0000</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="49">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_vol7_0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_vol7_1</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_vol7_2</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_vol7_3</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_vol7_4</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_vol7_5</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_vol7_6</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_vol7_7</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_vol7_8</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_vol7_9</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_vol7_10</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_vol7_11</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="τ-21-2" class="level5">
<h5 class="anchored" data-anchor-id="τ-21-2">τ = 21</h5>
<div id="92eb5002" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> vo_7[<span class="dv">2</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(vo_7[<span class="dv">2</span>], dim, <span class="st">'volatilidad'</span>, <span class="dv">21</span>, <span class="dv">7</span>)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: relu
Mejor número de epocas: 100
Mejor Longitud de paso μ (Learning Rate): 0.001
Mejor Puntuación: 0.8838780194852301</code></pre>
</div>
</div>
<div id="47ddf6db" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'volatilidad'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">21</span>, <span class="dv">7</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>mlp_vol7_21_metrics <span class="op">=</span> best_model(<span class="st">'vol7'</span>, models, vo_7[<span class="dv">2</span>][<span class="dv">2</span>], vo_7[<span class="dv">2</span>][<span class="dv">3</span>])</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>mlp_vol7_21_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'volatilidad'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 0: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 1: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step
Modelo 2: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step
Modelo 3: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step
Modelo 4: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step
Modelo 5: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 6: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 7: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step
Modelo 8: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step
Modelo 9: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 10: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 11: MSE = 0.0000</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="51">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_vol7_0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_vol7_1</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_vol7_2</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_vol7_3</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_vol7_4</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_vol7_5</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_vol7_6</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_vol7_7</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_vol7_8</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_vol7_9</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_vol7_10</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_vol7_11</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="τ-28-2" class="level5">
<h5 class="anchored" data-anchor-id="τ-28-2">τ = 28</h5>
<div id="62c29309" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> vo_7[<span class="dv">3</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(vo_7[<span class="dv">3</span>], dim, <span class="st">'volatilidad'</span>, <span class="dv">28</span>, <span class="dv">7</span>)</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: relu
Mejor número de epocas: 150
Mejor Longitud de paso μ (Learning Rate): 0.01
Mejor Puntuación: 0.8735585364167684</code></pre>
</div>
</div>
<div id="790e6eb5" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'volatilidad'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">28</span>, <span class="dv">7</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>mlp_vol7_28_metrics <span class="op">=</span> best_model(<span class="st">'vol7'</span>, models, vo_7[<span class="dv">3</span>][<span class="dv">2</span>], vo_7[<span class="dv">3</span>][<span class="dv">3</span>])</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>mlp_vol7_28_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'volatilidad'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 0: MSE = 0.0451
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 1: MSE = 0.0034
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 2: MSE = 0.0024
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 3: MSE = 0.0102
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 4: MSE = 0.0114
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 22ms/step
Modelo 5: MSE = 0.0085
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 6: MSE = 0.0019
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 7: MSE = 0.0038
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 8: MSE = 0.0072
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 9: MSE = 0.0286
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 10: MSE = 0.0759
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 11: MSE = 0.0087</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="53">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_vol7_0</td>
<td>7.162994e+14</td>
<td>0.159050</td>
<td>0.212475</td>
<td>0.045146</td>
<td>0.0</td>
<td>0.499207</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_vol7_1</td>
<td>1.794322e+14</td>
<td>0.039842</td>
<td>0.057953</td>
<td>0.003359</td>
<td>0.0</td>
<td>0.989639</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_vol7_2</td>
<td>1.590308e+14</td>
<td>0.035312</td>
<td>0.049172</td>
<td>0.002418</td>
<td>0.0</td>
<td>0.561823</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_vol7_3</td>
<td>2.797398e+14</td>
<td>0.062115</td>
<td>0.100935</td>
<td>0.010188</td>
<td>0.0</td>
<td>0.075613</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_vol7_4</td>
<td>3.061127e+14</td>
<td>0.067971</td>
<td>0.106804</td>
<td>0.011407</td>
<td>0.0</td>
<td>0.185153</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_vol7_5</td>
<td>2.837046e+14</td>
<td>0.062995</td>
<td>0.092310</td>
<td>0.008521</td>
<td>0.0</td>
<td>0.336134</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_vol7_6</td>
<td>1.287562e+14</td>
<td>0.028590</td>
<td>0.043272</td>
<td>0.001872</td>
<td>0.0</td>
<td>0.195448</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_vol7_7</td>
<td>1.842945e+14</td>
<td>0.040922</td>
<td>0.061281</td>
<td>0.003755</td>
<td>0.0</td>
<td>0.485559</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_vol7_8</td>
<td>2.483087e+14</td>
<td>0.055136</td>
<td>0.084717</td>
<td>0.007177</td>
<td>0.0</td>
<td>0.217519</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_vol7_9</td>
<td>5.017698e+14</td>
<td>0.111415</td>
<td>0.169115</td>
<td>0.028600</td>
<td>0.0</td>
<td>0.216930</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_vol7_10</td>
<td>8.429797e+14</td>
<td>0.187179</td>
<td>0.275426</td>
<td>0.075859</td>
<td>0.0</td>
<td>0.200165</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_vol7_11</td>
<td>2.745355e+14</td>
<td>0.060959</td>
<td>0.093203</td>
<td>0.008687</td>
<td>0.0</td>
<td>0.163997</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="volatilidad-con-ventana-σ-14" class="level4">
<h4 class="anchored" data-anchor-id="volatilidad-con-ventana-σ-14">Volatilidad con ventana σ = 14</h4>
<section id="τ-7-3" class="level5">
<h5 class="anchored" data-anchor-id="τ-7-3">τ = 7</h5>
<div id="5d562a16" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> vo_14[<span class="dv">0</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(vo_14[<span class="dv">0</span>], dim, <span class="st">'volatilidad'</span>, <span class="dv">7</span>, <span class="dv">14</span>)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: tanh
Mejor número de epocas: 100
Mejor Longitud de paso μ (Learning Rate): 0.001
Mejor Puntuación: 0.9347361334808304</code></pre>
</div>
</div>
<div id="94834b0a" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'volatilidad'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">7</span>, <span class="dv">14</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>mlp_vol14_7_metrics <span class="op">=</span> best_model(<span class="st">'vol14'</span>, models, vo_14[<span class="dv">0</span>][<span class="dv">2</span>], vo_14[<span class="dv">0</span>][<span class="dv">3</span>])</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>mlp_vol14_7_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'volatilidad'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 0: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 1: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 2: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 3: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 4: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 5: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 6: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 7: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step
Modelo 8: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 9: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 10: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 11: MSE = 0.0000</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="55">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_vol14_0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_vol14_1</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_vol14_2</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_vol14_3</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_vol14_4</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_vol14_5</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_vol14_6</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_vol14_7</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_vol14_8</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_vol14_9</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_vol14_10</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_vol14_11</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="τ-14-3" class="level5">
<h5 class="anchored" data-anchor-id="τ-14-3">τ = 14</h5>
<div id="91fcd2be" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> vo_14[<span class="dv">1</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(vo_14[<span class="dv">1</span>], dim, <span class="st">'volatilidad'</span>, <span class="dv">14</span>, <span class="dv">14</span>)</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: tanh
Mejor número de epocas: 150
Mejor Longitud de paso μ (Learning Rate): 0.001
Mejor Puntuación: 0.9331265147277118</code></pre>
</div>
</div>
<div id="be04dc5c" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'volatilidad'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">14</span>, <span class="dv">14</span>)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>mlp_vol14_14_metrics <span class="op">=</span> best_model(<span class="st">'vol14'</span>, models, vo_14[<span class="dv">1</span>][<span class="dv">2</span>], vo_14[<span class="dv">1</span>][<span class="dv">3</span>])</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>mlp_vol14_14_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'volatilidad'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 0: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 1: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 2: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 3: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 4: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 5: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 6: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 7: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 8: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 9: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 10: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 11: MSE = 0.0000</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="57">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_vol14_0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_vol14_1</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_vol14_2</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_vol14_3</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_vol14_4</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_vol14_5</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_vol14_6</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_vol14_7</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_vol14_8</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_vol14_9</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_vol14_10</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_vol14_11</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="τ-21-3" class="level5">
<h5 class="anchored" data-anchor-id="τ-21-3">τ = 21</h5>
<div id="63eca258" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> vo_14[<span class="dv">2</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(vo_14[<span class="dv">2</span>], dim, <span class="st">'volatilidad'</span>, <span class="dv">21</span>, <span class="dv">14</span>)</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: relu
Mejor número de epocas: 150
Mejor Longitud de paso μ (Learning Rate): 0.001
Mejor Puntuación: 0.9518923980994929</code></pre>
</div>
</div>
<div id="8ab07bed" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'volatilidad'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">21</span>, <span class="dv">14</span>)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>mlp_vol14_21_metrics <span class="op">=</span> best_model(<span class="st">'vol14'</span>, models, vo_14[<span class="dv">2</span>][<span class="dv">2</span>], vo_14[<span class="dv">2</span>][<span class="dv">3</span>])</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>mlp_vol14_21_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'volatilidad'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 0: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 1: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 2: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 3: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 4: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 5: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 6: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 7: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 8: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 9: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 10: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 11: MSE = 0.0000</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="59">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_vol14_0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_vol14_1</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_vol14_2</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_vol14_3</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_vol14_4</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_vol14_5</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_vol14_6</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_vol14_7</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_vol14_8</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_vol14_9</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_vol14_10</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_vol14_11</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="τ-28-3" class="level5">
<h5 class="anchored" data-anchor-id="τ-28-3">τ = 28</h5>
<div id="518117ef" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> vo_14[<span class="dv">3</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(vo_14[<span class="dv">3</span>], dim, <span class="st">'volatilidad'</span>, <span class="dv">28</span>, <span class="dv">14</span>)</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: relu
Mejor número de epocas: 150
Mejor Longitud de paso μ (Learning Rate): 0.01
Mejor Puntuación: 0.9487999966795</code></pre>
</div>
</div>
<div id="203a9501" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'volatilidad'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">28</span>, <span class="dv">14</span>)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>mlp_vol14_28_metrics <span class="op">=</span> best_model(<span class="st">'vol14'</span>, models, vo_14[<span class="dv">3</span>][<span class="dv">2</span>], vo_14[<span class="dv">3</span>][<span class="dv">3</span>])</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>mlp_vol14_28_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'volatilidad'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 0: MSE = 0.0065
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 1: MSE = 0.0091
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 2: MSE = 0.0032
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 3: MSE = 0.0061
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 4: MSE = 0.1288
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 5: MSE = 0.0072
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 6: MSE = 0.0026
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 7: MSE = 0.0012
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 8: MSE = 0.0037
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 9: MSE = 0.0092
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 10: MSE = 0.0022
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 11: MSE = 0.0032</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="61">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_vol14_0</td>
<td>2.896786e+14</td>
<td>0.064322</td>
<td>0.080682</td>
<td>0.006510</td>
<td>0.0</td>
<td>0.610347</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_vol14_1</td>
<td>3.629986e+14</td>
<td>0.080602</td>
<td>0.095384</td>
<td>0.009098</td>
<td>0.0</td>
<td>0.378620</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_vol14_2</td>
<td>2.233342e+14</td>
<td>0.049590</td>
<td>0.056374</td>
<td>0.003178</td>
<td>0.0</td>
<td>0.370159</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_vol14_3</td>
<td>2.897920e+14</td>
<td>0.064347</td>
<td>0.077794</td>
<td>0.006052</td>
<td>0.0</td>
<td>0.579961</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_vol14_4</td>
<td>1.360298e+15</td>
<td>0.302047</td>
<td>0.358896</td>
<td>0.128806</td>
<td>0.0</td>
<td>0.200652</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_vol14_5</td>
<td>2.998405e+14</td>
<td>0.066578</td>
<td>0.085084</td>
<td>0.007239</td>
<td>0.0</td>
<td>0.563968</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_vol14_6</td>
<td>1.894117e+14</td>
<td>0.042058</td>
<td>0.051380</td>
<td>0.002640</td>
<td>0.0</td>
<td>0.701491</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_vol14_7</td>
<td>1.301509e+14</td>
<td>0.028899</td>
<td>0.035027</td>
<td>0.001227</td>
<td>0.0</td>
<td>0.621220</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_vol14_8</td>
<td>2.004332e+14</td>
<td>0.044505</td>
<td>0.060973</td>
<td>0.003718</td>
<td>0.0</td>
<td>0.255349</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_vol14_9</td>
<td>3.788565e+14</td>
<td>0.084123</td>
<td>0.096175</td>
<td>0.009250</td>
<td>0.0</td>
<td>0.387125</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_vol14_10</td>
<td>1.767774e+14</td>
<td>0.039252</td>
<td>0.047189</td>
<td>0.002227</td>
<td>0.0</td>
<td>0.617283</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_vol14_11</td>
<td>2.147773e+14</td>
<td>0.047690</td>
<td>0.056558</td>
<td>0.003199</td>
<td>0.0</td>
<td>0.483371</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="volatilidad-con-ventana-σ-21" class="level4">
<h4 class="anchored" data-anchor-id="volatilidad-con-ventana-σ-21">Volatilidad con ventana σ = 21</h4>
<section id="τ-7-4" class="level5">
<h5 class="anchored" data-anchor-id="τ-7-4">τ = 7</h5>
<div id="6ff8c533" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> vo_21[<span class="dv">0</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(vo_21[<span class="dv">0</span>], dim, <span class="st">'volatilidad'</span>, <span class="dv">7</span>, <span class="dv">21</span>)</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: tanh
Mejor número de epocas: 100
Mejor Longitud de paso μ (Learning Rate): 0.001
Mejor Puntuación: 0.958933652212678</code></pre>
</div>
</div>
<div id="c2b55212" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'volatilidad'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">7</span>, <span class="dv">21</span>)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>mlp_vol21_7_metrics <span class="op">=</span> best_model(<span class="st">'vol21'</span>, models, vo_21[<span class="dv">0</span>][<span class="dv">2</span>], vo_21[<span class="dv">0</span>][<span class="dv">3</span>])</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>mlp_vol21_7_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'volatilidad'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 0: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 1: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 2: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 3: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 4: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 5: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 6: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 7: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 8: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 9: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step
Modelo 10: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 11: MSE = 0.0000</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="63">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_vol21_0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_vol21_1</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_vol21_2</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_vol21_3</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_vol21_4</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_vol21_5</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_vol21_6</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_vol21_7</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_vol21_8</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_vol21_9</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_vol21_10</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_vol21_11</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="τ-14-4" class="level5">
<h5 class="anchored" data-anchor-id="τ-14-4">τ = 14</h5>
<div id="70fe5d3c" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> vo_21[<span class="dv">1</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(vo_21[<span class="dv">1</span>], dim, <span class="st">'volatilidad'</span>, <span class="dv">14</span>, <span class="dv">21</span>)</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: relu
Mejor número de epocas: 100
Mejor Longitud de paso μ (Learning Rate): 0.01
Mejor Puntuación: 0.9590606369714157</code></pre>
</div>
</div>
<div id="c649a01d" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'volatilidad'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">14</span>, <span class="dv">21</span>)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>mlp_vol21_14_metrics <span class="op">=</span> best_model(<span class="st">'vol21'</span>, models, vo_21[<span class="dv">1</span>][<span class="dv">2</span>], vo_21[<span class="dv">1</span>][<span class="dv">3</span>])</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>mlp_vol21_14_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'volatilidad'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 0: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 1: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 2: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 3: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 4: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 5: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 6: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 7: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 8: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 9: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 10: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 11: MSE = 0.0000</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="65">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_vol21_0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_vol21_1</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_vol21_2</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_vol21_3</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_vol21_4</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_vol21_5</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_vol21_6</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_vol21_7</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_vol21_8</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_vol21_9</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_vol21_10</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_vol21_11</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="τ-21-4" class="level5">
<h5 class="anchored" data-anchor-id="τ-21-4">τ = 21</h5>
<div id="e44f5583" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> vo_21[<span class="dv">2</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(vo_21[<span class="dv">2</span>], dim, <span class="st">'volatilidad'</span>, <span class="dv">21</span>, <span class="dv">21</span>)</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: tanh
Mejor número de epocas: 50
Mejor Longitud de paso μ (Learning Rate): 0.001
Mejor Puntuación: 0.9588696357579239</code></pre>
</div>
</div>
<div id="0c75a964" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'volatilidad'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">21</span>, <span class="dv">21</span>)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>mlp_vol21_21_metrics <span class="op">=</span> best_model(<span class="st">'vol21'</span>, models, vo_21[<span class="dv">2</span>][<span class="dv">2</span>], vo_21[<span class="dv">2</span>][<span class="dv">3</span>])</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>mlp_vol21_21_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'volatilidad'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 21ms/step
Modelo 0: MSE = 0.4251
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 1: MSE = 0.1071
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 2: MSE = 1.7569
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 3: MSE = 0.2702
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 4: MSE = 0.0051
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 5: MSE = 0.0045
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 6: MSE = 0.9637
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 7: MSE = 0.4901
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 8: MSE = 1.6636
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 9: MSE = 0.5232
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 10: MSE = 0.0606
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 11: MSE = 0.1050</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="67">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_vol21_0</td>
<td>2.936339e+15</td>
<td>0.651998</td>
<td>0.651998</td>
<td>0.425102</td>
<td>0.0</td>
<td>2.045677e-05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_vol21_1</td>
<td>1.473618e+15</td>
<td>0.327209</td>
<td>0.327209</td>
<td>0.107066</td>
<td>0.0</td>
<td>3.758186e-03</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_vol21_2</td>
<td>5.969479e+15</td>
<td>1.325491</td>
<td>1.325491</td>
<td>1.756925</td>
<td>0.0</td>
<td>4.163555e-04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_vol21_3</td>
<td>2.340928e+15</td>
<td>0.519790</td>
<td>0.519790</td>
<td>0.270182</td>
<td>0.0</td>
<td>2.181144e-02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_vol21_4</td>
<td>3.220082e+14</td>
<td>0.071500</td>
<td>0.071500</td>
<td>0.005112</td>
<td>0.0</td>
<td>3.754697e-02</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_vol21_5</td>
<td>3.028158e+14</td>
<td>0.067239</td>
<td>0.067239</td>
<td>0.004521</td>
<td>0.0</td>
<td>1.270918e-29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_vol21_6</td>
<td>4.421050e+15</td>
<td>0.981670</td>
<td>0.981670</td>
<td>0.963676</td>
<td>0.0</td>
<td>7.620207e-10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_vol21_7</td>
<td>3.152691e+15</td>
<td>0.700038</td>
<td>0.700038</td>
<td>0.490053</td>
<td>0.0</td>
<td>3.278896e-05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_vol21_8</td>
<td>5.808749e+15</td>
<td>1.289801</td>
<td>1.289801</td>
<td>1.663587</td>
<td>0.0</td>
<td>3.886970e-07</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_vol21_9</td>
<td>3.257432e+15</td>
<td>0.723295</td>
<td>0.723295</td>
<td>0.523156</td>
<td>0.0</td>
<td>3.281390e-03</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_vol21_10</td>
<td>1.108672e+15</td>
<td>0.246175</td>
<td>0.246175</td>
<td>0.060602</td>
<td>0.0</td>
<td>5.361850e-26</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_vol21_11</td>
<td>1.459581e+15</td>
<td>0.324092</td>
<td>0.324092</td>
<td>0.105036</td>
<td>0.0</td>
<td>6.528045e-05</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="τ-28-4" class="level5">
<h5 class="anchored" data-anchor-id="τ-28-4">τ = 28</h5>
<div id="823e0b88" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> vo_21[<span class="dv">3</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(vo_21[<span class="dv">3</span>], dim, <span class="st">'volatilidad'</span>, <span class="dv">28</span>, <span class="dv">21</span>)</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: relu
Mejor número de epocas: 100
Mejor Longitud de paso μ (Learning Rate): 0.001
Mejor Puntuación: 0.9707786364616338</code></pre>
</div>
</div>
<div id="fdce4838" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'volatilidad'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">28</span>, <span class="dv">21</span>)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>mlp_vol21_28_metrics <span class="op">=</span> best_model(<span class="st">'vol21'</span>, models, vo_21[<span class="dv">3</span>][<span class="dv">2</span>], vo_21[<span class="dv">3</span>][<span class="dv">3</span>])</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>mlp_vol21_28_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'volatilidad'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 0: MSE = 0.0085
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 1: MSE = 0.0024
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 2: MSE = 0.0030
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 3: MSE = 0.0033
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 4: MSE = 0.0019
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 5: MSE = 0.0122
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 6: MSE = 0.0051
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 7: MSE = 0.0075
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 8: MSE = 0.0070
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 9: MSE = 0.0094
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 10: MSE = 0.0020
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 11: MSE = 0.0014</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="69">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_vol21_0</td>
<td>1.564857e+14</td>
<td>0.069459</td>
<td>0.092173</td>
<td>0.008496</td>
<td>-3.865243</td>
<td>0.008532</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_vol21_1</td>
<td>1.839391e+14</td>
<td>0.043247</td>
<td>0.048635</td>
<td>0.002365</td>
<td>-0.354568</td>
<td>0.378879</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_vol21_2</td>
<td>5.063465e+13</td>
<td>0.033515</td>
<td>0.054505</td>
<td>0.002971</td>
<td>-0.701261</td>
<td>0.002028</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_vol21_3</td>
<td>8.273847e+13</td>
<td>0.040933</td>
<td>0.057785</td>
<td>0.003339</td>
<td>-0.912148</td>
<td>0.004419</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_vol21_4</td>
<td>2.666782e+13</td>
<td>0.023944</td>
<td>0.043379</td>
<td>0.001882</td>
<td>-0.077605</td>
<td>0.002372</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_vol21_5</td>
<td>1.488474e+14</td>
<td>0.074913</td>
<td>0.110356</td>
<td>0.012178</td>
<td>-5.974118</td>
<td>0.111068</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_vol21_6</td>
<td>9.634084e+13</td>
<td>0.049596</td>
<td>0.071310</td>
<td>0.005085</td>
<td>-1.912015</td>
<td>0.002437</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_vol21_7</td>
<td>3.345719e+14</td>
<td>0.077327</td>
<td>0.086720</td>
<td>0.007520</td>
<td>-3.306620</td>
<td>0.603024</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_vol21_8</td>
<td>1.294174e+14</td>
<td>0.061066</td>
<td>0.083875</td>
<td>0.007035</td>
<td>-3.028680</td>
<td>0.005031</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_vol21_9</td>
<td>1.295304e+14</td>
<td>0.065887</td>
<td>0.097198</td>
<td>0.009448</td>
<td>-4.410232</td>
<td>0.046383</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_vol21_10</td>
<td>1.456937e+14</td>
<td>0.038858</td>
<td>0.044239</td>
<td>0.001957</td>
<td>-0.120765</td>
<td>0.297847</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_vol21_11</td>
<td>1.097412e+14</td>
<td>0.033493</td>
<td>0.036828</td>
<td>0.001356</td>
<td>0.223314</td>
<td>0.044301</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="volatilidad-con-ventana-σ-28" class="level4">
<h4 class="anchored" data-anchor-id="volatilidad-con-ventana-σ-28">Volatilidad con ventana σ = 28</h4>
<section id="τ-7-5" class="level5">
<h5 class="anchored" data-anchor-id="τ-7-5">τ = 7</h5>
<div id="14830dc4" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> vo_28[<span class="dv">0</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(vo_28[<span class="dv">0</span>], dim, <span class="st">'volatilidad'</span>, <span class="dv">7</span>, <span class="dv">28</span>)</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: tanh
Mejor número de epocas: 100
Mejor Longitud de paso μ (Learning Rate): 0.001
Mejor Puntuación: 0.8510466752155451</code></pre>
</div>
</div>
<div id="39046139" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'volatilidad'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">7</span>, <span class="dv">28</span>)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>mlp_vol28_7_metrics <span class="op">=</span> best_model(<span class="st">'vol28'</span>, models, vo_28[<span class="dv">0</span>][<span class="dv">2</span>], vo_28[<span class="dv">0</span>][<span class="dv">3</span>])</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>mlp_vol28_7_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'volatilidad'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 0: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 1: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 2: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 3: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 4: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 5: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 6: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 7: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 8: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 9: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 10: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 11: MSE = 0.0000</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="71">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_vol28_0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_vol28_1</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_vol28_2</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_vol28_3</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_vol28_4</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_vol28_5</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_vol28_6</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_vol28_7</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_vol28_8</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_vol28_9</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_vol28_10</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_vol28_11</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="τ-14-5" class="level5">
<h5 class="anchored" data-anchor-id="τ-14-5">τ = 14</h5>
<div id="fbdde2e6" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> vo_28[<span class="dv">1</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(vo_28[<span class="dv">1</span>], dim, <span class="st">'volatilidad'</span>, <span class="dv">14</span>, <span class="dv">28</span>)</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb153-13"><a href="#cb153-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb153-14"><a href="#cb153-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: relu
Mejor número de epocas: 100
Mejor Longitud de paso μ (Learning Rate): 0.01
Mejor Puntuación: 0.8812891588138462</code></pre>
</div>
</div>
<div id="e517cbb9" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'volatilidad'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">14</span>, <span class="dv">28</span>)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>mlp_vol28_14_metrics <span class="op">=</span> best_model(<span class="st">'vol28'</span>, models, vo_28[<span class="dv">1</span>][<span class="dv">2</span>], vo_28[<span class="dv">1</span>][<span class="dv">3</span>])</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>mlp_vol28_14_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'volatilidad'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 0: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 1: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 2: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 3: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 4: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 5: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 6: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 7: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 8: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 9: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 10: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 11: MSE = 0.0000</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="73">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_vol28_0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_vol28_1</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_vol28_2</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_vol28_3</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_vol28_4</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_vol28_5</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_vol28_6</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_vol28_7</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_vol28_8</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_vol28_9</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_vol28_10</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_vol28_11</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="τ-21-5" class="level5">
<h5 class="anchored" data-anchor-id="τ-21-5">τ = 21</h5>
<div id="0ac5d037" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> vo_28[<span class="dv">2</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(vo_28[<span class="dv">2</span>], dim, <span class="st">'volatilidad'</span>, <span class="dv">21</span>, <span class="dv">28</span>)</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: relu
Mejor número de epocas: 100
Mejor Longitud de paso μ (Learning Rate): 0.001
Mejor Puntuación: 0.8813218143824045</code></pre>
</div>
</div>
<div id="ec6b0146" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'volatilidad'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">21</span>, <span class="dv">28</span>)</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>mlp_vol28_21_metrics <span class="op">=</span> best_model(<span class="st">'vol28'</span>, models, vo_28[<span class="dv">2</span>][<span class="dv">2</span>], vo_28[<span class="dv">2</span>][<span class="dv">3</span>])</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>mlp_vol28_21_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'volatilidad'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 0: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 1: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 2: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 3: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 4: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 5: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 6: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 7: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 8: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 9: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 10: MSE = 0.0000
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 20ms/step
Modelo 11: MSE = 0.0000</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="75">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_vol28_0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_vol28_1</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_vol28_2</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_vol28_3</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_vol28_4</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_vol28_5</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_vol28_6</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_vol28_7</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_vol28_8</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_vol28_9</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_vol28_10</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_vol28_11</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="τ-28-5" class="level5">
<h5 class="anchored" data-anchor-id="τ-28-5">τ = 28</h5>
<div id="770fc0ba" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> vo_28[<span class="dv">3</span>][<span class="dv">0</span>].shape[<span class="dv">1</span>]</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> get_grid(vo_28[<span class="dv">3</span>], dim, <span class="st">'volatilidad'</span>, <span class="dv">28</span>, <span class="dv">28</span>)</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> results.best_params_</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>best_activation <span class="op">=</span> results.best_params_[<span class="st">'model__activation'</span>]</span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>best_epochs <span class="op">=</span> results.best_params_[<span class="st">'epochs'</span>]</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>best_mu <span class="op">=</span> results.best_params_[<span class="st">'model__learning_rate'</span>]</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> results.best_score_</span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor función de activación: </span><span class="sc">{</span>best_activation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor número de epocas: </span><span class="sc">{</span>best_epochs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Longitud de paso μ (Learning Rate): </span><span class="sc">{</span>best_mu<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mejor Puntuación: </span><span class="sc">{</span>best_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cargando resultados guardados...
Mejor función de activación: relu
Mejor número de epocas: 100
Mejor Longitud de paso μ (Learning Rate): 0.01
Mejor Puntuación: 0.8743495907125691</code></pre>
</div>
</div>
<div id="bf51a124" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> build_model(<span class="st">'MLP'</span>, <span class="st">'volatilidad'</span>, dim, neurons, dropouts, best_activation, best_mu, <span class="dv">28</span>, <span class="dv">28</span>)</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>mlp_vol28_28_metrics <span class="op">=</span> best_model(<span class="st">'vol28'</span>, models, vo_28[<span class="dv">3</span>][<span class="dv">2</span>], vo_28[<span class="dv">3</span>][<span class="dv">3</span>])</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>mlp_vol28_28_metrics</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/anaconda3/envs/pt_ts/lib/python3.9/site-packages/keras/src/saving/saving_lib.py:719: UserWarning:

Skipping variable loading for optimizer 'adam', because it has 18 variables whereas the saved optimizer has 2 variables. 
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelos cargados desde la carpeta 'volatilidad'.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 0: MSE = 0.0021
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 1: MSE = 0.0005
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 2: MSE = 0.0006
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 3: MSE = 0.0012
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step
Modelo 4: MSE = 0.0017
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 5: MSE = 0.0017
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 6: MSE = 0.0007
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 7: MSE = 0.0004
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 8: MSE = 0.0003
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 9: MSE = 0.0057
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 18ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 10: MSE = 0.0027
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 19ms/step
Modelo 11: MSE = 0.0017</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="77">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MLP_vol28_0</td>
<td>1.473632e+14</td>
<td>0.032721</td>
<td>0.045414</td>
<td>0.002062</td>
<td>0.0</td>
<td>0.284712</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MLP_vol28_1</td>
<td>6.236684e+13</td>
<td>0.013848</td>
<td>0.021517</td>
<td>0.000463</td>
<td>0.0</td>
<td>0.103652</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MLP_vol28_2</td>
<td>7.109195e+13</td>
<td>0.015786</td>
<td>0.023828</td>
<td>0.000568</td>
<td>0.0</td>
<td>0.233961</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MLP_vol28_3</td>
<td>1.109140e+14</td>
<td>0.024628</td>
<td>0.035262</td>
<td>0.001243</td>
<td>0.0</td>
<td>0.214152</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MLP_vol28_4</td>
<td>1.314559e+14</td>
<td>0.029189</td>
<td>0.040948</td>
<td>0.001677</td>
<td>0.0</td>
<td>0.248508</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MLP_vol28_5</td>
<td>1.293315e+14</td>
<td>0.028717</td>
<td>0.041125</td>
<td>0.001691</td>
<td>0.0</td>
<td>0.180185</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>MLP_vol28_6</td>
<td>6.711894e+13</td>
<td>0.014903</td>
<td>0.026100</td>
<td>0.000681</td>
<td>0.0</td>
<td>0.008449</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>MLP_vol28_7</td>
<td>6.612054e+13</td>
<td>0.014682</td>
<td>0.020149</td>
<td>0.000406</td>
<td>0.0</td>
<td>0.416803</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>MLP_vol28_8</td>
<td>4.960191e+13</td>
<td>0.011014</td>
<td>0.017467</td>
<td>0.000305</td>
<td>0.0</td>
<td>0.047961</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MLP_vol28_9</td>
<td>2.180156e+14</td>
<td>0.048409</td>
<td>0.075491</td>
<td>0.005699</td>
<td>0.0</td>
<td>0.111378</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>MLP_vol28_10</td>
<td>1.742931e+14</td>
<td>0.038701</td>
<td>0.052252</td>
<td>0.002730</td>
<td>0.0</td>
<td>0.267459</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>MLP_vol28_11</td>
<td>1.311039e+14</td>
<td>0.029111</td>
<td>0.041407</td>
<td>0.001715</td>
<td>0.0</td>
<td>0.247492</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
</section>
<section id="selección-del-mejor-modelo-mlp" class="level3">
<h3 class="anchored" data-anchor-id="selección-del-mejor-modelo-mlp">Selección del mejor modelo MLP</h3>
<div id="72f048b8" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>metric_vars <span class="op">=</span> [</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mlp_p7_metrics'</span>, <span class="st">'mlp_p14_metrics'</span>, <span class="st">'mlp_p21_metrics'</span>, <span class="st">'mlp_p28_metrics'</span>,</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mlp_at7_metrics'</span>, <span class="st">'mlp_at14_metrics'</span>, <span class="st">'mlp_at21_metrics'</span>, <span class="st">'mlp_at28_metrics'</span>,</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mlp_vol7_7_metrics'</span>, <span class="st">'mlp_vol7_14_metrics'</span>, <span class="st">'mlp_vol7_21_metrics'</span>, <span class="st">'mlp_vol7_28_metrics'</span>,</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mlp_vol14_7_metrics'</span>, <span class="st">'mlp_vol14_14_metrics'</span>, <span class="st">'mlp_vol14_21_metrics'</span>, <span class="st">'mlp_vol14_28_metrics'</span>,</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mlp_vol21_7_metrics'</span>, <span class="st">'mlp_vol21_14_metrics'</span>, <span class="st">'mlp_vol21_21_metrics'</span>, <span class="st">'mlp_vol21_28_metrics'</span>,</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mlp_vol28_7_metrics'</span>, <span class="st">'mlp_vol28_14_metrics'</span>, <span class="st">'mlp_vol28_21_metrics'</span>, <span class="st">'mlp_vol28_28_metrics'</span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_best_metrics(metrics, s_by <span class="op">=</span> <span class="st">'MSE'</span>):</span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> metrics.sort_values(by <span class="op">=</span> s_by).iloc[<span class="dv">0</span>]</span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a>summary <span class="op">=</span> pd.DataFrame()</span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var <span class="kw">in</span> metric_vars:</span>
<span id="cb168-16"><a href="#cb168-16" aria-hidden="true" tabindex="-1"></a>    metric <span class="op">=</span> <span class="bu">globals</span>()[var]</span>
<span id="cb168-17"><a href="#cb168-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-18"><a href="#cb168-18" aria-hidden="true" tabindex="-1"></a>    best_metric <span class="op">=</span> get_best_metrics(metric)</span>
<span id="cb168-19"><a href="#cb168-19" aria-hidden="true" tabindex="-1"></a>    best_metric[<span class="st">'Model'</span>] <span class="op">=</span> var</span>
<span id="cb168-20"><a href="#cb168-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-21"><a href="#cb168-21" aria-hidden="true" tabindex="-1"></a>    summary <span class="op">=</span> pd.concat([summary, best_metric.to_frame().T], ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb168-22"><a href="#cb168-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-23"><a href="#cb168-23" aria-hidden="true" tabindex="-1"></a>summary <span class="op">=</span> summary.drop(columns <span class="op">=</span> [<span class="st">'Model Name'</span>])</span>
<span id="cb168-24"><a href="#cb168-24" aria-hidden="true" tabindex="-1"></a>summary</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
<th data-quarto-table-cell-role="th">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.390892</td>
<td>0.039089</td>
<td>0.039089</td>
<td>0.001528</td>
<td>-7933669470522589694504040660992.0</td>
<td>NaN</td>
<td>mlp_p7_metrics</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.65484</td>
<td>0.065484</td>
<td>0.065484</td>
<td>0.004288</td>
<td>-22265337444463706845134140211200.0</td>
<td>NaN</td>
<td>mlp_p14_metrics</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.324668</td>
<td>0.032467</td>
<td>0.032467</td>
<td>0.001054</td>
<td>-5473179021279250724616449032192.0</td>
<td>0.011652</td>
<td>mlp_p21_metrics</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.171046</td>
<td>0.017105</td>
<td>0.018523</td>
<td>0.000343</td>
<td>-1781497716922890013417599401984.0</td>
<td>0.004948</td>
<td>mlp_p28_metrics</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.538684</td>
<td>2.32872</td>
<td>2.32872</td>
<td>5.422937</td>
<td>0.0</td>
<td>NaN</td>
<td>mlp_at7_metrics</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>0.508532</td>
<td>2.198373</td>
<td>2.198373</td>
<td>4.832846</td>
<td>-6126360016078316546386823217152.0</td>
<td>NaN</td>
<td>mlp_at14_metrics</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>0.687578</td>
<td>2.972386</td>
<td>2.972386</td>
<td>8.835076</td>
<td>-11199789270786860826263298244608.0</td>
<td>NaN</td>
<td>mlp_at21_metrics</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>0.693565</td>
<td>2.998265</td>
<td>2.998265</td>
<td>8.989592</td>
<td>-11395661428177666513355814207488.0</td>
<td>0.0</td>
<td>mlp_at28_metrics</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
<td>mlp_vol7_7_metrics</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
<td>mlp_vol7_14_metrics</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
<td>mlp_vol7_21_metrics</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>128756204624749.71875</td>
<td>0.02859</td>
<td>0.043272</td>
<td>0.001872</td>
<td>0.0</td>
<td>0.195448</td>
<td>mlp_vol7_28_metrics</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
<td>mlp_vol14_7_metrics</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
<td>mlp_vol14_14_metrics</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
<td>mlp_vol14_21_metrics</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>130150873769106.28125</td>
<td>0.028899</td>
<td>0.035027</td>
<td>0.001227</td>
<td>0.0</td>
<td>0.62122</td>
<td>mlp_vol14_28_metrics</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
<td>mlp_vol21_7_metrics</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
<td>mlp_vol21_14_metrics</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>302815780810947.0625</td>
<td>0.067239</td>
<td>0.067239</td>
<td>0.004521</td>
<td>0.0</td>
<td>0.0</td>
<td>mlp_vol21_21_metrics</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>109741172775789.796875</td>
<td>0.033493</td>
<td>0.036828</td>
<td>0.001356</td>
<td>0.223314</td>
<td>0.044301</td>
<td>mlp_vol21_28_metrics</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
<td>mlp_vol28_7_metrics</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
<td>mlp_vol28_14_metrics</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
<td>mlp_vol28_21_metrics</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>49601910482066.289062</td>
<td>0.011014</td>
<td>0.017467</td>
<td>0.000305</td>
<td>0.0</td>
<td>0.047961</td>
<td>mlp_vol28_28_metrics</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="f7d3d395" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>best <span class="op">=</span> [</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mlp_p28_metrics'</span>, <span class="st">'mp_at7_metrics'</span>, <span class="st">'mlp_vol7_28_metrics'</span>, </span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mlp_vol14_28_metrics'</span>, <span class="st">'mlp_vol21_28_metrics'</span>, <span class="st">'mlp_vol28_28_metrics'</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>summary <span class="op">=</span> summary[summary[<span class="st">'Model'</span>].isin(best)]</span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>summary</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MAPE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">R2</th>
<th data-quarto-table-cell-role="th">Jarque-Bera P-Value</th>
<th data-quarto-table-cell-role="th">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>0.171046</td>
<td>0.017105</td>
<td>0.018523</td>
<td>0.000343</td>
<td>-1781497716922890013417599401984.0</td>
<td>0.004948</td>
<td>mlp_p28_metrics</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>128756204624749.71875</td>
<td>0.02859</td>
<td>0.043272</td>
<td>0.001872</td>
<td>0.0</td>
<td>0.195448</td>
<td>mlp_vol7_28_metrics</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>130150873769106.28125</td>
<td>0.028899</td>
<td>0.035027</td>
<td>0.001227</td>
<td>0.0</td>
<td>0.62122</td>
<td>mlp_vol14_28_metrics</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>109741172775789.796875</td>
<td>0.033493</td>
<td>0.036828</td>
<td>0.001356</td>
<td>0.223314</td>
<td>0.044301</td>
<td>mlp_vol21_28_metrics</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>49601910482066.289062</td>
<td>0.011014</td>
<td>0.017467</td>
<td>0.000305</td>
<td>0.0</td>
<td>0.047961</td>
<td>mlp_vol28_28_metrics</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/unfresh25\.quarto\.pub\/parcial-practico-timeseries");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./eda.html" class="pagination-link" aria-label="Análisis exploratorio de datos">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Análisis exploratorio de datos</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>